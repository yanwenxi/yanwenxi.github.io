<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>闫文喜的个人博客</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="闫文喜，闫文喜的个人博客，web前端博客，前端博客">
<meta property="og:type" content="website">
<meta property="og:title" content="闫文喜的个人博客">
<meta property="og:url" content="http://yanwenxi.github.io/page/6/index.html">
<meta property="og:site_name" content="闫文喜的个人博客">
<meta property="og:description" content="闫文喜，闫文喜的个人博客，web前端博客，前端博客">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="闫文喜的个人博客">
<meta name="twitter:description" content="闫文喜，闫文喜的个人博客，web前端博客，前端博客">
  
    <link rel="alternative" href="/atom.xml" title="闫文喜的个人博客" type="application/atom+xml">
  
  
    <link rel="icon" href="/img/favicon.png">
  
  
      <link rel="stylesheet" href="//cdn.bootcss.com/animate.css/3.5.0/animate.min.css">
  
  <link rel="stylesheet" href="/css/style.css">
  <link rel="stylesheet" href="/font-awesome/css/font-awesome.min.css">
  <link rel="apple-touch-icon" href="/apple-touch-icon.png">
  
    
    
  
  
      <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">
  
  <!-- 加载特效 -->
    <script src="/js/pace.js"></script>
    <link href="/css/pace/pace-theme-flash.css" rel="stylesheet" />
  <script>
      var yiliaConfig = {
          rootUrl: '/',
          fancybox: true,
          animate: true,
          isHome: true,
          isPost: false,
          isArchive: false,
          isTag: false,
          isCategory: false,
          open_in_new: false
      }
  </script>
</head>
<body>
  <div id="container">
    <div class="left-col">
    <div class="overlay"></div>
<div class="intrude-less">
    <header id="header" class="inner">
        <a href="/" class="profilepic">
            
            <img lazy-src="/img/head.jpg" class="js-avatar">
            
        </a>

        <hgroup>
          <h1 class="header-author"><a href="/" title="Hi Mate">Wenxi Yan</a></h1>
        </hgroup>

        
        
        
            <div id="switch-btn" class="switch-btn">
                <div class="icon">
                    <div class="icon-ctn">
                        <div class="icon-wrap icon-house" data-idx="0">
                            <div class="birdhouse"></div>
                            <div class="birdhouse_holes"></div>
                        </div>
                        <div class="icon-wrap icon-ribbon hide" data-idx="1">
                            <div class="ribbon"></div>
                        </div>
                        
                        <div class="icon-wrap icon-link hide" data-idx="2">
                            <div class="loopback_l"></div>
                            <div class="loopback_r"></div>
                        </div>
                        
                        
                        <div class="icon-wrap icon-me hide" data-idx="3">
                            <div class="user"></div>
                            <div class="shoulder"></div>
                        </div>
                        
                    </div>
                    
                </div>
                <div class="tips-box hide">
                    <div class="tips-arrow"></div>
                    <ul class="tips-inner">
                        <li>菜单</li>
                        <li>标签</li>
                        
                        <li>友情链接</li>
                        
                        
                        <li>关于我</li>
                        
                    </ul>
                </div>
            </div>
        

        <div id="switch-area" class="switch-area">
            <div class="switch-wrap">
                <section class="switch-part switch-part1">
                    <nav class="header-menu">
                        <ul>
                        
                            <li><a href="/Home">我的小窝</a></li>
                        
                            <li><a href="/archives">文章列表</a></li>
                        
                            <li><a href="/">博客首页</a></li>
                        
                            <li><a href="/about">关于我</a></li>
                        
                        </ul>
                    </nav>
                    <nav class="header-nav">
                        <ul class="social">
                            
                                <a class="fl mail" target="_blank" href="http://mail.qq.com/cgi-bin/qm_share?t=qm_mailme&email=ywx_software@foxmail.com" title="mail">mail</a>
                            
                                <a class="fl github" target="_blank" href="https://github.com/yanwenxi" title="github">github</a>
                            
                                <a class="fl QQ" target="_blank" href="http://www.webywx.com" title="QQ">QQ</a>
                            
                                <a class="fl wechat" target="_blank" href="http://mail.qq.com/cgi-bin/qm_share?t=qm_mailme&email=ywx_software@foxmail.com" title="wechat">wechat</a>
                            
                        </ul>
                    </nav>
                </section>
                
                
                <section class="switch-part switch-part2">
                    <div class="widget tagcloud" id="js-tagcloud">
                        <a href="/tags/ES6、promise/" style="font-size: 10px;">ES6、promise</a> <a href="/tags/H5-移动端优化/" style="font-size: 10px;">H5 移动端优化</a> <a href="/tags/H5、bug/" style="font-size: 10px;">H5、bug</a> <a href="/tags/JS设计模式-设计模式/" style="font-size: 10px;">JS设计模式 设计模式</a> <a href="/tags/Jenkins-CI/" style="font-size: 10px;">Jenkins CI</a> <a href="/tags/Lodash/" style="font-size: 10px;">Lodash</a> <a href="/tags/angular/" style="font-size: 10px;">angular</a> <a href="/tags/angular-http-q-promise/" style="font-size: 10px;">angular $http $q promise</a> <a href="/tags/angular-q-promise/" style="font-size: 10px;">angular $q promise</a> <a href="/tags/angular-decorator/" style="font-size: 10px;">angular decorator</a> <a href="/tags/angular-filter/" style="font-size: 10px;">angular filter</a> <a href="/tags/angular-服务/" style="font-size: 10px;">angular 服务</a> <a href="/tags/angularjs/" style="font-size: 10px;">angularjs</a> <a href="/tags/angular、-http/" style="font-size: 10px;">angular、$http</a> <a href="/tags/angular、Karma/" style="font-size: 10px;">angular、Karma</a> <a href="/tags/angular、directive/" style="font-size: 10px;">angular、directive</a> <a href="/tags/angular、html5/" style="font-size: 10px;">angular、html5</a> <a href="/tags/angular、module、controller/" style="font-size: 10px;">angular、module、controller</a> <a href="/tags/angular、promise、-q、deferred/" style="font-size: 10px;">angular、promise、$q、deferred</a> <a href="/tags/angular、router/" style="font-size: 10px;">angular、router</a> <a href="/tags/angular、ui-router/" style="font-size: 10px;">angular、ui-router</a> <a href="/tags/angular、表达式、filter/" style="font-size: 10px;">angular、表达式、filter</a> <a href="/tags/app-跨平台/" style="font-size: 10px;">app,跨平台</a> <a href="/tags/aso/" style="font-size: 10px;">aso</a> <a href="/tags/blockchain/" style="font-size: 10px;">blockchain</a> <a href="/tags/debugger/" style="font-size: 10px;">debugger</a> <a href="/tags/es5-js/" style="font-size: 10px;">es5 js</a> <a href="/tags/fit/" style="font-size: 10px;">fit</a> <a href="/tags/git-github/" style="font-size: 10px;">git github</a> <a href="/tags/iframe/" style="font-size: 10px;">iframe</a> <a href="/tags/javascript、object-oriented、继承/" style="font-size: 10px;">javascript、object-oriented、继承</a> <a href="/tags/jquery/" style="font-size: 10px;">jquery</a> <a href="/tags/js-Array/" style="font-size: 10px;">js Array</a> <a href="/tags/js-Higher-order-function/" style="font-size: 10px;">js Higher-order-function</a> <a href="/tags/js-lodash/" style="font-size: 10px;">js lodash</a> <a href="/tags/js-sea-js-模块化/" style="font-size: 10px;">js sea.js 模块化</a> <a href="/tags/js-柯里化/" style="font-size: 10px;">js 柯里化</a> <a href="/tags/js-纯函数/" style="font-size: 10px;">js 纯函数</a> <a href="/tags/js、变态题/" style="font-size: 10px;">js、变态题</a> <a href="/tags/js、设计模式/" style="font-size: 10px;">js、设计模式</a> <a href="/tags/js、跨域、document-domain/" style="font-size: 10px;">js、跨域、document.domain</a> <a href="/tags/js模块化、AMD、CMD、CommonJs/" style="font-size: 10px;">js模块化、AMD、CMD、CommonJs</a> <a href="/tags/js继承/" style="font-size: 10px;">js继承</a> <a href="/tags/life、意念/" style="font-size: 10px;">life、意念</a> <a href="/tags/lodash-chain/" style="font-size: 10px;">lodash chain</a> <a href="/tags/markdown/" style="font-size: 10px;">markdown</a> <a href="/tags/mongoDB-数据库/" style="font-size: 10px;">mongoDB 数据库</a> <a href="/tags/mvp/" style="font-size: 10px;">mvp</a> <a href="/tags/node/" style="font-size: 12.5px;">node</a> <a href="/tags/node-debug/" style="font-size: 10px;">node debug</a> <a href="/tags/node-wechat/" style="font-size: 20px;">node wechat</a> <a href="/tags/nodejs/" style="font-size: 10px;">nodejs</a> <a href="/tags/rap/" style="font-size: 17.5px;">rap</a> <a href="/tags/react/" style="font-size: 10px;">react</a> <a href="/tags/react-ant-design/" style="font-size: 10px;">react ant-design</a> <a href="/tags/seo/" style="font-size: 20px;">seo</a> <a href="/tags/seo-新闻源/" style="font-size: 10px;">seo 新闻源</a> <a href="/tags/web/" style="font-size: 10px;">web</a> <a href="/tags/web-交互/" style="font-size: 10px;">web 交互</a> <a href="/tags/web、前端/" style="font-size: 10px;">web、前端</a> <a href="/tags/web、性能优化/" style="font-size: 10px;">web、性能优化</a> <a href="/tags/wechat/" style="font-size: 10px;">wechat</a> <a href="/tags/wechat-webstorm/" style="font-size: 10px;">wechat webstorm</a> <a href="/tags/win10、linux/" style="font-size: 10px;">win10、linux</a> <a href="/tags/window-history-html5/" style="font-size: 10px;">window.history html5</a> <a href="/tags/yarn-npm/" style="font-size: 10px;">yarn npm</a> <a href="/tags/人生/" style="font-size: 10px;">人生</a> <a href="/tags/前后端分享/" style="font-size: 10px;">前后端分享</a> <a href="/tags/前端脚手架/" style="font-size: 10px;">前端脚手架</a> <a href="/tags/建站-seo/" style="font-size: 10px;">建站 seo</a> <a href="/tags/性能优化/" style="font-size: 10px;">性能优化</a> <a href="/tags/生活/" style="font-size: 15px;">生活</a> <a href="/tags/移动端、fixed/" style="font-size: 10px;">移动端、fixed</a> <a href="/tags/解构赋值-es6/" style="font-size: 10px;">解构赋值 es6</a> <a href="/tags/跨域、postMessage、html5/" style="font-size: 10px;">跨域、postMessage、html5</a> <a href="/tags/路由-html5/" style="font-size: 10px;">路由 html5</a>
                    </div>
                </section>
                
                
                
                <section class="switch-part switch-part3">
                    <div id="js-friends">
                    
                      <a target="_blank" class="main-nav-link switch-friends-link" href="http://www.webywx.com">前端小站</a>
                    
                      <a target="_blank" class="main-nav-link switch-friends-link" href="http://ywxi.github.io/">web博客</a>
                    
                    </div>
                </section>
                

                
                
                <section class="switch-part switch-part4">
                
                    <div id="js-aboutme">运动健身、网络营销、web前端、喜欢接触新鲜事物、迎接新的挑战</div>
                </section>
                
            </div>
        </div>
    </header>                
</div>
    </div>
    <div class="mid-col">
      <nav id="mobile-nav">
      <div class="overlay">
          <div class="slider-trigger"></div>
          <h1 class="header-author js-mobile-header hide"><a href="/" title="Me">Wenxi Yan</a></h1>
      </div>
    <div class="intrude-less">
        <header id="header" class="inner">
            <a href="/" class="profilepic">
                
                    <img lazy-src="/img/head.jpg" class="js-avatar">
                
            </a>
            <hgroup>
              <h1 class="header-author"><a href="/" title="Me">Wenxi Yan</a></h1>
            </hgroup>
            
            <nav class="header-menu">
                <ul>
                
                    <li><a href="/Home">我的小窝</a></li>
                
                    <li><a href="/archives">文章列表</a></li>
                
                    <li><a href="/">博客首页</a></li>
                
                    <li><a href="/about">关于我</a></li>
                
                <div class="clearfix"></div>
                </ul>
            </nav>
            <nav class="header-nav">
                <div class="social">
                    
                        <a class="mail" target="_blank" href="http://mail.qq.com/cgi-bin/qm_share?t=qm_mailme&email=ywx_software@foxmail.com" title="mail">mail</a>
                    
                        <a class="github" target="_blank" href="https://github.com/yanwenxi" title="github">github</a>
                    
                        <a class="QQ" target="_blank" href="http://www.webywx.com" title="QQ">QQ</a>
                    
                        <a class="wechat" target="_blank" href="http://mail.qq.com/cgi-bin/qm_share?t=qm_mailme&email=ywx_software@foxmail.com" title="wechat">wechat</a>
                    
                </div>
            </nav>
        </header>                
    </div>
</nav>
      <div class="body-wrap">
  
    <article id="post-angular-guide16-xhr实践" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2016/07/20/angular-guide16-xhr实践/" class="article-date">
      <time datetime="2016-07-19T18:30:12.000Z" itemprop="datePublished">2016-07-20</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/07/20/angular-guide16-xhr实践/">Angular中的异步请求-xhr</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
        <h3 id="跨域和同源策略"><a href="#跨域和同源策略" class="headerlink" title="跨域和同源策略"></a>跨域和同源策略</h3><p>  　同源策略允许页面从同一个站点加载和执行特定的脚本。浏览器通过对比每一个资源的协议、主机名和端口号来判断资源是否与页面同源。站外其他来源的脚本同页面的交互则被严格限制。跨域资源共享（Cross Origin Resource Sharing， CORS）是一个解决跨域问题的好方法，从而可以使用XHR从不同的源加载数据和资源．除此之外：还能使用jsonp,服务器代理（它需要服务器端的额外支持）。</p>
<ol>
<li><p>jsonp<br>JSONP的原理是通过<code>&lt;script&gt;</code>标签发起一个GET请求来取代XHR请求。 JSONP生成一个<code>&lt;script&gt;</code>标签并插到DOM中，然后浏览器会接管并向src属性所指向的地址发送请求。<br>当服务器返回请求时，响应结果会被包装成一个JavaScript函数，并由该请求所对应的回调函数调用。<br>AngularJS在$http服务中提供了一个JSONP辅助函数。通过$http服务的jsonp方法可以发送请求，如下所示：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">$http</div><div class="line">.jsonp(&quot;https://api.github.com?callback=JSON_CALLBACK&quot;) .success(function(data) &#123;</div><div class="line">// 数据</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<p>当请求被发送时， AngularJS会在DOM中生成一个如下所示的<code>&lt;script&gt;</code>标签：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">&lt;script src=&quot;https://api.github.com?callback=angular.callbacks._0&quot;</div><div class="line">type=&quot;text/javascript&quot;&gt;&lt;/script&gt;</div></pre></td></tr></table></figure>
<p>注意， JSON_CALLBACK被替换成了一个特地为此请求生成的自定义函数。当支持 JSOPN的服务器返回数据时，数据会被包装在由 AngularJS生成的具名函数angular.callbacks._0中。<br>在这个例子中， GitHub服务器会返回包含在回调函数中的JSON数据，响应看起来如下所示：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">// 简写</div><div class="line">angular.callbacks._0(&#123;</div><div class="line">&apos;meta&apos;: &#123;</div><div class="line">&apos;X-RateLimit-Limit&apos;: &apos;60&apos;,</div><div class="line">&apos;status&apos;: 200</div><div class="line">&#125;,</div><div class="line">&apos;data&apos;: &#123;</div><div class="line">&apos;current_user_url&apos;: &apos;https://api.github.com/user&apos;</div><div class="line">&#125;</div><div class="line">&#125;)</div></pre></td></tr></table></figure>
<p>当AngularJS调用指定的回调函数时会对$http的promise对象进行resolve。<br>jsonp的缺点：1、只能发送get请求。2.有潜在的安全风险。</p>
</li>
<li>使用 CORS<br>CORS规范简单地扩展了标准的XHR对象，以允许JavaScript发送跨域的XHR请求。它会通过预检查（preflight）来确认是否有权限向目标服务器发送请求。<br>预检查可以让服务器接受或拒绝来自全部服务器、特定服务器或一组服务器的请求。这意味着客户端和服务端应用需要协同工作，才能向客户端或服务器发送数据。</li>
<li><p>设置<br>为了在AngularJS中使用CORS，首先需要告诉AngularJS我们正在使用CORS。使用config()方法在应用模块上设置两个参数以达到此目的。<br>首先，告诉AngularJS使用XDomain，并从所有的请求中把X-Request-With头移除掉。<br>X-Request-With头默认就是移除掉的，但是再次确认它已经被移除没有坏处。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">angular.module(&apos;myApp&apos;, [])</div><div class="line">.config(function($httpProvider) &#123;</div><div class="line">$httpProvider.defaults.useXDomain = true;</div><div class="line">delete $httpProvider.defaults.headers</div><div class="line">.common[&apos;X-Requested-With&apos;];</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<p>现在可以发送CORS请求了.</p>
</li>
<li><p>服务器端CORS支持<br>支持CORS的服务器必须在响应中加入几个访问控制相关的头。</p>
<ul>
<li> Access-Control-Allow-Origin<br>这个头的值可以是与请求头的值相呼应的值，也可以是*，从而允许接收从任何来源发来的请求。</li>
<li><p> Access-Control-Allow-Credentials（可选）<br>默认情况下， CORS请求不会发送cookie。如果服务器返回了这个头，那么就可以通过将withCredentials设置为true来将cookie同请求一同发送出去。<br>如果将$http发送的请求中的withCredentials设置为true，但服务器没有返回AccessControl-Allow-Credentials，请求就会失败，反之亦然。<br>后端服务器必须能处理OPTIONS方法的HTTP请求。<br>CORS请求分为简单和非简单两种类型。</p>
<ol>
<li><p>简单请求<br>如果请求使用下面一种HTTP方法就是简单请求：HEAD；GET；POST。<br>如果请求除了下面列表中的一个或多个HTTP头以外，没有使用其他头： Accept； Accept-Language ； Content-Language； Last-Event-ID； Content-Type；application/x-www-form-urlencoded；multipart/form-data；text/plain。<br>我们把这类请求归类为简单请求，因为浏览器可以不需要使用CORS就发送这类请求。简单请求不要求浏览器和服务器之间有任何的特殊通信。<br>一个使用$http服务的简单CORS请求和其他简单请求看起来是下面这样的：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">$http</div><div class="line">.get(&quot;https://api.github.com&quot;)</div><div class="line">.success(function(data) &#123;</div><div class="line">// 数据</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
</li>
<li><p>非简单请求<br>不符合简单请求标准的请求被称为非简单请求。如果想要支持PUT或DELETE方法，又或者想给请求设置特殊的内容类型，就需要发送非简单请求。 尽管这些请求在客户端开发者看来没什么不同，但浏览器会以不同的方式处理它们。<br>浏览器实际上会发送两个请求：预请求和请求。浏览器首先会向服务器发送预请求来获得发送请求的许可，只有许可通过了，浏览器才会发送真正的请求。<br>浏览器处理CORS的过程是透明的。<br>同简单请求一样，浏览器会给预请求和请求都加上Origin头。</p>
</li>
</ol>
<ul>
<li>预请求<br>浏览器发送的预请求是OPTIONS类型的，预请求中包含以下头信息：</li>
</ul>
<ol>
<li> Access-Control-Request-Method<br>这个头是请求所使用的HTTP方法，会始终包含在请求中。</li>
<li> Access-Control-Request-Headers （可选)<br>这个头的值是一个以逗号分隔的非简单头列表，列表中的每个头都会包含在这个请求中。<br>服务器必须接受这个请求，然后检查HTTP方法和头的合法性。如果通过了检查，服务器会<br>在响应中添加下面这个头：</li>
<li> Access-Control-Allow-Origin<br>这个头的值必须和请求的来源相同，或者是*符号，以允许接受来自任何来源的请求。</li>
<li> Access-Control-Allow-Methods<br>这是一个可以接受的HTTP方法列表，对在客户端缓存响应结果很有帮助，并且未来发送的<br>请求可以不必总是发送预请求。</li>
<li> Access-Control-Allow-Headers<br>如果设置了Access-Control-Request-Headers头，服务器必须在响应中添加同一个头。<br>我们希望服务器在可以接受这个请求时返回200状态码。如果服务器返回了200状态码，真正<br>的请求才会发出。<br>CORS并不是一个安全机制，只是现代浏览器实现的一个标准。在应用中设置安<br>全策略依然是我们的责任。<br>AngularJS中的非简单请求与普通请求看起来没有什么区别：<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">$http</div><div class="line">.delete(&quot;https://api.github.com/api/users/1&quot;)</div><div class="line">.success(function(data) &#123;</div><div class="line">// 数据</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
</li>
</ol>
</li>
</ul>
</li>
<li><p>服务器端代理<br>实现向所有服务器发送请求的最简单方式是使用服务器端代理。这个服务器和页面处在同一 个域中（或者不在同一个域中但支持CORS），做为所有远程资源的代理。<br>可以简单地通过使用本地服务器来代替客户端向外部资源发送请求，并将响应结果返回给客<br>户端。通过这种方式，老式浏览器不必使用需要发送额外请求的CORS（只有现代浏览器支持<br>CORS）也能发送跨域请求，并且可以在浏览器中采用标准的安全策略。为了实现服务器端代理，需要架设一个本地服务器来处理我们所有的请求，并负责向第三方发送实际的请求.</p>
<h4 id="数据格式：常见的有json、xml。"><a href="#数据格式：常见的有json、xml。" class="headerlink" title="数据格式：常见的有json、xml。"></a>数据格式：常见的有json、xml。</h4><p>若服务器返回的是json格式的，angular能正常解析，假如服务器返回的是XML而非JSON格式的数据，需要将其转换成JavaScript对象。有不少出色的开源库可以使用，同样，某些浏览器也内置了解析器，可以帮助我们将XML格式转换成JavaScript对象</p>
<h4 id="下面介绍一个非常好用的开源库——X2JS"><a href="#下面介绍一个非常好用的开源库——X2JS" class="headerlink" title="下面介绍一个非常好用的开源库——X2JS"></a>下面介绍一个非常好用的开源库——X2JS</h4><p>首选需要确保安装了X2JS库，我们通过Bower来安装：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ bower install x2js</div></pre></td></tr></table></figure>
<p>然后可以在页面中从googlecode.com或我们自己安装的Bower组件中引用这个库：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">&lt;script type=&quot;text/javascript&quot;</div><div class="line">src=&quot;https://x2js.googlecode.com/hg/xml2json.js&quot;&gt;&lt;/script&gt;</div><div class="line">&lt;!-- 或者 --&gt;</div><div class="line">&lt;script type=&quot;text/javascript&quot;</div><div class="line">src=&quot;bower_components/xml2json/xml2json.js&quot;&gt;&lt;/script&gt;</div></pre></td></tr></table></figure>
<p>创建一个工厂服务以开始使用这个轻量的XML解析器，这个服务的功能很简单，就是在DOM中解析XML：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">angular.factory(&apos;xmlParser&apos;, function() &#123;</div><div class="line">var x2js = new X2JS();</div><div class="line">return &#123;</div><div class="line">xml2json: x2js.xml2json,</div><div class="line">json2xml: x2js.json2xml_str</div><div class="line">&#125;;</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<p>借助这个轻量的解析服务，可以将$http请求返回的XML解析成JSON格式，如下所示：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">angular.factory(&apos;Data&apos;, [$http, &apos;xmlParser&apos;, function($http, xmlParser) &#123;</div><div class="line">$http.get(&apos;/api/msgs.xml&apos;, &#123;</div><div class="line">transformResponse: function(data) &#123;</div><div class="line">return xmlParser.xml2json(data);</div><div class="line">&#125;</div><div class="line">&#125;);</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<p>现在请求的结果被转换成了JSON对象，可以像服务器本来返回的就是JSON格式一样来使用这个对象。</p>
<h4 id="使用-AngularJS-进行身份验证"><a href="#使用-AngularJS-进行身份验证" class="headerlink" title="使用 AngularJS 进行身份验证"></a>使用 AngularJS 进行身份验证</h4><p>首先必须保证服务器端API的安全性。由于我们处理的代码是未编译的，且可能是由不信任的源发送的，不能假设所有的用户都聪明到可以认识到这些潜在的风险。<br>下面介绍常被用来保护客户端应用的两种方法。</p>
</li>
<li>服务器端视图渲染<br>如果站点所有的HTML页面都是由后端服务器处理的，可以使用传统的授权方式，由服务器端进行鉴权，只发送客户端需要的HTML。</li>
<li>纯客户端身份验证<br>我们希望客户端和服务端的开发工作可以解耦并各自独立进行，且可以将组件独立地发布到生产环境中，互相没有影响。因此，需要通过使用服务器端API来保护客户端身份验证的安全，但并不依赖这些API来进行身份验证。<br>通过令牌授权来实现客户端身份验证，服务器需要做的是给客户端应用提供授权令牌。<br>令牌本身是一个由服务器端生成的随机字符串，由数字和字母组成，它与特定的用户会话相关联。<br><strong>注：uuid库是用来生成令牌的好选择</strong><br>当用户登录到我们的站点后，服务器会生成一个随机的令牌，并将用户会话同令牌之间建立关联，用户无需将ID或其他身份验证信息发送给服务器。<br>客户端发送的每个请求都应该包含此令牌，这样服务器才能根据令牌来对请求的发送者进行身份验证。<br>服务器端则无论请求是否合法，都会将对应事件的状态码返回给客户端，这样客户端才能做出响应。<h5 id="当客户端收到这些状态码时会做出相应的响应。数据流程如下："><a href="#当客户端收到这些状态码时会做出相应的响应。数据流程如下：" class="headerlink" title="当客户端收到这些状态码时会做出相应的响应。数据流程如下："></a>当客户端收到这些状态码时会做出相应的响应。数据流程如下：</h5></li>
<li>一个未经过身份验证的用户浏览了我们的站点；</li>
<li>用户试图访问一个受保护的资源，被重定向到登录页面，或者用户手动访问了登录页面；</li>
<li>用户输入了他的登录ID（用户名或电子邮箱）以及密码，接着AngularJS应用通过POST用户的信息发送给服务端；</li>
<li>服务端对ID和密码进行校验，检查它们是否匹配；</li>
<li>如果ID和密码匹配，服务端生成一个唯一的令牌，并将其同一个状态码为200的响应一起返回。如果ID和密码不匹配，服务器返回一个状态码为401的响应。注：401状态码：未授权的请求。</li>
</ol>
<h5 id="对一个已经通过身份验证的用户（通过了上面5个步骤的用户），流程如下："><a href="#对一个已经通过身份验证的用户（通过了上面5个步骤的用户），流程如下：" class="headerlink" title="对一个已经通过身份验证的用户（通过了上面5个步骤的用户），流程如下："></a>对一个已经通过身份验证的用户（通过了上面5个步骤的用户），流程如下：</h5><ol>
<li>用户请求一个受保护的资源路径（比如他自己的账号页面）；</li>
<li>如果用户尚未登录，应用会将他重定向到登录页面。如果用户登录了，应用会使用该会话对应的令牌来发送请求；</li>
<li>服务器对令牌进行校验，并根据请求返回合适的数据。</li>
</ol>

      
    </div>
    
    <div class="article-info article-info-index">
      
      

      
    <div class="article-tag tagcloud">
        <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/angular、-http/">angular、$http</a></li></ul>
    </div>

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>









  
    <article id="post-qianhouduanfenli" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2016/07/16/qianhouduanfenli/" class="article-date">
      <time datetime="2016-07-16T04:41:23.000Z" itemprop="datePublished">2016-07-16</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/07/16/qianhouduanfenli/">前后端分离，是为了彼此更好</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
        <h3 id="一、被误解的前后端分离"><a href="#一、被误解的前后端分离" class="headerlink" title="一、被误解的前后端分离"></a>一、被误解的前后端分离</h3><p>在Web应用开发过程中，业界对前后端的分界线似乎一直都没有确定的概念，不过大多数人以浏览器作为前后端的分界线。将浏览器中为用户进行页面展示的部分称为前端，而将运行于服务器，为前端提供业务逻辑和数据准备的所有代码统称为后端。</p>
<p>虽然前后端分离在数年前就已经开始受到关注，但很多人对它却是只闻其声，未见其形，所以对它产生了一些误解，误以为前后段分离只是一种Web应用的开发模式，只要在Web应用的开发期进行了前后端开发工作的分工就是前后端分离。</p>
<p>其实并非如此，准确的说，前后端分离并不只是开发模式，而是Web应用的一种架构模式。在开发期，前后端工程师可以通过约定好交互接口，实现并行开发；在运行期，前后端分离模式需要对Web应用进行分离部署，前后端之间使用HTTP请求进行交互。然而作为应用的架构模式，前后端分离并不是通过这样一句话就能一概而谈的，我们可以从交互形式、代码组织方式、开发模式三个方面对前后端分离进行认识。<br><img src="http://oi28tswuq.bkt.clouddn.com/images/2.png" alt=""><br>在前后端分离架构中，后端只需要负责按照约定的数据格式向前端提供可调用的API服务即可。前后端之间通过HTTP请求进行交互，前端获取到数据后，进行页面的装配和渲染。<br><img src="http://oi28tswuq.bkt.clouddn.com/images/5.png" alt=""><br>在传统架构模式中，前后端代码存放于同一个代码库中，甚至是同一工程目录下。页面中还夹杂着后端代码。前后端工程师进行开发时，都必须把整个项目导入到开发工具中。</p>
<p>而前后端分离模式在代码组织形式上有以下两种：</p>
<h4 id="半分离"><a href="#半分离" class="headerlink" title="半分离"></a>半分离</h4><p>前后端共用一个代码库，但是代码分别存放在两个工程中。后端不关心或很少关心前端元素的输出情况，前端不能独立进行开发和测试，项目中缺乏前后端交互的测试用例。</p>
<h4 id="分离"><a href="#分离" class="headerlink" title="分离"></a>分离</h4><p>前后端代码库分离，前端代码中有可以进行Mock测试（通过构造虚拟测试对象以简化测试环境的方法）的伪后端，能支持前端的独立开发和测试。而后端代码中除了功能实现外，还有着详细的测试用例，以保证API的可用性，降低集成风险。</p>
<h4 id="3、开发模式"><a href="#3、开发模式" class="headerlink" title="3、开发模式"></a>3、开发模式</h4><p>传统的MVC架构开发，没有进行前后端分离，前端工程师负责编写HTML，完成前端页面设计，然后给后端工程师员套界面，使用模板技术将前端代码转换成JSP页面，同时内嵌java代码。应用运行期，将全部代码进行打包，部署到同一服务器上，或者进行简单的动静态分离部署。</p>
<p>此时，应用的开发流程如下图所示。<br><img src="http://oi28tswuq.bkt.clouddn.com/images/11.png" alt=""><br>在前后端分离架构中，前端工程师只需要编写HTML、js、CSS等前端资源，然后通过HTTP请求调用后端提供的服务即可。除了开发期的分离，在运行期前后端资源也会进行分离部署。</p>
<p>前后端分离之后，开发流程将如下图所示。<br><img src="http://oi28tswuq.bkt.clouddn.com/images/3.png" alt=""><br>通过上面的两幅流程图，不难发现，在开发模式上，前后端分离不仅仅只是工程师的分工开发，更重要的意义在于实现了前后端的并行开发，和简化了开发流程。</p>
<h3 id="二、为什么要“离”：4个好处"><a href="#二、为什么要“离”：4个好处" class="headerlink" title="二、为什么要“离”：4个好处"></a>二、为什么要“离”：4个好处</h3><p>重新认识前后端分离之后，想必大家心里都会有疑问，前后端分离模式与之前的Web应用架构相比可谓是大相径庭，我们为什么要进行前后端分离呢？正如莎士比亚在《哈姆雷特》中的经典名句一样，分还是不分，这是个问题。</p>
<p>从目前应用软件的发展趋势来看，一方面，用户越来越注重软件的体验感，随着互联网的蓬勃发展，应用开始走向多终端化；另一方面，大型应用的架构模式正纷纷向着云化、微服务化发展。</p>
<p>虽然过去的应用架构暂时还能支撑起当下应用的开发，但是各种弊端已经开始浮出水面，几年前能带来开发便捷优势的前后端代码混合模式，在当下已经成为了拖慢我们前进步伐的泥沼，让我们屡屡吃痛。我们之所以开始尝试前后端分离，是为了能在未来获得更好的发展，期望通过前后端分离架构，来为我们带来以下4个方面的提升。</p>
<p>为孵化优质产品打造精益团队</p>
<p>正如康威定律所述，产品是组织沟通结构的缩影，软件开发团队想要孵化出优质的产品，必须先打造一个精益的开发团队。开发团队的组织划分是如何影响产品的孵化呢，我们通过下面的示例来进行说明。</p>
<p>如果开发团队是按照业务边界进行划分的，开发出来的产品将可能会是微服务的架构。<br><img src="http://oi28tswuq.bkt.clouddn.com/images/6.png" alt=""><br>如果开发团队分为前端团队、后台服务团队和DBA团队，产品将会成长为下面的架构。<br><img src="http://oi28tswuq.bkt.clouddn.com/images/4.png" alt=""><br>应用不断迭代，功能日趋完善，开发团队也随之壮大。虽然现在有些人比较推崇全栈工程师，一位全栈工程师就能支持前后端的所有开发。但是试想一下，如果在开发团队中前后端开发分隔不清，职责边界模糊不明，代码均由相同的工程师完成，长此以往前后端代码的耦合程度可想而知。</p>
<p>通过将开发团队前后端分离化，让前后端工程师只需要专注于前端或后端的开发工作，使得前后端工程师分别自治，培养其独特的技术特性，然后构建出一个全栈式的精益开发团队。这样的开发团队能够快速应对需求的变更以及市场的复杂多变，打造出架构清晰、前后端并重的优质产品。</p>
<h4 id="提升开发效率"><a href="#提升开发效率" class="headerlink" title="提升开发效率"></a>提升开发效率</h4><p>传统开发模式中，前后端开发强依赖。需要前端工程师先完成静态页面的Demo，后端工程师才能将页面Demo翻译成VM模板，如果前端页面出现变动，又会需要前后端工程师再走一次开发流程，如此一来开发效率将会变得很低。</p>
<p>前后端分离以后，可以实现前后端代码的解耦，只要前后端沟通约定好应用所需接口以及接口参数，便可以开始并行开发，无需等待对方的开发工作结束。与此同时，即使需求发生变更，只要接口与数据格式不变，后端开发人员就不需要修改代码，只要前端进行变动即可。如此一来整个应用的开发效率必然会有质的提升。</p>
<h4 id="完美应对复杂多变的前端需求"><a href="#完美应对复杂多变的前端需求" class="headerlink" title="完美应对复杂多变的前端需求"></a>完美应对复杂多变的前端需求</h4><p>Web应用的用户体验关注度与日俱增，使得应用的前端界面需要有华丽酷炫的外观，简单易用的操作，变化多样的界面设计和个性化的自定义展示。这使得前端开始变重，逻辑复杂程度加大，渲染效果多样化加剧。</p>
<p>移动终端的大范围普及，让应用向着多终端化发展，这就要求前端页面需要对不同终端的显示都能进行配适。</p>
<p>传统开发模式中，前后端工程师开发职责不明确，面对复杂多变的前端需求，开发团队势必会变得捉襟见肘、不堪重负。</p>
<p>如果开发团队能完成前后端分离的转型，打造优秀的前后端团队，开发独立化，让开发人员做到专注专精，开发能力必然会有所提升，能够完美应对各种复杂多变的前端需求。</p>
<h4 id="增强代码可维护性"><a href="#增强代码可维护性" class="headerlink" title="增强代码可维护性"></a>增强代码可维护性</h4><p>前后端分离后，应用的代码不再是前后端混合，只有在运行期才会有调用依赖关系。应用代码将会变得整洁清晰，不论是代码阅读还是代码维护都会比以前轻松。<br><img src="http://oi28tswuq.bkt.clouddn.com/images/7.png" alt=""></p>
<h3 id="三、我要不要“离”：4种场景"><a href="#三、我要不要“离”：4种场景" class="headerlink" title="三、我要不要“离”：4种场景"></a>三、我要不要“离”：4种场景</h3><p>然而任何一项技术都不是银弹，前后端分离也是如此。虽然前后端分离架构能带来众多优势，但终究得建立在开发团队适合的基础之上。我们暂且以前端页面的渲染效果与逻辑复杂程度把Web应用大致分为轻前端、重前端、前后均衡三种类型，然后加上现在热门的微服务架构应用，一起探讨一下什么样的Web应用适合进行前后端分离。</p>
<h4 id="轻前端"><a href="#轻前端" class="headerlink" title="轻前端"></a>轻前端</h4><p>页面布局简单，颜色、字体类型较少<br>对前端界面的渲染效果没有高要求，无动画效果<br>只有少量、简单的业务逻辑<br>只需要在不同终端上布局能适应</p>
<p>对于这样对前端渲染要求不高，业务逻辑简单的轻前端应用来说，因为涉及到的前端技术并不复杂，所以没必要追求前后端分离。将前后端代码放到一起，反而更方便进行开发，但是在开发过程中需要做到关注点分离（Separate Concern）。</p>
<h4 id="重前端"><a href="#重前端" class="headerlink" title="重前端"></a>重前端</h4><p>页面布局复杂，使用了多种颜色和字体<br>需要有较高的页面渲染效果，有大量动画<br>前端页面中包含有复杂业务逻辑<br>需要在不同终端和浏览器上保证布局适应和渲染效果</p>
<p>对于重前端应用，建议采用前后端分离架构，如果开发团队中前端工程师不足，需要尽早完善前端团队的建设，确保前后端并重。</p>
<h4 id="前后均衡"><a href="#前后均衡" class="headerlink" title="前后均衡"></a>前后均衡</h4><p>页面布局适中，使用的颜色和字体种类不多<br>页面中使用了少许动画效果<br>业务逻辑较为简单，可下沉到后端实现<br>只需要在不同终端上布局能适应</p>
<p>对于前后端均衡应用，建议综合团队的人员结构和未来发展方向进行考虑。如果在团队中前端工程师的占比不高，后续也没有继续发展前端的计划，那么就不建议过于追求前后端分离。如果对未来有更高期望，即使在前端工程师占比不高的情况下，依然建议团队尝试前后端分离转型，开始着手培养合适的前端工程师。如果团队中已经有了相当规模的前端工程师，建议立即转向前后端分离，并且尽早做到前后端代码分离，为前端提供一个可以进行开发调试的伪后端。</p>
<h4 id="微服务架构应用"><a href="#微服务架构应用" class="headerlink" title="微服务架构应用"></a>微服务架构应用</h4><p>微服务架构应用由大量微服务提供者构成，共同为用户提供服务。在微服务架构中，很多微服务提供者都是基于SpringBoot实现的，通过API Getway（API网关）进行微服务的整合，然后在一个统一的前端门户上为用户提供所需服务。</p>
<p>微服务基于SpringBoot开发，要达到快速交付的目的，并且每个微服务的粒度都比较小，这必然需要微服务的前后端由不同的工程师分别实现，然后相互之间使用Restful进行通讯。如果还是沿用之前的开发模式，将会增大微服务架构应用的构建难度。而前后段分离模式正是解决这一难题的良药。</p>
<h3 id="四、分离部署方案浅析"><a href="#四、分离部署方案浅析" class="headerlink" title="四、分离部署方案浅析"></a>四、分离部署方案浅析</h3><p>前后端开发分离之后，应用在部署时也需要进行前后端分离。在进行前后端分离方案选择的时候，需要结合项目的需求情况和用户群体来考虑。目前业内较为常用的前后端分离部署方案有如下几种。</p>
<h4 id="1、Nginx-Server"><a href="#1、Nginx-Server" class="headerlink" title="1、Nginx+Server"></a>1、Nginx+Server</h4><p>将前端资源部署在Nginx上，后端服务部署在常规的服务器。当浏览器发起访问请求的时候，如果请求的是页面资源，Nginx直接把资源返回到前端；如果请求是调用后端服务，则经过Nginx转发到后端服务器，完成响应后经Nginx返回到浏览器。<br><img src="http://oi28tswuq.bkt.clouddn.com/images/8.png" alt=""><br>这个方案比较简单，易于实现，而且能达到前后端解耦的目的。</p>
<p>但是对于页面量比较大，需要有良好SEO的应用来说，此方案缺点也较为明显。因为Nginx只是向浏览器返回页面静态资源，而国内的搜索引擎爬虫只会抓取静态数据，不会解析页面中的js，这使得应用得不到良好的搜索引擎支持。同时因为Nginx不会进行页面的组装渲染，需要把静态页面返回到浏览器，然后完成渲染工作，这加重了浏览器的渲染负担。</p>
<h4 id="2、Node-Server"><a href="#2、Node-Server" class="headerlink" title="2、Node+Server"></a>2、Node+Server</h4><p>这是淘宝所使用的前后端分离模式，在浏览器与后端服务器之间增加一个了Node Server作为中间层，将前端资源部署到Node Server中。Node Server中还包含了一层Model Proxy，负责与服务端进行通信。<br><img src="http://oi28tswuq.bkt.clouddn.com/images/10.png" alt=""><br>浏览器发出的请求都被Node Server接收，然后通过Model Proxy调用后端服务器提供的服务。Node Server得到后端服务器反馈，接着在Node Server中完成页面的组装渲染，把最终页面返回给浏览器。</p>
<p>如此一来不仅达到了前后端解耦的目的，还解决了浏览器渲染负担过重的问题，为SEO提供了比较好的支持。</p>
<p>但在这样的模式中，浏览器所有发出的请求都需要经过Node Server进行中转，然后才能到达后端服务器。在实际的应用中，并不是所有的请求都需要页面渲染，只要在页面上直接调用后端服务器提供的服务即可。所以这个模式必然会对请求性能有所消耗</p>
<h4 id="3、Nginx-Node-Server"><a href="#3、Nginx-Node-Server" class="headerlink" title="3、Nginx+Node+Server"></a>3、Nginx+Node+Server</h4><p>为了能解决方案2中请求性能损失的问题，我们可以考虑在其基础之上增加Nginx。浏览器发起的请求经过Nginx进行分发，URL请求统一分发到Node Server，在Node Server中进行页面组装渲染；API请求则直接发送到后端服务器，完成响应。</p>
<p>目前在已经有一个名为Goku的Go语言框架提供了这样的前后端分离解决方案。<br><img src="http://oi28tswuq.bkt.clouddn.com/images/1.png" alt=""><br>通过对三种前后端分离方案的对比可以看出：</p>
<p>如果是企业级应用，不需要考虑对SEO的支持，浏览器渲染也可以忽略不计，Nginx+Server的模式无疑是最好的选择，实施成本相对来说比较低；</p>
<p>如果是互联网应用，需要有良好的SEO支持，页面渲染工作量大，那应该选择Nginx+Node+Server的方案，各个方面都能得到比较好的兼顾。<br><img src="http://oi28tswuq.bkt.clouddn.com/images/9.png" alt=""></p>
<h3 id="五、总结"><a href="#五、总结" class="headerlink" title="五、总结"></a>五、总结</h3><p>前后端分离并非仅仅只是前后端开发的分工，而是在开发期进行代码存放分离、前后端开发职责分离，前后端能够独立进行开发测试；在运行期进行应用部署分离，前后端之间通过HTTP请求进行通讯。前后端分离的开发模式与传统模式相比，能为我们提升开发效率、增强代码可维护性，让我们有规划地打造一个前后端并重的精益开发团队，更好地应对越来越复杂多变的Web应用开发需求。</p>
<p>传统的前后端混合开发模式，虽然久经考验，到现在依然还是能支撑起应用的开发。但是放眼未来，应用的云化、微服务化势不可挡。同社会分工精细化一样，前后端开发的精细化也是必然趋势。技术在持续进步，架构在不断演进，只有紧跟发展的脚步，不断调整项目管理方式，软件开发模式，才能在互联网浪潮中把握机会，乘风破浪。</p>
<p>前后端分离，是为了让彼此更好。</p>
<p>文章来源网络，版权归作者所有，作者：敖显奇@EAII企业架构创新研究院(eaworld)</p>

      
    </div>
    
    <div class="article-info article-info-index">
      
      

      
    <div class="article-tag tagcloud">
        <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/前后端分享/">前后端分享</a></li></ul>
    </div>

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>









  
    <article id="post-angular-study" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2016/07/13/angular-study/" class="article-date">
      <time datetime="2016-07-13T05:36:32.000Z" itemprop="datePublished">2016-07-13</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/07/13/angular-study/">AngularJS基本知识点</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
        <p>　　AngularJS 是一个 MVVM框架，最适于开发客户端的单页面应用。它不是个功能库，而是用来开发动态网页的框架。它专注于扩展 HTML 的功能，提供动态数据绑定（data binding），而且它能跟其它框架（如 JQuery 等）合作融洽。</p>
<h3 id="1-一个简单示例"><a href="#1-一个简单示例" class="headerlink" title="1. 一个简单示例"></a>1. 一个简单示例</h3><p>通过下面的示例代码，可以运行一个简单的 AngularJS 应用：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line">&lt;!DOCTYPE html&gt;</div><div class="line">&lt;html&gt;</div><div class="line">&lt;body&gt;</div><div class="line"></div><div class="line">&lt;div ng-app=&quot;&quot;&gt;</div><div class="line">  &lt;p&gt;在输入框中尝试输入：&lt;/p&gt;</div><div class="line">  &lt;p&gt;姓名：&lt;input type=&quot;text&quot; ng-model=&quot;name&quot;&gt;&lt;/p&gt;</div><div class="line">  &lt;p ng-bind=&quot;name&quot;&gt;&lt;/p&gt;</div><div class="line">&lt;/div&gt;</div><div class="line"></div><div class="line">&lt;script src=&quot;https://cdnjs.cloudflare.com/ajax/libs/angular.js/1.3.8/angular.min.js&quot;&gt;&lt;/script&gt;</div><div class="line">&lt;/body&gt;</div><div class="line">&lt;/html&gt;</div></pre></td></tr></table></figure></p>
<p>通过浏览器访问该页面，在输入框中输入的内容会立即显示在输入框下面。</p>
<h5 id="说明："><a href="#说明：" class="headerlink" title="说明："></a>说明：</h5><p>当网页加载完毕，AngularJS 自动运行。<br>ng-app 指令告诉 AngularJS ，div 元素是 AngularJS 应用程序的”所有者”，相当于是个作用域的概率。<br>ng-model 指令把输入域的值绑定到应用程序变量 name。<br>ng-bind 指令把应用程序变量 name 绑定到某个段落的 innerHTML。</p>
<h3 id="2-AngularJS-指令"><a href="#2-AngularJS-指令" class="headerlink" title="2. AngularJS 指令"></a>2. AngularJS 指令</h3><p>AngularJS 指令是扩展的 HTML 属性，带有前缀 ng- 。</p>
<p>HTML5 允许扩展的（自制的）属性，以 data- 开头。AngularJS 属性以 ng- 开头，但是您可以使用 data-ng- 来让网页对 HTML5 有效。</p>
<h4 id="常见的指令"><a href="#常见的指令" class="headerlink" title="常见的指令"></a>常见的指令</h4><ul>
<li><p>ng-app 指令</p>
<p>ng-app 指令初始化一个 AngularJS 应用程序。</p>
</li>
<li><p>ng-init 指令</p>
<p>ng-init 指令初始化应用程序数据，这个不常使用。通常情况下，不使用 ng-init。您将使用一个控制器或模块来代替它。</p>
</li>
<li><p>ng-model 指令</p>
<p>ng-model 指令把元素值（比如输入域的值）绑定到应用程序。</p>
</li>
<li><p>ng-bind 指令</p>
<p>ng-bind 指令把应用程序数据绑定到 HTML 视图。</p>
</li>
</ul>
<p>示例：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">&lt;div ng-app=&quot;&quot;&gt;</div><div class="line">  &lt;p&gt;在输入框中尝试输入：&lt;/p&gt;</div><div class="line">  &lt;p&gt;姓名：&lt;input type=&quot;text&quot; ng-model=&quot;name&quot;&gt;&lt;/p&gt;</div><div class="line">  &lt;p ng-bind=&quot;name&quot;&gt;&lt;/p&gt;</div><div class="line">&lt;/div&gt;</div></pre></td></tr></table></figure></p>
<ul>
<li>ng-repeat 指令</li>
</ul>
<p>ng-repeat 指令会重复一个 HTML 元素：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">&lt;div ng-app=&quot;&quot; ng-init=&quot;names=[</div><div class="line">&#123;name:&apos;Jani&apos;,country:&apos;Norway&apos;&#125;,</div><div class="line">&#123;name:&apos;Hege&apos;,country:&apos;Sweden&apos;&#125;,</div><div class="line">&#123;name:&apos;Kai&apos;,country:&apos;Denmark&apos;&#125;]&quot;&gt;</div><div class="line"></div><div class="line">&lt;p&gt;循环对象：&lt;/p&gt;</div><div class="line">  &lt;ul&gt;</div><div class="line">    &lt;li ng-repeat=&quot;x in names&quot;&gt;</div><div class="line"></div><div class="line">    &lt;/li&gt;</div><div class="line">  &lt;/ul&gt;</div><div class="line">&lt;/div&gt;</div></pre></td></tr></table></figure></p>
<p>除此之外，它还提供了几个变量可供使用：</p>
<ul>
<li>index 当前索引</li>
<li>first 是否为头元素</li>
<li>middle 是否为非头非尾元素</li>
<li>last 是否为尾元素</li>
</ul>
<h5 id="样式相关的指令"><a href="#样式相关的指令" class="headerlink" title="样式相关的指令"></a>样式相关的指令</h5><ul>
<li>ng-class</li>
</ul>
<p>ng-class用来给元素绑定类名，其表达式的返回值可以是以下三种：</p>
<p>类名字符串，可以用空格分割多个类名，如 ‘class1 class2’；<br>类名数组，数组中的每一项都会层叠起来生效；<br>一个名值对应的map，其键值为类名，值为boolean类型，当值为true时，该类会被加在元素上。<br>与 ng-class 相近的，ng 还提供了ng-class-odd、ng-class-even 两个指令，用来配合 ng-repeat 分别在奇数列和偶数列使用对应的类。这个用来在表格中实现隔行换色再方便不过了。</p>
<ul>
<li>ng-style</li>
</ul>
<p>ng-style 用来绑定元素的 css 样式，其表达式的返回值为一个 js 对象，键为 css 样式名，值为该样式对应的合法取值。用法比较简单：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">$scope.style = &#123;color:&apos;red&apos;&#125;;　</div><div class="line"></div><div class="line">&lt;div ng-style=&quot;&#123;color:&apos;red&apos;&#125;&quot;&gt;ng-style测试&lt;/div&gt;</div><div class="line">&lt;div ng-style=&quot;style&quot;&gt;ng-style测试&lt;/div&gt;</div><div class="line">ng-show、ng-hide、ng-switch</div></pre></td></tr></table></figure></p>
<p>对于比较常用的元素显隐控制，ng 也做了封装，ng-show 和 ng-hide 的值为 boolean 类型的表达式，当值为 true 时，对应的 show 或 hide 生效。框架会用 display:block 和 display:none 来控制元素的显隐。</p>
<p>示例：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">&lt;div ng-app=&quot;&quot;&gt;</div><div class="line">	&lt;div ng-show=&quot;true&quot;&gt;1&lt;/div&gt;</div><div class="line">	&lt;div ng-show=&quot;false&quot;&gt;2&lt;/div&gt;</div><div class="line">	&lt;div ng-hide=&quot;true&quot;&gt;3&lt;/div&gt;</div><div class="line">	&lt;div ng-hide=&quot;false&quot;&gt;4&lt;/div&gt;</div><div class="line">&lt;/div&gt;</div></pre></td></tr></table></figure></p>
<p>后一个 ng-switch 是根据一个值来决定哪个节点显示，其它节点移除：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">&lt;div ng-init=&quot;a=2&quot;&gt;</div><div class="line">    &lt;ul ng-switch on=&quot;a&quot;&gt;</div><div class="line">	    &lt;li ng-switch-when=&quot;1&quot;&gt;1&lt;/li&gt;</div><div class="line">	    &lt;li ng-switch-when=&quot;2&quot;&gt;2&lt;/li&gt;</div><div class="line">	    &lt;li ng-switch-default&gt;other&lt;/li&gt;</div><div class="line">    &lt;/ul&gt;</div><div class="line">&lt;/div&gt;</div></pre></td></tr></table></figure></p>
<h3 id="事件指令"><a href="#事件指令" class="headerlink" title="事件指令"></a>事件指令</h3><p>事件相关的指令有：</p>
<ul>
<li>ng-change</li>
<li>ng-click</li>
<li>ng-dblclick</li>
<li>ng-mousedown</li>
<li>ng-mouseenter</li>
<li>ng-mouseleave</li>
<li>ng-mousemove</li>
<li>ng-mouseover</li>
<li>ng-mouseup</li>
<li>ng-submit<br>对于事件对象本身，在函数调用时可以直接使用 $event 进行传递：<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">&lt;p ng-click=&quot;click($event)&quot;&gt;点击&lt;/p&gt;</div><div class="line">&lt;p ng-click=&quot;click($event.target)&quot;&gt;点击&lt;/p&gt;</div><div class="line"></div><div class="line">$scope.click = function($event)&#123;</div><div class="line">         alert($event.target);</div><div class="line">         //……………………</div><div class="line">&#125;</div></pre></td></tr></table></figure>
</li>
</ul>
<h3 id="表单指令"><a href="#表单指令" class="headerlink" title="表单指令"></a>表单指令</h3><p>　　表单控件类的模板指令，最大的作用是它预定义了需要绑定的数据的格式。这样，就可以对于既定的数据进行既定的处理。</p>
<h4 id="form"><a href="#form" class="headerlink" title="form"></a>form</h4><p>　　ng 对 form 这个标签作了包装，对应的指令是 <em>ng-form</em>。</p>
<p>　　从 ng 的角度来说， form 标签，是一个模板指令，也创建了一个 FormController 的实例。这个实例就提供了相应的属性和方法。同时，它里面的控件也是一个 NgModelController 实例。</p>
<p>　　<em>很重要的一点</em>， form 的相关方法要生效，必须为 form 标签指定 name 和 ng-controller ，并且每个控件都要绑定一个变量。 form 和控件的名字，即是 $scope 中的相关实例的引用变量名。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">&lt;form name=&quot;test_form&quot; ng-controller=&quot;TestCtrl&quot;&gt;</div><div class="line">  &lt;input type=&quot;text&quot; name=&quot;a&quot; required ng-model=&quot;a&quot;  /&gt;</div><div class="line">  &lt;span ng-click=&quot;see()&quot;&gt;&lt;/span&gt;</div><div class="line">&lt;/form&gt;</div><div class="line"></div><div class="line">var TestCtrl = function($scope)&#123;</div><div class="line">  $scope.see = function()&#123;</div><div class="line">    console.log($scope.test_form);</div><div class="line">    console.log($scope.test_form.a);</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>除去对象的方法与属性， form 这个标签本身有一些动态类可以使用：</p>
<ul>
<li>ng-valid 当表单验证通过时的设置</li>
<li>ng-invalid 当表单验证失败时的设置</li>
<li>ng-pristine 表单的未被动之前拥有</li>
<li>ng-dirty 表单被动过之后拥有</li>
</ul>
<h4 id="form-对象的属性有："><a href="#form-对象的属性有：" class="headerlink" title="form 对象的属性有："></a>form 对象的属性有：</h4><ul>
<li>$pristine 表单是否未被动过</li>
<li>$dirty 表单是否被动过</li>
<li>$valid 表单是否验证通过</li>
<li>$invalid 表单是否验证失败</li>
<li>$error 表单的验证错误<br>其中的 $error 对象包含有所有字段的验证信息，及对相关字段的 NgModelController 实例的引用。它的结构是一个对象， key 是失败信息， required ， minlength 之类的， value 是对应的字段实例列表。</li>
</ul>
<h4 id="input"><a href="#input" class="headerlink" title="input"></a>input</h4><p>input 控件的相关可用属性为：</p>
<ul>
<li>name 名字</li>
<li>ng-model 绑定的数据</li>
<li>required 是否必填</li>
<li>ng-required 是否必填</li>
<li>ng-minlength 最小长度</li>
<li>ng-maxlength 最大长度</li>
<li>ng-pattern 匹配模式</li>
<li>ng-change 值变化时的回调<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">&lt;form name=&quot;test_form&quot; ng-controller=&quot;TestCtrl&quot;&gt;</div><div class="line">  &lt;input type=&quot;text&quot; name=&quot;a&quot; ng-model=&quot;a&quot; required ng-pattern=&quot;/abc/&quot; /&gt;</div><div class="line">  &lt;span ng-click=&quot;see()&quot;&gt;&lt;/span&gt;</div><div class="line">&lt;/form&gt;</div></pre></td></tr></table></figure>
</li>
</ul>
<p>input 控件，它还有一些扩展，这些扩展有些有自己的属性：</p>
<ul>
<li>input type=”number” 多了 number 错误类型，多了 max ， min 属性。</li>
<li>input type=”url” 多了 url 错误类型。</li>
<li>input type=”email” 多了 email 错误类型。</li>
</ul>
<h4 id="checkbox"><a href="#checkbox" class="headerlink" title="checkbox"></a>checkbox</h4><p>它是 input 的扩展，不过，它没有验证相关的东西，只有选中与不选中两个值：ng-true-value、ng-false-value:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">&lt;form name=&quot;test_form&quot; ng-controller=&quot;TestCtrl&quot;&gt;</div><div class="line">  &lt;input type=&quot;checkbox&quot; name=&quot;a&quot; ng-model=&quot;a&quot; ng-true-value=&quot;AA&quot; ng-false-value=&quot;BB&quot; /&gt;</div><div class="line">  &lt;span&gt;&lt;/span&gt;</div><div class="line">&lt;/form&gt;</div></pre></td></tr></table></figure></p>
<h4 id="radio"><a href="#radio" class="headerlink" title="radio"></a>radio</h4><p>它也是 input 的扩展。和 checkbox 一样，但它只有一个值：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">&lt;form name=&quot;test_form&quot; ng-controller=&quot;TestCtrl&quot;&gt;</div><div class="line">  &lt;input type=&quot;radio&quot; name=&quot;a&quot; ng-model=&quot;a&quot; value=&quot;AA&quot; /&gt;</div><div class="line">  &lt;input type=&quot;radio&quot; name=&quot;a&quot; ng-model=&quot;a&quot; value=&quot;BB&quot; /&gt;</div><div class="line">  &lt;span&gt;&lt;/span&gt;</div><div class="line">&lt;/form&gt;</div></pre></td></tr></table></figure></p>
<h4 id="textarea-同-input"><a href="#textarea-同-input" class="headerlink" title="textarea  同 input"></a>textarea  同 input</h4><h4 id="select"><a href="#select" class="headerlink" title="select"></a>select</h4><p>它里面的一个叫做 ng-options 的属性用于数据呈现。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">&lt;form name=&quot;test_form&quot; ng-controller=&quot;TestCtrl&quot; ng-init=&quot;o=[0,1,2,3]; a=o[1];&quot;&gt;</div><div class="line">    &lt;select ng-model=&quot;a&quot; ng-options=&quot;x for x in o&quot;&gt;</div><div class="line">      &lt;option value=&quot;&quot;&gt;可以加这个空值&lt;/option&gt;</div><div class="line">    &lt;/select&gt;</div><div class="line">&lt;/form&gt;</div></pre></td></tr></table></figure></p>
<p>在 $scope 中， select 绑定的变量，其值和普通的 value 无关，可以是一个对象：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">&lt;form name=&quot;test_form&quot; ng-controller=&quot;TestCtrl&quot;</div><div class="line">    ng-init=&quot;o=[&#123;name: &apos;AA&apos;&#125;, &#123;name: &apos;BB&apos;&#125;]; a=o[1];&quot;&gt;</div><div class="line">    &lt;select ng-model=&quot;a&quot; ng-options=&quot;x.name for x in o&quot; /&gt;</div><div class="line">&lt;/form&gt;</div></pre></td></tr></table></figure></p>
<p>显示与值分别指定， x.v as x.name for x in o ： as for  in 要理解清楚！<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">&lt;form name=&quot;test_form&quot; ng-controller=&quot;TestCtrl&quot;</div><div class="line">    ng-init=&quot;o=[&#123;name: &apos;AA&apos;, v: &apos;00&apos;&#125;, &#123;name: &apos;BB&apos;, v: &apos;11&apos;&#125;]; a=o[1].v;&quot;&gt;</div><div class="line">    &lt;select ng-model=&quot;a&quot; ng-options=&quot;x.v as x.name for x in o&quot; /&gt;</div><div class="line">&lt;/form&gt;</div></pre></td></tr></table></figure></p>
<p>加入分组的， x.name group by x.g for x in o ：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">&lt;form name=&quot;test_form&quot; ng-controller=&quot;TestCtrl&quot;</div><div class="line">    ng-init=&quot;o=[&#123;name: &apos;AA&apos;, g: &apos;00&apos;&#125;, &#123;name: &apos;BB&apos;, g: &apos;11&apos;&#125;, &#123;name: &apos;CC&apos;, g: &apos;00&apos;&#125;]; a=o[1];&quot;&gt;</div><div class="line">    &lt;select ng-model=&quot;a&quot; ng-options=&quot;x.name group by x.g for x in o&quot; /&gt;</div><div class="line">&lt;/form&gt;</div></pre></td></tr></table></figure></p>
<p>分组了还分别指定显示与值的， x.v as x.name group by x.g for x in o ：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">&lt;form name=&quot;test_form&quot; ng-controller=&quot;TestCtrl&quot; ng-init=&quot;o=[&#123;name: &apos;AA&apos;, g: &apos;00&apos;, v: &apos;=&apos;&#125;, &#123;name: &apos;BB&apos;, g: &apos;11&apos;, v: &apos;+&apos;&#125;, &#123;name: &apos;CC&apos;, g: &apos;00&apos;, v: &apos;!&apos;&#125;]; a=o[1].v;&quot;&gt;</div><div class="line">    &lt;select ng-model=&quot;a&quot; ng-options=&quot;x.v as x.name group by x.g for x in o&quot; /&gt;</div><div class="line">&lt;/form&gt;</div></pre></td></tr></table></figure></p>
<p>如果参数是对象的话，基本也是一样的，只是把遍历的对象改成 (key, value) ：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line">&lt;form name=&quot;test_form&quot; ng-controller=&quot;TestCtrl&quot; ng-init=&quot;o=&#123;a: 0, b: 1&#125;; a=o.a;&quot;&gt;</div><div class="line">	&lt;select ng-model=&quot;a&quot; ng-options=&quot;k for (k, v) in o&quot; /&gt;</div><div class="line">&lt;/form&gt;</div><div class="line">&lt;form name=&quot;test_form&quot; ng-controller=&quot;TestCtrl&quot;</div><div class="line">	ng-init=&quot;o=&#123;a: &#123;name: &apos;AA&apos;, v: &apos;00&apos;&#125;, b: &#123;name: &apos;BB&apos;, v: &apos;11&apos;&#125;&#125;; a=o.a.v;&quot;&gt;</div><div class="line">	&lt;select ng-model=&quot;a&quot; ng-options=&quot;v.v as v.name for (k, v) in o&quot; /&gt;</div><div class="line">&lt;/form&gt;</div><div class="line">&lt;form name=&quot;test_form&quot; ng-controller=&quot;TestCtrl&quot;</div><div class="line">	ng-init=&quot;o=&#123;a: &#123;name: &apos;AA&apos;, v: &apos;00&apos;, g: &apos;==&apos;&#125;, b: &#123;name: &apos;BB&apos;, v: &apos;11&apos;, g: &apos;==&apos;&#125;&#125;; a=o.a;&quot;&gt;</div><div class="line">	&lt;select ng-model=&quot;a&quot; ng-options=&quot;v.name group by v.g for (k, v) in o&quot; /&gt;</div><div class="line">&lt;/form&gt;</div><div class="line">&lt;form name=&quot;test_form&quot; ng-controller=&quot;TestCtrl&quot;</div><div class="line">	ng-init=&quot;o=&#123;a: &#123;name: &apos;AA&apos;, v: &apos;00&apos;, g: &apos;==&apos;&#125;, b: &#123;name: &apos;BB&apos;, v: &apos;11&apos;, g: &apos;==&apos;&#125;&#125;; a=o.a.v;&quot;&gt;</div><div class="line">	&lt;select ng-model=&quot;a&quot; ng-options=&quot;v.v as v.name group by v.g for (k, v) in o&quot; /&gt;</div><div class="line">&lt;/form&gt;</div></pre></td></tr></table></figure></p>
<p>还有一些表单控件功能相关的指令：</p>
<ul>
<li>ng-src src 属性</li>
<li>ng-href href 属性</li>
<li>ng-checked 控制 radio 和 checkbox 的选中状态</li>
<li>ng-selected 控制下拉框的选中状态</li>
<li>ng-disabled 控制失效状态</li>
<li>ng-multiple 控制多选</li>
<li>ng-readonly 控制只读状态<br>以上指令的取值均为 boolean 类型，当值为 true 时相关状态生效，道理比较简单就不多做解释。</li>
</ul>
<p><em>注意</em>:上面的这些只是单向绑定，即只是从数据到模板，不能反作用于数据。要双向绑定，还是要使用 ng-model 。</p>
<h3 id="3-AngularJS-过滤器"><a href="#3-AngularJS-过滤器" class="headerlink" title="3. AngularJS 过滤器"></a>3. AngularJS 过滤器</h3><p>　　过滤器（filter）正如其名，作用就是接收一个输入，通过某个规则进行处理，然后返回处理后的结果。主要用在数据的格式化上，例如获取一个数组中的子集，对数组中的元素进行排序等。过滤器通常是伴随标记来使用的，将你 model 中的数据格式化为需要的格式。表单的控制功能主要涉及到数据验证以及表单控件的增强。</p>
<h4 id="内置过滤器"><a href="#内置过滤器" class="headerlink" title="内置过滤器"></a>内置过滤器</h4><p>　　ng 内置了一些过滤器，它们是：currency(货币)、date(日期)、filter(子串匹配)、json(格式化json对象)、limitTo(限制个数)、lowercase(小写)、uppercase(大写)、number(数字)、orderBy(排序)。</p>
<p>过滤器使用示例：</p>
<ul>
<li><p>使用currency可以将数字格式化为货币，默认是美元符号，你可以自己传入所需的符号</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">&#123;&#123;num | currency : &apos;￥&apos;&#125;&#125;</div></pre></td></tr></table></figure>
</li>
<li><p>参数用来指定所要的格式，y M d h m s E 分别表示 年 月 日 时 分 秒 星期，你可以自由组合它们。也可以使用不同的个数来限制格式化的位数。另外参数也可以使用特定的描述性字符串，例如“shortTime”将会把时间格式为12:05 pm这样的。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">&#123;&#123;date | date : &apos;yyyy-MM-dd hh:mm:ss EEEE&apos;&#125;&#125;</div></pre></td></tr></table></figure>
</li>
<li><p>filter 过滤器从数组中选择一个子集：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">&#123;&#123; childrenArray | filter : &apos;a&apos; &#125;&#125; //匹配属性值中含有a的</div><div class="line">&#123;&#123; childrenArray | filter : 4 &#125;&#125;  //匹配属性值中含有4的</div><div class="line">&#123;&#123; childrenArray | filter : &#123;name : &apos;i&apos;&#125; &#125;&#125; //参数是对象，匹配name属性中含有i的</div><div class="line">$scope.func = function(e)&#123;return e.age&gt;4;&#125;&#123;&#123; childrenArray | filter : &apos;a&apos; &#125;&#125;</div><div class="line">&#123;&#123;childrenArray | filter : func &#125;&#125;  //参数是函数</div></pre></td></tr></table></figure>
</li>
<li><p>json过滤器可以把一个js对象格式化为json字符串</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">&#123;&#123; jsonTest | json&#125;&#125;</div></pre></td></tr></table></figure>
</li>
<li><p>列表截取 limitTo ，支持正负数</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">&#123;&#123; childrenArray | limitTo : 2 &#125;&#125;</div></pre></td></tr></table></figure>
</li>
<li><p>number过滤器可以为一个数字加上千位分割，像这样，123,456,789。同时接收一个参数，可以指定float类型保留几位小数：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">&#123;&#123; num | number : 2 &#125;&#125;</div></pre></td></tr></table></figure>
</li>
<li><p>大小写 lowercase ， uppercase ：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">&#123;&#123; &apos;abc&apos; | uppercase &#125;&#125;</div><div class="line">&#123;&#123; &apos;Abc&apos; | lowercase &#125;&#125;</div></pre></td></tr></table></figure>
</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">&#123;&#123; childrenArray | orderBy : &apos;age&apos; &#125;&#125;       //按age属性值进行排序，若是-age，则倒序</div><div class="line">&#123;&#123; childrenArray | orderBy : orderFunc &#125;&#125;   //按照函数的返回值进行排序</div><div class="line">&#123;&#123; childrenArray | orderBy : [&apos;age&apos;,&apos;name&apos;] &#125;&#125;  //如果age相同，按照name进行排序</div></pre></td></tr></table></figure>
<p><em>过滤器使用方式</em></p>
<p>在模块中定义过滤器：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">var app = angular.module(&apos;Demo&apos;, [], angular.noop);</div><div class="line">  app.filter(&apos;map&apos;, function()&#123;</div><div class="line">    var filter = function(input)&#123;</div><div class="line">      return input + &apos;...&apos;;</div><div class="line">    &#125;;</div><div class="line">    return filter;</div><div class="line">  &#125;);</div></pre></td></tr></table></figure></p>
<p>然后，在模板中使用：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">&lt;p&gt;示例数据: &#123;&#123; a | map &#125;&#125;&lt;/p&gt;</div></pre></td></tr></table></figure></p>
<h3 id="4-AngularJS-Ajax"><a href="#4-AngularJS-Ajax" class="headerlink" title="4. AngularJS Ajax"></a>4. AngularJS Ajax</h3><p>　　$http 服务是 AngularJS 的核心服务之一，它帮助我们通过 XMLHttpRequest 对象或 JSONP 与远程 HTTP 服务进行交流。</p>
<p>　　$http 服务是这样一个函数：它接受一个设置对象，其中指定了如何创建 HTTP 请求；它将返回一个 promise 对象，其中提供两个方法： success 方法和 error方法。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">$http.get(&#123;url:&quot;/xxx.action&quot;&#125;).success(function(data)&#123;</div><div class="line">    alert(data);</div><div class="line">&#125;).error(function()&#123;</div><div class="line">    alert(&quot;error&quot;);</div><div class="line">&#125;);</div></pre></td></tr></table></figure></p>
<p>$http 接受的配置项有：</p>
<ul>
<li>method 方法</li>
<li>url 路径</li>
<li>params GET请求的参数</li>
<li>data post请求的参数</li>
<li>headers 头</li>
<li>transformRequest 请求预处理函数</li>
<li>transformResponse 响应预处理函数</li>
<li>cache 缓存</li>
<li>timeout 超时毫秒，超时的请求会被取消</li>
<li>withCredentials 跨域安全策略的一个东西<br>　　其中的 transformRequest 和 transformResponse 及 headers 已经有定义的，如果自定义则会覆盖默认定义</li>
</ul>
<p>对于几个标准的 HTTP 方法，有对应的 shortcut(捷径的意思) ：</p>
<ul>
<li>$http.delete(url, config)</li>
<li>$http.get(url, config)</li>
<li>$http.head(url, config)</li>
<li>$http.jsonp(url, config)</li>
<li>$http.post(url, data, config)</li>
<li>$http.put(url, data, config)<br>　　注意其中的 JSONP 方法，在实现上会在页面中添加一个 script 标签，然后放出一个 GET 请求。你自己定义的，匿名回调函数，会被 ng 自已给一个全局变量。在定义请求，作为 GET 参数，你可以使用 JSON_CALLBACK 这个字符串来暂时代替回调函数名，之后 ng 会为你替换成真正的函数名：<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">var p = $http(&#123;</div><div class="line">	method: &apos;JSONP&apos;,</div><div class="line">	url: &apos;/json&apos;,</div><div class="line">	params: &#123;callback: &apos;JSON_CALLBACK&apos;&#125;</div><div class="line">&#125;);</div><div class="line">p.success(function(response, status, headers, config)&#123;</div><div class="line">	console.log(response);</div><div class="line">	$scope.name = response.name;</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
</li>
</ul>
<p>$http 有两个属性：</p>
<ul>
<li>defaults 请求的全局配置</li>
<li>pendingRequests 当前的请求队列状态<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">$http.defaults.transformRequest = function(data)&#123;</div><div class="line">    console.log(&apos;here&apos;); return data;&#125;</div><div class="line">console.log($http.pendingRequests);</div></pre></td></tr></table></figure>
</li>
</ul>
<h3 id="5-AngularJS-控制器"><a href="#5-AngularJS-控制器" class="headerlink" title="5. AngularJS 控制器"></a>5. AngularJS 控制器</h3><p>　　AngularJS 应用程序被控制器控制，控制器是 JavaScript 对象，由标准的 JavaScript 对象的构造函数 创建。</p>
<p>　　ng-controller 指令定义了应用程序控制器，给所在的 DOM 元素创建了一个新的 $scope 对象，并将这个 $scope 对象包含进外层 DOM 元素的 $scope 对象里。</p>
<p>示例如下：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line">&lt;div ng-app=&quot;&quot; ng-controller=&quot;personController&quot;&gt;</div><div class="line">名： &lt;input type=&quot;text&quot; ng-model=&quot;person.firstName&quot;&gt;&lt;br&gt;</div><div class="line">姓： &lt;input type=&quot;text&quot; ng-model=&quot;person.lastName&quot;&gt;&lt;br&gt;</div><div class="line">&lt;br&gt;</div><div class="line">姓名： &#123;&#123;fullName()&#125;&#125;</div><div class="line">&lt;/div&gt;</div><div class="line">&lt;script&gt;</div><div class="line">function personController($scope) &#123;</div><div class="line">	$scope.person = &#123;</div><div class="line">		firstName: &quot;John&quot;,</div><div class="line">		lastName: &quot;Doe&quot;,</div><div class="line">	 &#125;;</div><div class="line">	 $scope.fullName = function() &#123;</div><div class="line">		 var x;</div><div class="line">		 x = $scope.person; </div><div class="line">		 return x.firstName + &quot; &quot; + x.lastName;</div><div class="line">	 &#125;;</div><div class="line">&#125;</div><div class="line">&lt;/script&gt;</div></pre></td></tr></table></figure></p>
<p>　　$scope 是一个把 view（一个DOM元素）连结到 controller 上的对象。在我们的 MVC 结构里，这个 $scope 将成为 model，它提供一个绑定到DOM元素（以及其子元素）上的excecution context。</p>
<p>　　尽管听起来有点复杂，但 $scope 实际上就是一个JavaScript 对象，controller 和 view 都可以访问它，所以我们可以利用它在两者间传递信息。在这个 $scope 对象里，我们既存储数据，又存储将要运行在view上的函数。</p>
<p>　　每一个 Angular 应用都会有一个 $rootScope。这个 $rootScope 是最顶级的 scope，它对应着含有 ng-app 指令属性的那个 DOM 元素</p>
<p>　　所有scope都遵循原型继承（prototypal inheritance），这意味着它们都能访问父scope们。</p>
<h3 id="6-AngularJS-模块"><a href="#6-AngularJS-模块" class="headerlink" title="6. AngularJS 模块"></a>6. AngularJS 模块</h3><p>　　AngularJS 本身的一个默认模块叫做 ng ，它提供了 $http ， $q 等等服务。</p>
<p>　　服务只是模块提供的多种机制中的一种，其它的还有命令（ directive ），过滤器（ filter ），及其它配置信息。</p>
<p>　　然后在额外的 js 文件中有一个附加的模块叫做 ngResource ， 它提供了一个 $resource 服务。</p>
<h4 id="定义模块"><a href="#定义模块" class="headerlink" title="定义模块"></a>定义模块</h4><p>　　定义模块的方法是使用 angular.module 。调用时声明了对其它模块的依赖，并定义了“初始化”函数。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">var my_module = angular.module(&apos;MyModule&apos;, [], function()&#123;</div><div class="line">    console.log(&apos;here&apos;);</div><div class="line">&#125;);</div></pre></td></tr></table></figure></p>
<p>这段代码定义了一个叫做 MyModule 的模块， my_module 这个引用可以在接下来做其它的一些事，比如定义服务。</p>
<h4 id="定义服务"><a href="#定义服务" class="headerlink" title="定义服务"></a>定义服务</h4><p>　　ng的服务是这样定义的：</p>
<p>　　Angular services are singletons objects or functions that carry out specific tasks common to web apps.</p>
<p>　　它是一个单例对象或函数，对外提供特定的功能。<br>　　首先是一个单例，即无论这个服务被注入到任何地方，对象始终只有一个实例。<br>　　其次这与我们自己定义一个function然后在其他地方调用不同，因为服务被定义在一个模块中，所以其使用范围是可以被我们管理的。ng的避免全局变量污染意识非常强。<br>　　ng提供了很多内置的服务，可以到API中查看 <a href="http://docs.angularjs.org/api/" target="_blank" rel="external">http://docs.angularjs.org/api/</a> 。如同指令一样，系统内置的服务以$开头，我们也可以自己定义一个服务。</p>
<p>　　在这里呢，就要先介绍一下叫 provider 的东西。简单来说， provider 是被 注入控制器 使用的一个对象，注入机制通过调用一个 provider 的 $get() 方法，把得到的东西作为参数进行相关调用（比如把得到的服务作为一个 Controller 的参数）。</p>
<p>　　在这里 服务 的概念就比较不明确，对使用而言，服务仅指 $get() 方法返回的东西，但是在整体机制上，服务又要指提供了 $get() 方法的整个对象。</p>
<ul>
<li><p>这是一个provider</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">var pp = function()&#123;</div><div class="line">  this.$get = function()&#123;</div><div class="line">    return &#123;&apos;haha&apos;: &apos;123&apos;&#125;;</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
</li>
<li><p>我在模块的初始化过程当中, 定义了一个叫 PP 的服务</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">var app = angular.module(&apos;Demo&apos;, [], function($provide)&#123;</div><div class="line">  $provide.provider(&apos;PP&apos;, pp);</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
</li>
<li><p>PP服务实际上就是 pp 这个 provider 的 $get() 方法返回的东西</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">app.controller(&apos;TestCtrl&apos;,</div><div class="line">  function($scope, PP)&#123;</div><div class="line">    console.log(PP);</div><div class="line">  &#125;</div><div class="line">);</div></pre></td></tr></table></figure>
</li>
</ul>
<p>　　ng 还有相关的 shortcut， 第一个是 factory 方法 ，由 $provide 提供， module 的 factory 是一个引用，作用一样。这个方法直接把一个函数当成是一个对象的 $get() 方法，这样你就不用显式地定义一个 provider 了：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">var app = angular.module(&apos;Demo&apos;, [], function($provide)&#123;</div><div class="line">    $provide.factory(&apos;PP&apos;, function()&#123;</div><div class="line">        return &#123;&apos;hello&apos;: &apos;123&apos;&#125;;</div><div class="line">    &#125;);</div><div class="line">&#125;);</div><div class="line">app.controller(&apos;TestCtrl&apos;, function($scope, PP)&#123; console.log(PP) &#125;);</div></pre></td></tr></table></figure></p>
<p>在 module 中使用：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">var app = angular.module(&apos;Demo&apos;, [], function()&#123; &#125;);</div><div class="line">app.factory(&apos;PP&apos;, function()&#123;return &#123;&apos;abc&apos;: &apos;123&apos;&#125;&#125;);</div><div class="line">app.controller(&apos;TestCtrl&apos;, function($scope, PP)&#123; console.log(PP) &#125;);</div></pre></td></tr></table></figure></p>
<p>　　第二个是 service 方法，也是由 $provide 提供， module 中有对它的同名引用。 service 和 factory 的区别在于，前者是要求提供一个“构造方法”，后者是要求提供 $get() 方法。意思就是，前者一定是得到一个 object ，后者可以是一个数字或字符串。它们的关系大概是：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">var app = angular.module(&apos;Demo&apos;, [], function()&#123; &#125;);</div><div class="line">app.service = function(name, constructor)&#123;</div><div class="line">    app.factory(name, function()&#123;</div><div class="line">      return (new constructor());</div><div class="line">    &#125;);</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>service 方法的使用就很简单了：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">var app = angular.module(&apos;Demo&apos;, [], function()&#123; &#125;);</div><div class="line">app.service(&apos;PP&apos;, function()&#123;</div><div class="line">    this.abc = &apos;123&apos;;</div><div class="line">&#125;);</div><div class="line">app.controller(&apos;TestCtrl&apos;, function($scope, PP)&#123; console.log(PP) &#125;);</div></pre></td></tr></table></figure></p>
<p>引入模块并使用服务<br>结合上面的 定义模块 和 定义服务 ，我们可以方便地组织自己的额外代码：</p>
<ul>
<li><p>定义服务</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">angular.module(&apos;MyModule&apos;, [], function($provide)&#123;</div><div class="line">    $provide.factory(&apos;S1&apos;, function()&#123;</div><div class="line">      return &apos;I am S1&apos;;</div><div class="line">    &#125;);</div><div class="line">    $provide.factory(&apos;S2&apos;, function()&#123;</div><div class="line">      return &#123;see: function()&#123;return &apos;I am S2&apos;&#125;&#125;</div><div class="line">    &#125;);</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
</li>
<li><p>调用服务</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">var app = angular.module(&apos;Demo&apos;, [&apos;MyModule&apos;], angular.noop);</div><div class="line">app.controller(&apos;TestCtrl&apos;, function($scope, S1, S2)&#123;</div><div class="line">    console.log(S1)</div><div class="line">    console.log(S2.see())</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
</li>
</ul>
<h3 id="7-附加模块-ngResource"><a href="#7-附加模块-ngResource" class="headerlink" title="7. 附加模块 ngResource"></a>7. 附加模块 ngResource</h3><p>　　ngResource 这个是 ng 官方提供的一个附加模块。 附加 的意思就是，如果你打算用它，那么你需要引入一人单独的 js 文件，然后在声明“根模块”时注明依赖的 ngResource 模块，接着就可以使用它提供的 $resource 服务了。</p>
<p>　　$resource 服务主要是包装了 AJAX 的调用，使用 $resource 需要先定义“资源”，也就是先定义一些 HTTP 请求。</p>
<h3 id="8-AngularJS-路由"><a href="#8-AngularJS-路由" class="headerlink" title="8. AngularJS 路由"></a>8. AngularJS 路由</h3><p>ng的路由(ngRoute)是一个单独的模块，包含以下内容：</p>
<p>服务 $routeProvider 用来定义一个路由表，即地址栏与视图模板的映射<br>服务 $routeParams 保存了地址栏中的参数，例如 {id : 1, name : ‘tom’}<br>服务 $route 完成路由匹配，并且提供路由相关的属性访问及事件，如访问当前路由对应的 controller<br>指令 ngView 用来在主视图中指定加载子视图的区域</p>
<h4 id="定义路由"><a href="#定义路由" class="headerlink" title="定义路由"></a>定义路由</h4><ul>
<li>第一步：引入文件和依赖</li>
</ul>
<p>ngRoute 也是一个附件模块，故需要在页面上引入 angular-route.min.js 并在模块中注入对 ngRoute 的依赖，如下：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">var app = angular.module(&apos;MyApp&apos;, [&apos;ngRoute&apos;]);//一切从模块开始</div></pre></td></tr></table></figure></p>
<ul>
<li>第二步：定义路由表</li>
</ul>
<p>　　$routeProvider 提供了定义路由表的服务，它有两个核心方法： when(path,route) 和 otherwise(params) ，先看一下核心中的核心 when(path,route)方法。</p>
<p>　　when(path,route) 方法接收两个参数:</p>
<p>　　path 是一个 string 类型，表示该条路由规则所匹配的路径，它将与地址栏的内容($location.path)值进行匹配。如果需要匹配参数，可以在 path 中使用冒号加名称的方式，如：path为 /show/:name ，如果地址栏是 /show/tom ，那么参数 name 和所对应的值 tom 便会被保存在 $routeParams 中，像这样： {name : tom} 。我们也可以用 <em> 进行模糊匹配，如： /show</em>/:name 将匹配 /showInfo/tom 。</p>
<p>　　route 参数是一个 object，用来指定当 path 匹配后所需的一系列配置项，包括以下内容：<br>　　controller function 或 string 类型。在当前模板上执行的 controller 函数，生成新的 scope；<br>　　controllerAs string 类型，为 controller 指定别名；<br>　　template string 或 function 类型，视图所用的模板，这部分内容将被 ngView 引用；<br>　　templateUrl string 或 function 类型，当视图模板为单独的 html 文件或是使用了 <script type="text/ng-template"> 定义模板时使用；<br>　　resolve 指定当前 controller 所依赖的其他模块；<br>　　redirectTo 重定向的地址。</p>
<ul>
<li>第三步：在主视图模板中指定加载子视图的位置</li>
</ul>
<p>只需在模板中简单的使用此 ngView 指令:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">&lt;div ng-view&gt;&lt;/div&gt;</div></pre></td></tr></table></figure></p>
<p>TODO UI-ROUTE</p>
</script></p>
      
    </div>
    
    <div class="article-info article-info-index">
      
      

      
    <div class="article-tag tagcloud">
        <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/angular/">angular</a></li></ul>
    </div>

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>









  
    <article id="post-yahuyouhua" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2016/07/04/yahuyouhua/" class="article-date">
      <time datetime="2016-07-04T06:52:55.000Z" itemprop="datePublished">2016-07-04</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/07/04/yahuyouhua/">雅虎网站性能优化的 14 条规则</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
        <ol>
<li>尽可能减少 HTTP 请求数</li>
<li>使用 CDN（内容分发网络）</li>
<li>为文件头指定 Expires 或 Cache-Control，使内容具有缓存性</li>
<li>使用 Gzip 压缩内容</li>
<li>把 CSS 放到顶部</li>
<li>把 JavaScript 放在底部</li>
<li>避免在 CSS 中使用 Expressions</li>
<li>把 JavaScript 和 CSS 都放到外部文件中</li>
<li>减少 DNS 查找次数</li>
<li>压缩 JavaScript 和 CSS</li>
<li>避免重定向</li>
<li>剔除重复的 JavaScript 和 CSS</li>
<li>配置 Etags</li>
<li>使 AJAX 缓存</li>
</ol>
<h4 id="对上述规则的分析"><a href="#对上述规则的分析" class="headerlink" title="对上述规则的分析"></a>对上述规则的分析</h4><p>一、 代码编写方面的规则</p>
<ul>
<li>把 CSS 放到顶部</li>
<li>把 JavaScript 放在底部</li>
<li>把 JavaScript 和 CSS 都放到外部文件中</li>
<li>避免在 CSS 中使用 Expressions（css表达式）</li>
<li>使 AJAX 缓存</li>
</ul>
<p>二、 打包方面的规则：</p>
<ul>
<li>尽可能减少 HTTP 请求数</li>
<li>压缩 JavaScript 和 CSS</li>
<li>剔除重复的 JavaScript 和 CSS</li>
</ul>
<p>三、 部署方面的规则：</p>
<ul>
<li>使用 CDN（内容分发网络）</li>
<li>为文件头指定 Expires 或 Cache-Control，使内容具有缓存性</li>
<li>使用 Gzip 压缩内容</li>
<li>减少 DNS 查找次数</li>
<li>避免重定向</li>
<li>配置 Etags</li>
</ul>
<h4 id="对规则的实践"><a href="#对规则的实践" class="headerlink" title="对规则的实践"></a>对规则的实践</h4><ul>
<li>部署方面的规则，应用 Nginx 为静态文件添加 Expires 跟 Cache-Control 头， 配置 Etags，并启用 Gzip 压缩。并且避免在 Nginx 中做重定向，有条件的话可以 启用 CDN，并优化网络配置以减少 DNS 查找次数。</li>
<li>代码编写方面的规则，需要在编写代码种形成规范。默认使用类似 jQuery 这样的库 便可以对 AJAX 进行缓存。</li>
<li>打包方面 webpack 可以合并压缩 JavaScript 与 CSS 文件, 小图片的合并（css雪碧图）或者字体图标或者用base64 用以减少 HTTP 请求数。</li>
</ul>

      
    </div>
    
    <div class="article-info article-info-index">
      
      

      
    <div class="article-tag tagcloud">
        <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/性能优化/">性能优化</a></li></ul>
    </div>

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>









  
    <article id="post-angular-guide17-angular中的promise" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2016/06/29/angular-guide17-angular中的promise/" class="article-date">
      <time datetime="2016-06-28T16:50:58.000Z" itemprop="datePublished">2016-06-29</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/06/29/angular-guide17-angular中的promise/">Angular中如何使用promise</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
        <h4 id="Angular-中的-promise"><a href="#Angular-中的-promise" class="headerlink" title="Angular 中的 promise"></a>Angular 中的 promise</h4><p>Angular的事件循环给予了Angular特有的能力，能在$rootScope.$evalAsync阶段中执行promise, promise会坐等$digest运行循环结束。<br>我们来建一个例子，从GitHub上返回一组针对AngularJS的开放pull请求。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">&lt;h1&gt;Open Pull Requests for Angular JS&lt;/h1&gt;</div><div class="line">&lt;ul ng-controller=&quot;DashboardController&quot;&gt;</div><div class="line">&lt;li ng-repeat=&quot;pr in pullRequests&quot;&gt;</div><div class="line">&#123;&#123; pr.title &#125;&#125;</div><div class="line">&lt;/li&gt;</div><div class="line">&lt;/ul&gt;</div></pre></td></tr></table></figure></p>
<p>如果有个服务返回了一个promise，可以在.then()方法中与这个promise交互，它允许我们修改作用域上的任意变量，放置到视图上，并且期望Angular会为我们执行它：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">angular.module(&apos;myApp&apos;, [])</div><div class="line">.controller(&apos;DashboardController&apos;, [</div><div class="line">&apos;$scope&apos;, &apos;GithubService&apos;,</div><div class="line">function($scope, UserService) &#123;</div><div class="line">// GithubService的getPullRequests()方法</div><div class="line">// 返回了一个promise</div><div class="line">User.getPullRequests(123)</div><div class="line">.then(function(data) &#123;</div><div class="line">$scope.pullRequests = data.data;</div><div class="line">&#125;);</div><div class="line">&#125;]);</div></pre></td></tr></table></figure></p>
<p>当 对 getPullRequests 的 异 步 调 用 返回 时 ， 在 .then()方 法 中 就 可 以 用 $scope.pull Requests这个值了，然后它会更新$scope.pullRequests数组。<br>Angular 中的 promise<br>Angular的事件循环给予了Angular特有的能力，能在$rootScope.$evalAsync阶段中执行<br>promise（关于运行循环的更多细节，参见第24章）。 promise会坐等$digest运行循环结束。<br>这件事让我们能毫无压力地把promise的结果转换到视图上。它也能让我们不加思考地把<br>XHR调用的结果直接赋值到$scope对象的属性上。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">&lt;h1&gt;Open Pull Requests for Angular JS&lt;/h1&gt;</div><div class="line">&lt;ul ng-controller=&quot;DashboardController&quot;&gt;</div><div class="line">&lt;li ng-repeat=&quot;pr in pullRequests&quot;&gt;</div><div class="line">&#123;&#123; pr.title &#125;&#125;</div><div class="line">&lt;/li&gt;</div><div class="line">&lt;/ul&gt;</div></pre></td></tr></table></figure></p>
<p>如果有个服务返回了一个promise，可以在.then()方法中与这个promise交互，它允许我们修改作用域上的任意变量，放置到视图上，并且期望Angular会为我们执行它：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">angular.module(&apos;myApp&apos;, [])</div><div class="line">.controller(&apos;DashboardController&apos;, [</div><div class="line">&apos;$scope&apos;, &apos;GithubService&apos;,</div><div class="line">function($scope, UserService) &#123;</div><div class="line">// GithubService的getPullRequests()方法</div><div class="line">// 返回了一个promise</div><div class="line">User.getPullRequests(123)</div><div class="line">.then(function(data) &#123;</div><div class="line">$scope.pullRequests = data.data;</div><div class="line">&#125;);</div><div class="line">&#125;]);</div></pre></td></tr></table></figure></p>
<p>当 对 getPullRequests 的 异 步 调 用 返回 时 ， 在 .then()方 法 中 就 可 以 用 $scope.pull<br>Requests这个值了，然后它会更新$scope.pullRequests数组。</p>
<h4 id="如何创建一个-promise"><a href="#如何创建一个-promise" class="headerlink" title="如何创建一个 promise"></a>如何创建一个 promise</h4><p>想要在Angular中创建promise，可以使用内置的$q服务。 $q服务在它的deferred API中提供了一些方法。<br>首先，需要把$q服务注入到想要使用它的对象中。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">angular.module(&apos;myApp&apos;, [])</div><div class="line">.factory(&apos;GithubService&apos;, [&apos;$q&apos;, function($q) &#123;</div><div class="line">// 现在就可以访问到$q库了</div><div class="line">&#125;]);</div></pre></td></tr></table></figure></p>
<p>要创建一个deferred对象，可以调用defer()方法：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">var deferred = $q.defer();</div></pre></td></tr></table></figure></p>
<p>deferred对象暴露了三个方法，以及一个可以用于处理promise的promise属性。<br>可以用于处理promise的promise属性：这句话其实就是说deferred对象有一个promise属性。即deferred.promise。<br>deffered 对象属性promise ：最后返回的是一个新的deferred对象 promise 属性，而不是原来的deferred对象。这个新的Promise对象只能观察原来Promise对象的状态，而无法修改deferred对象的内在状态可以防止任务状态被外部修改。</p>
<ol>
<li><p>resolve（value）<br>resolve函数用这个值来执行deferred promise。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">deferred.resolve(&#123;name: &quot;Ari&quot;, username: &quot;@auser&quot;&#125;);</div></pre></td></tr></table></figure>
</li>
<li><p>reject（reason）<br>这个方法用一个原因来拒绝deferred promise。它等同于使用一个“拒绝”来执行一个promise。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">deferred.reject(&quot;Can&apos;t update user&quot;);</div><div class="line">// 等同于</div><div class="line">deferred.resolve($q.reject(&quot;Can&apos;t update user&quot;));</div></pre></td></tr></table></figure>
</li>
<li><p>notify（value）<br>这个方法用promise的执行状态来进行响应。notify 回调可能被调用 0到多次,提供一个进度指示在解决或拒绝（resolve和rejected）之前。</p>
<h4 id="方法介绍："><a href="#方法介绍：" class="headerlink" title="方法介绍："></a>方法介绍：</h4><p>$http(options)返回的是一个被封装的promise对象，可以直接使用.then等方法。</p>
</li>
<li>then(successFn, errFn, notifyFn)<br>无论promise成功还是失败了，当结果可用之后， then都会立刻异步调用successFn或者errFn。这个方法始终用一个参数来调用回调函数：结果，或者是拒绝的理由。在promise被执行或者拒绝之前， notifyFn回调可能会被调用0到多次，以提供过程状态的提示。<br>then()方法总是返回一个新的promise，可以通过successFn或者errFn这样的返回值执行或者被拒绝。它也能通过notifyFn提供通知。</li>
<li><p>catch(errFn)<br>这个方法就只是个帮助函数，能让我们用.catch(function(reason){})取代err回调：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">$http.get(&apos;/repos/angular/angular.js/pulls&apos;)</div><div class="line">.catch(function(reason) &#123;</div><div class="line">deferred.reject(reason);</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
</li>
<li><p>finally(callback)<br>finally方法允许我们观察promise的履行或者拒绝，而无需修改结果的值。当我们需要释放一个资源，或者是运行一些清理工作，不管promise是成功还是失败时，这个方法会很有用。<br>我们不能直接调用这个方法，因为finally是IE中JavaScript的一个保留字。纠结到最后，只好这样调用它了：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">promise[&apos;finally&apos;](function() &#123;&#125;);</div></pre></td></tr></table></figure>
</li>
</ol>
<p>Angular的$q deferred对象是可以串成链的，这样即使是then，返回的也是一个promise。这个promise一被执行， then返回的promise就已经是resolved或者rejected的了。</p>
<h4 id="q服务类似于原始的Kris-Kowal的Q库："><a href="#q服务类似于原始的Kris-Kowal的Q库：" class="headerlink" title="$q服务类似于原始的Kris Kowal的Q库："></a>$q服务类似于原始的Kris Kowal的Q库：</h4><ol>
<li>$q是跟Angular的$rootScope模型集成的，所以在Angular中，执行和拒绝都很快。</li>
<li>$q promise是跟Angular模板引擎集成的，这意味着在视图中找到的任何promise都会在视<br>图中被执行或者拒绝。</li>
<li>$q很小，所以没有包含Q库的完整功能。<h3 id="链式请求"><a href="#链式请求" class="headerlink" title="链式请求"></a>链式请求</h3>then方法在初始promise被执行之后，返回一个新的派生promise。这种返回形式给了我们一种特有的能力，把另一个then接在初始的then方法结果之后。<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">// 一个响应promise的服务</div><div class="line">GithubService.then(function(data) &#123;</div><div class="line">var events = [];</div><div class="line">for (var i = 0; i &lt; data.length; i++) &#123;</div><div class="line">events.push(data[i].events);</div><div class="line">&#125;</div><div class="line">return events;</div><div class="line">&#125;).then(function(events) &#123;</div><div class="line">$scope.events = events;</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
</li>
</ol>
<p>在本例中，我们可以创建一个执行链，它允许我们中断基于更多功能的应用流程，可以籍此导向不同的结果。这个中断能让我们在执行链的任意时刻暂停或者推迟promise的执行。</p>
<h4 id="q库自带了几个不同的有用方法。"><a href="#q库自带了几个不同的有用方法。" class="headerlink" title="$q库自带了几个不同的有用方法。"></a>$q库自带了几个不同的有用方法。</h4><ol>
<li>all(promises)<br>如果我们有多个promise，想要把它们合并成一个，可以使用$q.all(promises)方法来把它们合并成一个promise。这个方法带有一个参数。即promises（数组或者promise对象），一个promise数组或者promise的hash。<br>all()方法返回单个promise，会执行一个数组或者一个散列的值。每个值会响应promise散列中的相同序号或者键。如果任意一个promise被拒绝了，结果的promise也会被拒绝。</li>
<li>defer()<br>defer()方法创建了一个deferred对象，它没有参数，返回deferred对象的一个实例。</li>
<li>reject(reason)<br>这个方法创建了一个promise，被以某一原因拒绝执行了。它专门用于让我们能在一个promise链中转发拒绝的promise，类似JavaScript中的throw。在同样意义上，我们能在JavaScript中捕获一个异常，也能够转发这个拒绝，我们需要把这个错误重新抛出。可以通过$q.reject(reason)来做到这点。<br>这个方法带有单个参数：reason（常量、字符串、异常、对象），拒绝的原因。<br>reject()方法返回一个已经用某个原因拒绝的promise。</li>
<li>when(value)<br>when()函数把一个可能是值或者能接着then的promise包装成一个$q promise。这样我们就能处理一个可能是也可能不是promise的对象。when()函数有一个参数： value，该参数是个值，或者是promise<br>when()函数返回了一个promise，我们可以像使用其他promise一样使用它。</li>
</ol>

      
    </div>
    
    <div class="article-info article-info-index">
      
      

      
    <div class="article-tag tagcloud">
        <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/angular、promise、-q、deferred/">angular、promise、$q、deferred</a></li></ul>
    </div>

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>









  
    <article id="post-dajianjiaoshoujia" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2016/06/13/dajianjiaoshoujia/" class="article-date">
      <time datetime="2016-06-13T09:32:09.000Z" itemprop="datePublished">2016-06-13</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/06/13/dajianjiaoshoujia/">教你从零开始搭建一款前端脚手架工具</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
        <p><em>CLI</em>:command-line interface，命令行界面.<br><a href="https://segmentfault.com/a/1190000006190814?utm_source=tuicool&amp;utm_medium=referral#articleHeader0" target="_blank" rel="external">文章来源地址</a></p>
<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>　　在实际的开发过程中，从零开始建立项目的结构是一件让人头疼的事情，所以各种各样的脚手架工具应运而生。使用较多koa-generator、yoeman、express-generator和vue-cli便是当中之一。它们功能丰富，但最核心的功能都是能够快速搭建一个完整的项目的结构，开发者只需要在生成的项目结构的基础上进行开发即可，非常简单高效。<br>    自己搭建一款叫做SCION的脚手架。现在让我们就以SCION为例，从零开始搭建一款属于我们自己的脚手架工具吧！<br>核心原理<br>yoeman搭建项目需要提供yoeman-generator。yoeman-generator本质上就是一个具备完整文件结构的项目样板，用户需要手动地把这些generator下载到本地，然后yoeman就会根据这些generator自动生成各种不同的项目。</p>
<p>vue-cli提供了相当丰富的选项和设定功能，但是其本质也是从远程仓库把不同的模版拉取到本地，而并非是什么“本地生成”的黑科技。</p>
<p>这样看来，思路也就有了——首先建立不同的样板项目，然后脚手架根据用户的指令引用样板项目生成实际项目。样板项目可以内置在脚手架当中，也可以部署在远程仓库。为了更广的适用范围，SCION采用的是第二种方式。</p>
<p>技术选型<br>node.js：整个脚手架工具的根本组成部分，推荐使用最新的版本。<br>es6：新版本的node.js对于es6的支持度已经非常高，使用es6能够极大地提升开发效率和开发感受。<br>commander：TJ大神开发的工具，能够更好地组织和处理命令行的输入。<br>co：TJ大神开发的异步流程控制工具，用更舒服的方式写异步代码。<br>co-prompt：还是TJ大神的作品……传统的命令行只能单行一次性地输入所有参数和选项，使用这个工具可以自动提供提示信息，并且分步接收用户的输入，体验类似npm init时的一步一步输入参数的过程。<br>整体架构<br>国际惯例，着手开发之前得先弄明白整体架构，看图：</p>
<p>首先明白模版的概念。一个模版就是一个项目的样板，包含项目的完整结构和信息。<br>模版的信息都存放在一个叫做templates.json的文件当中。<br>用户可以通过命令行对templates.json进行添加、删除、罗列的操作。<br>通过选择不同的模版，SCION会自动从远程仓库把相应的模板拉取到本地，完成项目的搭建。</p>
<p>最终整个脚手架的文件结构如下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div><div class="line">127</div><div class="line">128</div><div class="line">129</div><div class="line">130</div><div class="line">131</div><div class="line">132</div><div class="line">133</div><div class="line">134</div><div class="line">135</div><div class="line">136</div><div class="line">137</div><div class="line">138</div><div class="line">139</div><div class="line">140</div><div class="line">141</div><div class="line">142</div><div class="line">143</div><div class="line">144</div><div class="line">145</div><div class="line">146</div><div class="line">147</div><div class="line">148</div><div class="line">149</div><div class="line">150</div><div class="line">151</div><div class="line">152</div><div class="line">153</div><div class="line">154</div><div class="line">155</div><div class="line">156</div><div class="line">157</div><div class="line">158</div><div class="line">159</div><div class="line">160</div><div class="line">161</div><div class="line">162</div><div class="line">163</div><div class="line">164</div><div class="line">165</div><div class="line">166</div><div class="line">167</div><div class="line">168</div><div class="line">169</div><div class="line">170</div><div class="line">171</div><div class="line">172</div><div class="line">173</div><div class="line">174</div><div class="line">175</div><div class="line">176</div><div class="line">177</div><div class="line">178</div><div class="line">179</div><div class="line">180</div><div class="line">181</div><div class="line">182</div><div class="line">183</div><div class="line">184</div><div class="line">185</div><div class="line">186</div><div class="line">187</div><div class="line">188</div><div class="line">189</div><div class="line">190</div><div class="line">191</div><div class="line">192</div><div class="line">193</div><div class="line">194</div><div class="line">195</div><div class="line">196</div><div class="line">197</div><div class="line">198</div><div class="line">199</div><div class="line">200</div><div class="line">201</div><div class="line">202</div><div class="line">203</div><div class="line">204</div><div class="line">205</div><div class="line">206</div><div class="line">207</div><div class="line">208</div><div class="line">209</div><div class="line">210</div><div class="line">211</div><div class="line">212</div><div class="line">213</div><div class="line">214</div><div class="line">215</div><div class="line">216</div><div class="line">217</div><div class="line">218</div><div class="line">219</div><div class="line">220</div><div class="line">221</div><div class="line">222</div><div class="line">223</div><div class="line">224</div></pre></td><td class="code"><pre><div class="line">  |__ bin</div><div class="line">    |__ scion</div><div class="line">  |__ command</div><div class="line">    |__ add.js</div><div class="line">    |__ delete.js</div><div class="line">    |__ init.js</div><div class="line">    |__ list.js</div><div class="line">  |__ node_modules</div><div class="line">  |__ package.json</div><div class="line">  |__ templates.json</div><div class="line">入口文件</div><div class="line">首先建立项目，在package.json里面写入依赖并执行npm install：</div><div class="line"></div><div class="line">&quot;dependencies&quot;: &#123;</div><div class="line">    &quot;chalk&quot;: &quot;^1.1.3&quot;,</div><div class="line">    &quot;co&quot;: &quot;^4.6.0&quot;,</div><div class="line">    &quot;co-prompt&quot;: &quot;^1.0.0&quot;,</div><div class="line">    &quot;commander&quot;: &quot;^2.9.0&quot;</div><div class="line">  &#125;</div><div class="line">在根目录下建立\bin文件夹，在里面建立一个无后缀名的scion文件。这个bin\scion文件是整个脚手架的入口文件，所以我们首先对它进行编写。</div><div class="line"></div><div class="line">首先是一些初始化的代码：</div><div class="line"></div><div class="line">#!/usr/bin/env node --harmony</div><div class="line">&apos;use strict&apos;</div><div class="line"> // 定义脚手架的文件路径</div><div class="line">process.env.NODE_PATH = __dirname + &apos;/../node_modules/&apos;</div><div class="line"></div><div class="line">const program = require(&apos;commander&apos;)</div><div class="line"></div><div class="line"> // 定义当前版本</div><div class="line">program</div><div class="line">    .version(require(&apos;../package&apos;).version )</div><div class="line"></div><div class="line">// 定义使用方法</div><div class="line">program</div><div class="line">    .usage(&apos;&lt;command&gt;&apos;)</div><div class="line">从前文的架构图中可以知道，脚手架支持用户输入4种不同的命令。现在我们来写处理这4种命令的方法：</div><div class="line"></div><div class="line">program</div><div class="line">    .command(&apos;add&apos;)</div><div class="line">    .description(&apos;Add a new template&apos;)</div><div class="line">  .alias(&apos;a&apos;)</div><div class="line">  .action(() =&gt; &#123;</div><div class="line">    require(&apos;../command/add&apos;)()</div><div class="line">  &#125;)</div><div class="line"></div><div class="line">program</div><div class="line">    .command(&apos;list&apos;)</div><div class="line">    .description(&apos;List all the templates&apos;)</div><div class="line">    .alias(&apos;l&apos;)</div><div class="line">    .action(() =&gt; &#123;</div><div class="line">        require(&apos;../command/list&apos;)()</div><div class="line">    &#125;)</div><div class="line"></div><div class="line">program</div><div class="line">    .command(&apos;init&apos;)</div><div class="line">    .description(&apos;Generate a new project&apos;)</div><div class="line">  .alias(&apos;i&apos;)</div><div class="line">  .action(() =&gt; &#123;</div><div class="line">    require(&apos;../command/init&apos;)()</div><div class="line">  &#125;)</div><div class="line"></div><div class="line">program</div><div class="line">    .command(&apos;delete&apos;)</div><div class="line">    .description(&apos;Delete a template&apos;)</div><div class="line">    .alias(&apos;d&apos;)</div><div class="line">    .action(() =&gt; &#123;</div><div class="line">        require(&apos;../command/delete&apos;)()</div><div class="line">    &#125;)</div><div class="line">commander的具体使用方法在这里就不展开了，可以直接到官网去看详细的文档。</div><div class="line">最后别忘了处理参数和提供帮助信息：</div><div class="line"></div><div class="line">program.parse(process.argv)</div><div class="line"></div><div class="line">if(!program.args.length)&#123;</div><div class="line">  program.help()</div><div class="line">&#125;</div><div class="line">完整的代码请看这里。</div><div class="line">使用node运行这个文件，看到输出如下，证明入口文件已经编写完成了。</div><div class="line"></div><div class="line">Usage: scion &lt;command&gt;</div><div class="line"></div><div class="line"></div><div class="line">  Commands:</div><div class="line"></div><div class="line">    add|a      Add a new template</div><div class="line">    list|l     List all the templates</div><div class="line">    init|i     Generate a new project</div><div class="line">    delete|d   Delete a template</div><div class="line"></div><div class="line">  Options:</div><div class="line"></div><div class="line">    -h, --help     output usage information</div><div class="line">    -V, --version  output the version number</div><div class="line">处理用户输入</div><div class="line">在项目根目录下建立\command文件夹，专门用来存放命令处理文件。</div><div class="line">在根目录下建立templates.json文件并写入如下内容，用来存放模版信息：</div><div class="line"></div><div class="line">&#123;&quot;tpl&quot;:&#123;&#125;&#125;</div><div class="line">添加模板</div><div class="line">进入\command并新建add.js文件：</div><div class="line"></div><div class="line">&apos;use strict&apos;</div><div class="line">const co = require(&apos;co&apos;)</div><div class="line">const prompt = require(&apos;co-prompt&apos;)</div><div class="line">const config = require(&apos;../templates&apos;)</div><div class="line">const chalk = require(&apos;chalk&apos;)</div><div class="line">const fs = require(&apos;fs&apos;)</div><div class="line"></div><div class="line">module.exports = () =&gt; &#123;</div><div class="line"> co(function *() &#123;</div><div class="line"></div><div class="line">   // 分步接收用户输入的参数</div><div class="line">   let tplName = yield prompt(&apos;Template name: &apos;)</div><div class="line">   let gitUrl = yield prompt(&apos;Git https link: &apos;)</div><div class="line">   let branch = yield prompt(&apos;Branch: &apos;)</div><div class="line">    </div><div class="line">   // 避免重复添加</div><div class="line">   if (!config.tpl[tplName]) &#123;</div><div class="line">     config.tpl[tplName] = &#123;&#125;</div><div class="line">     config.tpl[tplName][&apos;url&apos;] = gitUrl.replace(/[\u0000-\u0019]/g, &apos;&apos;) // 过滤unicode字符</div><div class="line">     config.tpl[tplName][&apos;branch&apos;] = branch</div><div class="line">   &#125; else &#123;</div><div class="line">     console.log(chalk.red(&apos;Template has already existed!&apos;))</div><div class="line">     process.exit()</div><div class="line">   &#125;</div><div class="line">   </div><div class="line">   // 把模板信息写入templates.json</div><div class="line">   fs.writeFile(__dirname + &apos;/../templates.json&apos;, JSON.stringify(config), &apos;utf-8&apos;, (err) =&gt; &#123;</div><div class="line">     if (err) console.log(err)</div><div class="line">     console.log(chalk.green(&apos;New template added!\n&apos;))</div><div class="line">     console.log(chalk.grey(&apos;The last template list is: \n&apos;))</div><div class="line">     console.log(config)</div><div class="line">     console.log(&apos;\n&apos;)</div><div class="line">     process.exit()</div><div class="line">    &#125;)</div><div class="line"> &#125;)</div><div class="line">&#125;</div><div class="line">删除模板</div><div class="line">同样的，在\command文件夹下建立delete.js文件：</div><div class="line"></div><div class="line">&apos;use strict&apos;</div><div class="line">const co = require(&apos;co&apos;)</div><div class="line">const prompt = require(&apos;co-prompt&apos;)</div><div class="line">const config = require(&apos;../templates&apos;)</div><div class="line">const chalk = require(&apos;chalk&apos;)</div><div class="line">const fs = require(&apos;fs&apos;)</div><div class="line"></div><div class="line">module.exports = () =&gt; &#123;</div><div class="line">    co(function *() &#123;</div><div class="line">        // 接收用户输入的参数</div><div class="line">        let tplName = yield prompt(&apos;Template name: &apos;)</div><div class="line"></div><div class="line">        // 删除对应的模板</div><div class="line">        if (config.tpl[tplName]) &#123;</div><div class="line">            config.tpl[tplName] = undefined</div><div class="line">        &#125; else &#123;</div><div class="line">            console.log(chalk.red(&apos;Template does not exist!&apos;))</div><div class="line">            process.exit()</div><div class="line">        &#125;</div><div class="line">        </div><div class="line">        // 写入template.json</div><div class="line">        fs.writeFile(__dirname + &apos;/../templates.json&apos;, JSON.stringify(config),     &apos;utf-8&apos;, (err) =&gt; &#123;</div><div class="line">            if (err) console.log(err)</div><div class="line">            console.log(chalk.green(&apos;Template deleted!&apos;))</div><div class="line">            console.log(chalk.grey(&apos;The last template list is: \n&apos;))</div><div class="line">            console.log(config)</div><div class="line">            console.log(&apos;\n&apos;)</div><div class="line">            process.exit()</div><div class="line">        &#125;)</div><div class="line">    &#125;)</div><div class="line">&#125;</div><div class="line">罗列模板</div><div class="line">建立list.js文件：</div><div class="line"></div><div class="line">&apos;use strict&apos;</div><div class="line">const config = require(&apos;../templates&apos;)</div><div class="line"></div><div class="line">module.exports = () =&gt; &#123;</div><div class="line">     console.log(config.tpl)</div><div class="line">     process.exit()</div><div class="line">&#125;</div><div class="line">构建项目</div><div class="line">现在来到我们最重要的部分——构建项目。同样的，在\command目录下新建一个叫做init.js的文件：</div><div class="line"></div><div class="line">&apos;use strict&apos;</div><div class="line">const exec = require(&apos;child_process&apos;).exec</div><div class="line">const co = require(&apos;co&apos;)</div><div class="line">const prompt = require(&apos;co-prompt&apos;)</div><div class="line">const config = require(&apos;../templates&apos;)</div><div class="line">const chalk = require(&apos;chalk&apos;)</div><div class="line"></div><div class="line">module.exports = () =&gt; &#123;</div><div class="line"> co(function *() &#123;</div><div class="line">    // 处理用户输入</div><div class="line">      let tplName = yield prompt(&apos;Template name: &apos;)</div><div class="line">      let projectName = yield prompt(&apos;Project name: &apos;)</div><div class="line">      let gitUrl</div><div class="line">      let branch</div><div class="line"></div><div class="line">    if (!config.tpl[tplName]) &#123;</div><div class="line">        console.log(chalk.red(&apos;\n × Template does not exit!&apos;))</div><div class="line">        process.exit()</div><div class="line">    &#125;</div><div class="line">    gitUrl = config.tpl[tplName].url</div><div class="line">    branch = config.tpl[tplName].branch</div><div class="line"></div><div class="line">    // git命令，远程拉取项目并自定义项目名</div><div class="line">    let cmdStr = `git clone $&#123;gitUrl&#125; $&#123;projectName&#125; &amp;&amp; cd $&#123;projectName&#125; &amp;&amp; git checkout $&#123;branch&#125;`</div><div class="line"></div><div class="line">    console.log(chalk.white(&apos;\n Start generating...&apos;))</div><div class="line"></div><div class="line">    exec(cmdStr, (error, stdout, stderr) =&gt; &#123;</div><div class="line">      if (error) &#123;</div><div class="line">        console.log(error)</div><div class="line">        process.exit()</div><div class="line">      &#125;</div><div class="line">      console.log(chalk.green(&apos;\n √ Generation completed!&apos;))</div><div class="line">      console.log(`\n cd $&#123;projectName&#125; &amp;&amp; npm install \n`)</div><div class="line">      process.exit()</div><div class="line">    &#125;)</div><div class="line">  &#125;)</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>可以看到，这一部分代码也非常简单，关键的一句话是<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">let cmdStr = `git clone $&#123;gitUrl&#125; $&#123;projectName&#125; &amp;&amp; cd $&#123;projectName&#125; &amp;&amp; git checkout $&#123;branch&#125;`</div></pre></td></tr></table></figure></p>
<p>它的作用正是从远程仓库克隆到自定义目录，并切换到对应的分支。熟悉git命令的同学应该明白，不熟悉的同学是时候补补课啦！</p>
<p>全局使用<br>为了可以全局使用，我们需要在package.json里面设置一下：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">&quot;bin&quot;: &#123;</div><div class="line">    &quot;scion&quot;: &quot;bin/scion&quot;</div><div class="line">  &#125;</div></pre></td></tr></table></figure></p>
<p>本地调试的时候，在根目录下执行</p>
<p>npm link<br>即可把scion命令绑定到全局，以后就可以直接以scion作为命令开头而无需敲入长长的node scion之类的命令了。</p>
<p>现在我们的脚手架工具已经搭建好了，一起来尝试一下吧！</p>
<p>使用测试<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">add | a 添加模版命令</div><div class="line"></div><div class="line">init | i 生成项目命令</div><div class="line"></div><div class="line">delete | d 删除模版命令 和 list | l 罗列模版命令</div></pre></td></tr></table></figure></p>
<p>   大功告成啦！现在我们的整个脚手架工具已经搭建完成了，以后只需要知道模板的git https地址和branch就可以不断地往SCION上面添加，团队协作的话只需要分享SCION的templates.json文件就可以了。</p>
<h3 id="后记"><a href="#后记" class="headerlink" title="后记"></a>后记</h3><p>   看起来并不复杂的东西，实际从零开始搭建也是颇费了一番心思。最大的难题是在开始的时候并不懂得如何像npm init那样可以一步一步地处理用户输入，只懂得一条命令行把所有的参数都带上，这样的用户体验真的很不好。研究了vue-cli和yoeman也没有找到相应的代码，只好不断地google，最后总算找到了一篇文章，可以用co和co-prompt这两个工具实现，再一次膜拜无所不能的TJ大神，也希望能够有小伙伴告诉我vue-cli它们是怎么实现的。</p>

      
    </div>
    
    <div class="article-info article-info-index">
      
      

      
    <div class="article-tag tagcloud">
        <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/前端脚手架/">前端脚手架</a></li></ul>
    </div>

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>









  
    <article id="post-filternull" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2016/06/05/filternull/" class="article-date">
      <time datetime="2016-06-05T02:22:15.000Z" itemprop="datePublished">2016-06-05</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/06/05/filternull/">AngularJS使用ng-repeat和ng-if实现数据的筛选显示，多适用于表单数据的显示</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
        <p>这篇文章主要介绍了AngularJS使用ng-repeat和ng-if实现数据的删选显示效果,非常适用于表单数据的显示使用,涉及ng-repeat和ng-if命令的相关使用技巧,在项目中用到过，特此记录下，遇到问题要多尝试！总会找到最好的方法。</p>
<h4 id="ng-repeat可以实现内容的重复显示"><a href="#ng-repeat可以实现内容的重复显示" class="headerlink" title="ng-repeat可以实现内容的重复显示"></a>ng-repeat可以实现内容的重复显示</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div></pre></td><td class="code"><pre><div class="line">&lt;!DOCTYPE html&gt;</div><div class="line">&lt;html lang=&quot;en&quot;&gt;</div><div class="line">&lt;head&gt;</div><div class="line">    &lt;meta charset=&quot;UTF-8&quot;&gt;</div><div class="line">    &lt;title&gt;Title&lt;/title&gt;</div><div class="line">  &lt;script src=&quot;https://cdn.static.runoob.com/libs/angular.js/1.4.6/angular.min.js&quot;&gt;&lt;/script&gt;</div><div class="line">&lt;/head&gt;</div><div class="line">&lt;body&gt;</div><div class="line">&lt;div ng-app=&quot;myApp&quot; ng-controller=&quot;myCtrl&quot;&gt;</div><div class="line">  &lt;ul&gt;</div><div class="line">    &lt;li ng-repeat=&quot;x in names&quot;&gt;</div><div class="line">      &#123;&#123; x.name &#125;&#125;我的年龄：&#123;&#123;x.age&#125;&#125;</div><div class="line">    &lt;/li&gt;</div><div class="line">  &lt;/ul&gt;</div><div class="line">&lt;/div&gt;</div><div class="line"></div><div class="line">&lt;script&gt;</div><div class="line">  angular.module(&apos;myApp&apos;, []).controller(&apos;myCtrl&apos;, function($scope) &#123;</div><div class="line">    $scope.names = [</div><div class="line">      &#123;name:&apos;&apos;,age:&apos;20&apos;&#125;,</div><div class="line">      &#123;name:&apos;Hege&apos;,age:&apos;21&apos;&#125;,</div><div class="line">      &#123;name:&apos;Kai&apos;,age:&apos;22&apos;&#125;</div><div class="line">    ];</div><div class="line">  &#125;);</div><div class="line">&lt;/script&gt;</div><div class="line">&lt;/body&gt;</div><div class="line">&lt;/html&gt;</div></pre></td></tr></table></figure>
<p>上述例子名字显示为空，怎么让名字为空的不显示呢？</p>
<h4 id="可以使用ng-repeat-ng-if的方法，这样可以实现简单的前端筛选"><a href="#可以使用ng-repeat-ng-if的方法，这样可以实现简单的前端筛选" class="headerlink" title="可以使用ng-repeat+ng-if的方法，这样可以实现简单的前端筛选"></a>可以使用ng-repeat+ng-if的方法，这样可以实现简单的前端筛选</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">&lt;li ng-repeat=&quot;x in names&quot; ng-if=&quot;x.name&apos;&quot;&gt;</div><div class="line">     &#123;&#123; x.name &#125;&#125;&#123;&#123;x.age&#125;&#125;</div><div class="line">   &lt;/li&gt;</div></pre></td></tr></table></figure>
<p>这样就可以只显示名字不为空的了。如果只想显示名字为Kai的，代码如下：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">&lt;li ng-repeat=&quot;x in names&quot; ng-if=&quot;x.name==&apos;Kai&apos;&quot;&gt;</div><div class="line">     &#123;&#123; x.name &#125;&#125;&#123;&#123;x.age&#125;&#125;</div><div class="line">   &lt;/li&gt;</div></pre></td></tr></table></figure></p>
<h4 id="实现过滤的另一种思路：在controller里直接过滤空值数据，页面直接ng-repeat过滤后的数据即可。"><a href="#实现过滤的另一种思路：在controller里直接过滤空值数据，页面直接ng-repeat过滤后的数据即可。" class="headerlink" title="实现过滤的另一种思路：在controller里直接过滤空值数据，页面直接ng-repeat过滤后的数据即可。"></a>实现过滤的另一种思路：在controller里直接过滤空值数据，页面直接ng-repeat过滤后的数据即可。</h4><p>代码如下：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line">&lt;li ng-repeat=&quot;x in names&quot;&gt;</div><div class="line">      &#123;&#123; x.name &#125;&#125;我的年龄：&#123;&#123;x.age&#125;&#125;</div><div class="line">    &lt;/li&gt;</div><div class="line">angular.module(&apos;myApp&apos;, []).controller(&apos;myCtrl&apos;, function($scope) &#123;</div><div class="line">    $scope.names = [</div><div class="line">      &#123;name:&apos;&apos;,age:&apos;20&apos;&#125;,</div><div class="line">      &#123;name:&apos;Hege&apos;,age:&apos;21&apos;&#125;,</div><div class="line">      &#123;name:&apos;Kai&apos;,age:&apos;22&apos;&#125;</div><div class="line">    ];</div><div class="line">    $scope.names=$scope.names.filter(function(item)&#123;</div><div class="line">    	return item.name != &apos;&apos;;</div><div class="line">    &#125;)</div><div class="line">  &#125;);</div></pre></td></tr></table></figure></p>
<p>这种方式也能只显示有值的名字。</p>

      
    </div>
    
    <div class="article-info article-info-index">
      
      

      
    <div class="article-tag tagcloud">
        <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/angularjs/">angularjs</a></li></ul>
    </div>

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>









  
    <article id="post-angular-fiveservice" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2016/06/01/angular-fiveservice/" class="article-date">
      <time datetime="2016-06-01T06:53:19.000Z" itemprop="datePublished">2016-06-01</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/06/01/angular-fiveservice/">angular中的5种服务</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
        <h4 id="5种创建自定义服务的方式"><a href="#5种创建自定义服务的方式" class="headerlink" title="5种创建自定义服务的方式"></a>5种创建自定义服务的方式</h4><p>1.Provider 2.Factory 3.Service 4.value 5.constant,其中只有provider可以配置，factory是项目中最常用的。<br>服务的作用：提取公共内容，封装公有方法，并且服务是单例的。服务对应的是构造函数。服务名字的后面函数其实是一个服务的构造函数，单例相当于只能new一次创建一个实例，不能创建多个实例来使用。<br>service层主查写逻辑代码的，但在angularJS里也可以持久化数据（充当数据容器），以供不同的controller调用。<br>controller层：即控制层，在angularJS里就是写控制器的。控制器里尽量不要写那些不必要的逻辑，尽量写在service层里。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">//定义构造函数</div><div class="line">var myServiceProvider = function()&#123;</div><div class="line">this.$get = function()&#123;</div><div class="line">return ....</div><div class="line">&#125;;</div><div class="line">&#125;;</div><div class="line">//在模块中登记</div><div class="line">angular.module(&quot;myModule&quot;,[])</div><div class="line">.provider(&quot;myService&quot;,myServiceProvider);</div></pre></td></tr></table></figure></p>
<h4 id="1-provider"><a href="#1-provider" class="headerlink" title="1.provider"></a>1.provider</h4><p>provider 可配置  当注入后会默认调用$get方法   仅仅只有provider可配置.<br>只有provder是能传.config() 函数的服务。如果想在 service 对象启用之前，先进行模块范围的配置，那就应该选择 provider。需要注意的是：在config函数里注入provider时，名字应该是：providerName+Provider.<br>使用Provider的优点就是，你可以在Provider对象传递到应用程序的其他部分之前在app.config函数中对其进行修改。 当你使用Provider创建一个service时，唯一的可以在你的控制器中访问的属性和方法是通过$get()函数返回内容。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">app.provider(&apos;my&apos;,function () &#123;</div><div class="line">    //当我们使用这个服务的时候，会直接调用$get方法</div><div class="line">    this.$get = function () &#123;</div><div class="line">             return &#123;  &#125;</div><div class="line">    &#125;</div><div class="line">&#125;);</div></pre></td></tr></table></figure></p>
<h5 id="可配置的服务"><a href="#可配置的服务" class="headerlink" title="可配置的服务"></a>可配置的服务</h5><p> 有时我们希望服务在不同的场景下可以有不同的行为，这意味着服务可以进行配置。比如，我们希望小计算器可以根据不同的本地化区域，给计算结果追加货币符号前缀， 那么需要在这个服务创建之前，首先配置本地化区域的值，然后在具体的计算中， 根据这个值选择合适的货币符号。<br>      AngularJS使用模块的config()方法对服务进行配置，需要将实例化的服务提供者（而不是服务实例）注入到配置函数中：<br> <figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">angular.module(&quot;myModule&quot;,[])</div><div class="line">.config([&quot;myServiceProvider&quot;,function(myServiceProvider)&#123;</div><div class="line">//do some configuration.</div><div class="line">&#125;]);</div></pre></td></tr></table></figure></p>
<h4 id="2-factory"><a href="#2-factory" class="headerlink" title="2.factory"></a>2.factory</h4><p>factory方式创建的服务，作用就是返回一个有属性有方法的对象。相当于：var f = myFactory();<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">app.factory(&apos;my&apos;,function () &#123;</div><div class="line">return  &#123;&#125;  //返回$get执行后的函数</div><div class="line">&#125;);</div></pre></td></tr></table></figure></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div></pre></td><td class="code"><pre><div class="line">注：使用provider服务时的执行顺序 先config &gt; run &gt; controller</div><div class="line">//需要注意的是：在配置provider时，名字应该是：providerName+Provider   </div><div class="line">    app.config(function(myProviderProvider)&#123;</div><div class="line">        myProviderProvider.setName(&quot;ywx&quot;);       </div><div class="line">    &#125;);</div><div class="line">    app.provider(&apos;myProvider&apos;, function() &#123;</div><div class="line">        var name=&quot;&quot;;</div><div class="line">        var test=&#123;&quot;a&quot;:1,&quot;b&quot;:2&#125;;</div><div class="line">        //注意的是，setter方法必须是(set+变量首字母大写)格式</div><div class="line">        this.setName = function(newName)&#123;</div><div class="line">            name = newName  </div><div class="line">        &#125;</div><div class="line"></div><div class="line">        this.$get =function($http,$q)&#123;</div><div class="line">            return &#123;</div><div class="line">                getData : function()&#123;</div><div class="line">                    var d = $q.defer();</div><div class="line">                    $http.get(&quot;url&quot;)//读取数据的函数。</div><div class="line">                        .success(function(response) &#123;</div><div class="line">                            d.resolve(response);</div><div class="line">                        &#125;)</div><div class="line">                        .error(function()&#123;</div><div class="line">                            d.reject(&quot;error&quot;);</div><div class="line">                        &#125;);</div><div class="line">                    return d.promise;</div><div class="line">                &#125;,</div><div class="line">                &quot;lastName&quot;:name,</div><div class="line">                &quot;test&quot;:test</div><div class="line">            &#125;   </div><div class="line">        &#125;</div><div class="line"></div><div class="line">    &#125;);</div><div class="line">    app.controller(&apos;myCtrl&apos;, function($scope,myProvider) &#123;</div><div class="line">        alert(myProvider.lastName);</div><div class="line">        alert(myProvider.test.a)</div><div class="line">        myProvider.getData().then(function(data)&#123;</div><div class="line">            //alert(data)</div><div class="line">        &#125;,function(data)&#123;</div><div class="line">            //alert(data)</div><div class="line">        &#125;);</div><div class="line">    &#125;);</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line">//通过工厂模式创建自定义服务</div><div class="line">    app.factory(&apos;myFactory&apos;, function() &#123;</div><div class="line">        var service = &#123;&#125;;//定义一个Object对象&apos;</div><div class="line">        service.name = &quot;张三&quot;;</div><div class="line">        var age;//定义一个私有化的变量</div><div class="line">        //对私有属性写getter和setter方法</div><div class="line">        service.setAge = function(newAge)&#123;</div><div class="line">            age = newAge;</div><div class="line">        &#125;</div><div class="line">        service.getAge = function()&#123;</div><div class="line">            return age; </div><div class="line">        &#125;</div><div class="line">        return service;//返回这个Object对象</div><div class="line">    &#125;);</div><div class="line">//创建控制器</div><div class="line">    app.controller(&apos;myCtrl&apos;, function($scope, myFactory) &#123;</div><div class="line">        myFactory.setAge(20);</div><div class="line">        $scope.r =myFactory.getAge();</div><div class="line">        alert(myFactory.name);</div><div class="line">    &#125;);</div></pre></td></tr></table></figure>
<p>注：在自定义服务里可以注入内置服务（例$http等），但不能注入$scope作用域对象。</p>
<h4 id="3-service"><a href="#3-service" class="headerlink" title="3.service"></a>3.service</h4><p>通过service方式创建自定义服务，相当于new的一个对象：var s = new myService();，只要把属性和方法添加到this上才可以在controller里调用。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">app.service(&apos;myService&apos;,function () &#123;</div><div class="line">     此处为return出来的那个对象，对象的属性需要加上this，this[key]=val这种形式。</div><div class="line">     &#125;)</div></pre></td></tr></table></figure></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div></pre></td><td class="code"><pre><div class="line">app.service(&apos;myService&apos;, function($http,$q) &#123;</div><div class="line">        this.name = &quot;service&quot;;</div><div class="line">        this.myFunc = function (x) &#123;</div><div class="line">            return x.toString(16);//转16进制</div><div class="line">        &#125;</div><div class="line">        this.getData = function()&#123;</div><div class="line">            var d = $q.defer();</div><div class="line">            $http.get(&quot;ursl&quot;)//读取数据的函数。</div><div class="line">                .success(function(response) &#123;</div><div class="line">                d.resolve(response);</div><div class="line">            &#125;)</div><div class="line">                .error(function()&#123;</div><div class="line">                alert(0)</div><div class="line">                d.reject(&quot;error&quot;);</div><div class="line">            &#125;);</div><div class="line">            return d.promise;</div><div class="line">        &#125;</div><div class="line">    &#125;);</div><div class="line">    app.controller(&apos;myCtrl&apos;, function($scope, myService) &#123;</div><div class="line">        $scope.r = myService.myFunc(255);</div><div class="line">        myService.getData().then(function(data)&#123;</div><div class="line">            console.log(data);//正确时走这儿</div><div class="line">        &#125;,function(data)&#123;</div><div class="line">            alert(data)//错误时走这儿</div><div class="line">        &#125;);</div><div class="line">    &#125;);</div></pre></td></tr></table></figure>
<h4 id="4-value"><a href="#4-value" class="headerlink" title="4.value"></a>4.value</h4><p>以 key与value的形式来写value服务。这个值就是服务实例。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">app.value(&apos;my&apos;,&#123;</div><div class="line">          此处为return出来的对象</div><div class="line">     &#125;);</div></pre></td></tr></table></figure></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">有时我们需要在不同的组件之间共享一个变量，可以将这种情况视为一种服务： provider返回的总是变量的值。</div><div class="line">value方法提供了对这种情况的简化封装：</div><div class="line">angular.module(&quot;myModule&quot;,[])</div><div class="line">.value(&quot;myValueService&quot;,&quot;cx129800123&quot;);</div><div class="line"></div><div class="line">INSIDE：AngularJS会将value方法封装为provider，上面的示例 等同于：</div><div class="line">angular.module(&quot;myModule&quot;,[])</div><div class="line">.provider(&quot;myService&quot;,function()&#123;</div><div class="line">this.$get = function()&#123;</div><div class="line">return &quot;cx129800123&quot;;</div><div class="line">&#125;;</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<h4 id="5-constant"><a href="#5-constant" class="headerlink" title="5.constant"></a>5.constant</h4><p>用法同value，也是以 key ,value的形式，但是可以配置（不是真正意义上的配置），即可以增加属性。配置时不需要再名字后面加Provider。这个常量就是服务实例。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">//配置constant</div><div class="line">   app.config(function (my) &#123;</div><div class="line">       my.currency = &apos;￡&apos;;//在当前属性上增加一个属性</div><div class="line">   &#125;);</div><div class="line">   app.controller(&apos;computed&apos;,function ($scope,my) &#123;</div><div class="line">       //my就是return这个对象,这样就可以使用return出来对象的属性了</div><div class="line">   &#125;)</div></pre></td></tr></table></figure></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">有时我们需要在不同的组件之间共享一个常量，可以将这种情况视为一种服务： provider返回的总是常量的值。constant方法提供了对这种情况的简化封装：</div><div class="line">angular.module(&quot;myModule&quot;,[])</div><div class="line">.constant(&quot;myConstantService&quot;,&quot;Great Wall&quot;);</div><div class="line">和value方法不同，AngularJS并没有将constant方法封装成一个provider，而仅仅是在内部登记这个值。这使得常量在AngularJS的启动配置阶段就可以使用（创建任何 服务之前）：你可以将常量注入到模块的config()方法中。</div></pre></td></tr></table></figure>
<h4 id="在过滤器中注入自定义服务"><a href="#在过滤器中注入自定义服务" class="headerlink" title="在过滤器中注入自定义服务"></a>在过滤器中注入自定义服务</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div></pre></td><td class="code"><pre><div class="line">&lt;body&gt;</div><div class="line">&lt;div ng-app=&quot;myApp&quot;&gt;</div><div class="line">    在过滤器中使用服务:</div><div class="line">    &lt;h1&gt;&#123;&#123;255 | myFormat&#125;&#125;&lt;/h1&gt;</div><div class="line">    //若使用过滤器时需要传入参数，用：隔开，多个参数用多个：隔开。</div><div class="line">&lt;/div&gt;</div><div class="line"></div><div class="line">&lt;script&gt;</div><div class="line">    var app = angular.module(&apos;myApp&apos;, []);</div><div class="line">    app.service(&apos;hexafy&apos;, function() &#123;</div><div class="line">        this.myFunc = function (x) &#123;</div><div class="line">            return x.toString(16);</div><div class="line">        &#125;</div><div class="line">    &#125;);</div><div class="line">    app.filter(&apos;myFormat&apos;,[&apos;hexafy&apos;, function(hexafy) &#123;</div><div class="line">        return function(x) &#123;</div><div class="line">            return hexafy.myFunc(x);</div><div class="line">        &#125;;</div><div class="line">    &#125;]);</div><div class="line">&lt;/script&gt;</div><div class="line">&lt;/body&gt;</div></pre></td></tr></table></figure>
      
    </div>
    
    <div class="article-info article-info-index">
      
      

      
    <div class="article-tag tagcloud">
        <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/angular-服务/">angular 服务</a></li></ul>
    </div>

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>









  
    <article id="post-raps" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2016/05/30/raps/" class="article-date">
      <time datetime="2016-05-30T12:50:07.000Z" itemprop="datePublished">2016-05-30</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/05/30/raps/">rap集合</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
        <h2 id="我是自动播放的，不想听点我，别找不着我"><a href="#我是自动播放的，不想听点我，别找不着我" class="headerlink" title="我是自动播放的，不想听点我，别找不着我"></a>我是自动播放的，不想听点我，别找不着我</h2><iframe style="margin:0 auto; display:block;" frameborder="no" border="0" marginwidth="0" marginheight="0" width="530" height="86" src="//music.163.com/outchain/player?type=2&id=25713016&auto=1&height=66"></iframe><br><strong>1.电台情歌-fatkan</strong><br><iframe frameborder="no" border="0" marginwidth="0" marginheight="0" width="530" height="86" src="//music.163.com/outchain/player?type=2&id=34078039&auto=0&height=66"></iframe><br><strong>2.正皇旗-兄弟情义</strong><br><iframe frameborder="no" border="0" marginwidth="0" marginheight="0" width="530" height="86" src="//music.163.com/outchain/player?type=2&id=29816209&auto=0&height=66"></iframe><br><strong>3.正皇旗-泛黄的日记</strong><br><iframe frameborder="no" border="0" marginwidth="0" marginheight="0" width="530" height="86" src="//music.163.com/outchain/player?type=2&id=29816206&auto=0&height=66"></iframe><br><strong>黑暗中的莲花-爽子</strong><br><iframe frameborder="no" border="0" marginwidth="0" marginheight="0" width="530" height="86" src="//music.163.com/outchain/player?type=2&id=419077145&auto=0&height=66"></iframe><br><strong>别趴下 - 爽子</strong><br><iframe frameborder="no" border="0" marginwidth="0" marginheight="0" width="530" height="86" src="//music.163.com/outchain/player?type=2&id=442518697&auto=0&height=66"></iframe><br><strong>自由的飞 - 爽子与瓷乐队</strong><br><iframe frameborder="no" border="0" marginwidth="0" marginheight="0" width="530" height="86" src="//music.163.com/outchain/player?type=2&id=381200&auto=0&height=66"></iframe><br><strong>我知道 - 苏德牧仁</strong><br><iframe frameborder="no" border="0" marginwidth="0" marginheight="0" width="530" height="86" src="//music.163.com/outchain/player?type=2&id=27908045&auto=0&height=66"></iframe><br><strong>爱你不是为了和你去如家 - 新街口</strong><br><iframe frameborder="no" border="0" marginwidth="0" marginheight="0" width="530" height="86" src="//music.163.com/outchain/player?type=2&id=27533115&auto=0&height=66"></iframe><br><strong>谁没年轻过 - 新街口</strong><br><iframe frameborder="no" border="0" marginwidth="0" marginheight="0" width="530" height="86" src="//music.163.com/outchain/player?type=2&id=31140262&auto=0&height=66"></iframe>
      
    </div>
    
    <div class="article-info article-info-index">
      
      

      
    <div class="article-tag tagcloud">
        <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/rap/">rap</a></li></ul>
    </div>

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>









  
    <article id="post-defined-filter" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2016/05/26/defined-filter/" class="article-date">
      <time datetime="2016-05-26T02:06:02.000Z" itemprop="datePublished">2016-05-26</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/05/26/defined-filter/">简述angular自定义过滤器在页面和控制器中的使用</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
        <p>AngularJS另一个特点就是提供了过滤器，可以通过操作UNIX下管道的方式，操作数据结果。<br>通过使用管道，可以便于双向的数据绑定中视图的展现。<br>过滤器在处理过程中，将数据变成新的格式，而且可以使用管道这种链式风格，还能接受附加的参数。</p>
<h5 id="首先设置自定义过滤器"><a href="#首先设置自定义过滤器" class="headerlink" title="首先设置自定义过滤器"></a>首先设置自定义过滤器</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">app..module(&apos;myApp&apos;)</div><div class="line">    　　　　　　　.filter(&apos;filterName&apos;,function()&#123;</div><div class="line">    　　　　　　　　　return function(要过滤的对象,参数1,参数2,...)&#123;</div><div class="line">                            // ...做一些事情</div><div class="line">    　　　　　　　　　　　return Obj; //这里返回的是过滤后的对象</div><div class="line">    　　　　　　　　　&#125;</div><div class="line">    　　　　　　　&#125;);</div></pre></td></tr></table></figure>
<h5 id="在页面中使用："><a href="#在页面中使用：" class="headerlink" title="在页面中使用："></a>在页面中使用：</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">&#123;&#123;obj | filterName&#125;&#125; ====&gt; obj是要过滤的对象</div></pre></td></tr></table></figure>
<p>\｜这里的竖线是一种管道功能，如果对linux比较熟悉的话，这块的｜根linux的管道功能，基本是一样的</p>
<h5 id="在控制器中使用："><a href="#在控制器中使用：" class="headerlink" title="在控制器中使用："></a>在控制器中使用：</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">//首先要注入$filter,使用的时候</div><div class="line">$filter(&quot;filterName&quot;)(要过滤的对象,参数1,参数2,...);</div></pre></td></tr></table></figure>
<p>filter过滤器主要用来过滤一个数组数据并返回一个包含子数组数据的新数组。<br>比如，在客户端搜索时，我们可以快速的从数组中过滤出我们想要的结果。<br>这个filter方法接收一个string，object，或者function参数用来选择/移除数组元素。<br>我们也可以在JavaScript中使用$filter服务来调用过滤器，还拿字符串大写来举例:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">app.controller(&apos;DemoController&apos;, [&apos;$scope&apos;, &apos;$filter&apos;, </div><div class="line"> function($scope, $filter) &#123;</div><div class="line">  </div><div class="line">  $scope.name = $filter(&apos;lowercase&apos;)(&apos;Ari&apos;);</div><div class="line">&#125;]);</div></pre></td></tr></table></figure></p>
<p>如何传递参数到filter呢？只需要把参数放在filter之后，中间加个冒号（如果有多个参数要传递，在每个参数后加上冒号）比如，数字过滤器可以帮助我们限制数字的位数，如果想显示两位小数，加上number:2就可以了<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">&#123;&#123; 123.456789 | number:2 &#125;&#125;</div></pre></td></tr></table></figure></p>
<p>注： 意：| lowercase |uppercase管道命令可以有多个<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">&#123;&#123; name |uppercase | lowercase  &#125;&#125;</div></pre></td></tr></table></figure></p>

      
    </div>
    
    <div class="article-info article-info-index">
      
      

      
    <div class="article-tag tagcloud">
        <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/angular-filter/">angular filter</a></li></ul>
    </div>

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>









  
  
    <nav id="page-nav">
      <a class="extend prev" rel="prev" href="/page/5/">&laquo; Prev</a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/4/">4</a><a class="page-number" href="/page/5/">5</a><span class="page-number current">6</span><a class="page-number" href="/page/7/">7</a><a class="page-number" href="/page/8/">8</a><span class="space">&hellip;</span><a class="page-number" href="/page/10/">10</a><a class="extend next" rel="next" href="/page/7/">Next &raquo;</a>
    </nav>
  
</div>
      <footer id="footer">
    <div class="outer">
        <div id="footer-info">
            <div class="footer-left">
                &copy; 2017 Wenxi Yan
            </div>
            <div class="footer-right">
                <a href="http://webywx.com/" target="_blank">webywx</a>  Theme <a href="https://yanwenxi.site" target="_blank">前端在路上</a> by Scorpio
            </div>
        </div>
        
            <div class="visit">
                
                    <span id="busuanzi_container_site_pv" style='display:none'>
                        <span id="site-visit" >用户到访数: 
                            <span id="busuanzi_value_site_uv"></span>
                        </span>
                    </span>
                
                
                    <span>, </span>
                
                
                    <span id="busuanzi_container_page_pv" style='display:none'>
                        <span id="page-visit">本页阅读量: 
                            <span id="busuanzi_value_page_pv"></span>
                        </span>
                    </span>
                
            </div>
        
    </div>
</footer>

    </div>
    <script src="https://7.url.cn/edu/jslib/comb/require-2.1.6,jquery-1.9.1.min.js"></script>
<script src="/js/main.js"></script>

    <script>
        $(document).ready(function() {
            var backgroundnum = 24;
            var backgroundimg = "url(/background/bg-x.jpg)".replace(/x/gi, Math.ceil(Math.random() * backgroundnum));
            $("#mobile-nav").css({"background-image": backgroundimg,"background-size": "cover","background-position": "center"});
            $(".left-col").css({"background-image": backgroundimg,"background-size": "cover","background-position": "center"});
        })
    </script>





<div class="scroll" id="scroll">
    <a href="#"><i class="fa fa-arrow-up"></i></a>
    <a href="#comments"><i class="fa fa-comments-o"></i></a>
    <a href="#footer"><i class="fa fa-arrow-down"></i></a>
</div>
<script>
    $(document).ready(function() {
        if ($("#comments").length < 1) {
            $("#scroll > a:nth-child(2)").hide();
        };
    })
</script>

<script async src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js">
</script>

  <script language="javascript">
    $(function() {
        $("a[title]").each(function() {
            var a = $(this);
            var title = a.attr('title');
            if (title == undefined || title == "") return;
            a.data('title', title).removeAttr('title').hover(

            function() {
                var offset = a.offset();
                $("<div id=\"anchortitlecontainer\"></div>").appendTo($("body")).html(title).css({
                    top: offset.top - a.outerHeight() - 15,
                    left: offset.left + a.outerWidth()/2 + 1
                }).fadeIn(function() {
                    var pop = $(this);
                    setTimeout(function() {
                        pop.remove();
                    }, pop.text().length * 800);
                });
            }, function() {
                $("#anchortitlecontainer").remove();
            });
        });
    });
</script>


  </div>
</body>
</html>