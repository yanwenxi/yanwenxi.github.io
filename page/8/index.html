<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>闫文喜的个人博客</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="闫文喜，闫文喜的个人博客，web前端博客，前端博客">
<meta property="og:type" content="website">
<meta property="og:title" content="闫文喜的个人博客">
<meta property="og:url" content="http://yanwenxi.github.io/page/8/index.html">
<meta property="og:site_name" content="闫文喜的个人博客">
<meta property="og:description" content="闫文喜，闫文喜的个人博客，web前端博客，前端博客">
<meta property="og:locale" content="中文">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="闫文喜的个人博客">
<meta name="twitter:description" content="闫文喜，闫文喜的个人博客，web前端博客，前端博客">
  
    <link rel="alternative" href="/atom.xml" title="闫文喜的个人博客" type="application/atom+xml">
  
  
    <link rel="icon" href="/img/favicon.png">
  
  
      <link rel="stylesheet" href="//cdn.bootcss.com/animate.css/3.5.0/animate.min.css">
  
  <link rel="stylesheet" href="/css/style.css">
  <link rel="stylesheet" href="/font-awesome/css/font-awesome.min.css">
  <link rel="apple-touch-icon" href="/apple-touch-icon.png">
  
    
    
  
  
      <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">
  
  <!-- 加载特效 -->
    <script src="/js/pace.js"></script>
    <link href="/css/pace/pace-theme-flash.css" rel="stylesheet" />
  <script>
      var yiliaConfig = {
          rootUrl: '/',
          fancybox: true,
          animate: true,
          isHome: true,
          isPost: false,
          isArchive: false,
          isTag: false,
          isCategory: false,
          open_in_new: false
      }
  </script>
</head>
<body>
  <div id="container">
    <div class="left-col">
    <div class="overlay"></div>
<div class="intrude-less">
    <header id="header" class="inner">
        <a href="/" class="profilepic">
            
            <img lazy-src="/img/head.jpg" class="js-avatar">
            
        </a>

        <hgroup>
          <h1 class="header-author"><a href="/" title="Hi Mate">Wenxi Yan</a></h1>
        </hgroup>

        
        
        
            <div id="switch-btn" class="switch-btn">
                <div class="icon">
                    <div class="icon-ctn">
                        <div class="icon-wrap icon-house" data-idx="0">
                            <div class="birdhouse"></div>
                            <div class="birdhouse_holes"></div>
                        </div>
                        <div class="icon-wrap icon-ribbon hide" data-idx="1">
                            <div class="ribbon"></div>
                        </div>
                        
                        <div class="icon-wrap icon-link hide" data-idx="2">
                            <div class="loopback_l"></div>
                            <div class="loopback_r"></div>
                        </div>
                        
                        
                        <div class="icon-wrap icon-me hide" data-idx="3">
                            <div class="user"></div>
                            <div class="shoulder"></div>
                        </div>
                        
                    </div>
                    
                </div>
                <div class="tips-box hide">
                    <div class="tips-arrow"></div>
                    <ul class="tips-inner">
                        <li>菜单</li>
                        <li>标签</li>
                        
                        <li>友情链接</li>
                        
                        
                        <li>关于我</li>
                        
                    </ul>
                </div>
            </div>
        

        <div id="switch-area" class="switch-area">
            <div class="switch-wrap">
                <section class="switch-part switch-part1">
                    <nav class="header-menu">
                        <ul>
                        
                            <li><a href="/Home">我的小窝</a></li>
                        
                            <li><a href="/archives">文章列表</a></li>
                        
                            <li><a href="/">博客首页</a></li>
                        
                            <li><a href="/about">关于我</a></li>
                        
                        </ul>
                    </nav>
                    <nav class="header-nav">
                        <ul class="social">
                            
                                <a class="fl mail" target="_blank" href="http://mail.qq.com/cgi-bin/qm_share?t=qm_mailme&email=ywx_software@foxmail.com" title="mail">mail</a>
                            
                                <a class="fl github" target="_blank" href="https://github.com/yanwenxi" title="github">github</a>
                            
                                <a class="fl QQ" target="_blank" href="http://www.webywx.com" title="QQ">QQ</a>
                            
                                <a class="fl wechat" target="_blank" href="http://mail.qq.com/cgi-bin/qm_share?t=qm_mailme&email=ywx_software@foxmail.com" title="wechat">wechat</a>
                            
                        </ul>
                    </nav>
                </section>
                
                
                <section class="switch-part switch-part2">
                    <div class="widget tagcloud" id="js-tagcloud">
                        <a href="/tags/Benchmark-jsPerf/" style="font-size: 10px;">Benchmark jsPerf</a> <a href="/tags/ES6、promise/" style="font-size: 10px;">ES6、promise</a> <a href="/tags/H5-移动端优化/" style="font-size: 10px;">H5 移动端优化</a> <a href="/tags/H5、bug/" style="font-size: 10px;">H5、bug</a> <a href="/tags/JS设计模式-设计模式/" style="font-size: 10px;">JS设计模式 设计模式</a> <a href="/tags/Jenkins-CI/" style="font-size: 10px;">Jenkins CI</a> <a href="/tags/Lodash/" style="font-size: 10px;">Lodash</a> <a href="/tags/angular/" style="font-size: 10px;">angular</a> <a href="/tags/angular-http-q-promise/" style="font-size: 10px;">angular $http $q promise</a> <a href="/tags/angular-q-promise/" style="font-size: 10px;">angular $q promise</a> <a href="/tags/angular-decorator/" style="font-size: 10px;">angular decorator</a> <a href="/tags/angular-filter/" style="font-size: 10px;">angular filter</a> <a href="/tags/angular-服务/" style="font-size: 10px;">angular 服务</a> <a href="/tags/angularjs/" style="font-size: 10px;">angularjs</a> <a href="/tags/angular、-http/" style="font-size: 10px;">angular、$http</a> <a href="/tags/angular、Karma/" style="font-size: 10px;">angular、Karma</a> <a href="/tags/angular、directive/" style="font-size: 10px;">angular、directive</a> <a href="/tags/angular、html5/" style="font-size: 10px;">angular、html5</a> <a href="/tags/angular、module、controller/" style="font-size: 10px;">angular、module、controller</a> <a href="/tags/angular、promise、-q、deferred/" style="font-size: 10px;">angular、promise、$q、deferred</a> <a href="/tags/angular、router/" style="font-size: 10px;">angular、router</a> <a href="/tags/angular、ui-router/" style="font-size: 10px;">angular、ui-router</a> <a href="/tags/angular、表达式、filter/" style="font-size: 10px;">angular、表达式、filter</a> <a href="/tags/app-跨平台/" style="font-size: 10px;">app,跨平台</a> <a href="/tags/aso/" style="font-size: 10px;">aso</a> <a href="/tags/blockchain/" style="font-size: 10px;">blockchain</a> <a href="/tags/css-前端开发/" style="font-size: 10px;">css 前端开发</a> <a href="/tags/debugger/" style="font-size: 10px;">debugger</a> <a href="/tags/es5-js/" style="font-size: 10px;">es5 js</a> <a href="/tags/fit/" style="font-size: 10px;">fit</a> <a href="/tags/flex-css3/" style="font-size: 10px;">flex css3</a> <a href="/tags/git-github/" style="font-size: 10px;">git github</a> <a href="/tags/h5-webworkers/" style="font-size: 10px;">h5 webworkers</a> <a href="/tags/i18n/" style="font-size: 10px;">i18n</a> <a href="/tags/iframe/" style="font-size: 10px;">iframe</a> <a href="/tags/javascript、object-oriented、继承/" style="font-size: 10px;">javascript、object-oriented、继承</a> <a href="/tags/jquery/" style="font-size: 10px;">jquery</a> <a href="/tags/js/" style="font-size: 10px;">js</a> <a href="/tags/js-Array/" style="font-size: 10px;">js Array</a> <a href="/tags/js-Higher-order-function/" style="font-size: 10px;">js Higher-order-function</a> <a href="/tags/js-closure/" style="font-size: 10px;">js closure</a> <a href="/tags/js-lodash/" style="font-size: 10px;">js lodash</a> <a href="/tags/js-object/" style="font-size: 10px;">js object</a> <a href="/tags/js-scope/" style="font-size: 10px;">js scope</a> <a href="/tags/js-sea-js-模块化/" style="font-size: 10px;">js sea.js 模块化</a> <a href="/tags/js-this/" style="font-size: 10px;">js this</a> <a href="/tags/js-性能调试-Benchmark-jsPerf/" style="font-size: 10px;">js 性能调试 Benchmark jsPerf</a> <a href="/tags/js-柯里化/" style="font-size: 10px;">js 柯里化</a> <a href="/tags/js-纯函数/" style="font-size: 10px;">js 纯函数</a> <a href="/tags/js、变态题/" style="font-size: 10px;">js、变态题</a> <a href="/tags/js、设计模式/" style="font-size: 10px;">js、设计模式</a> <a href="/tags/js、跨域、document-domain/" style="font-size: 10px;">js、跨域、document.domain</a> <a href="/tags/js模块化、AMD、CMD、CommonJs/" style="font-size: 10px;">js模块化、AMD、CMD、CommonJs</a> <a href="/tags/js继承/" style="font-size: 10px;">js继承</a> <a href="/tags/js继承、原型链/" style="font-size: 10px;">js继承、原型链</a> <a href="/tags/life、意念/" style="font-size: 10px;">life、意念</a> <a href="/tags/lodash-chain/" style="font-size: 10px;">lodash chain</a> <a href="/tags/markdown/" style="font-size: 10px;">markdown</a> <a href="/tags/mongoDB-数据库/" style="font-size: 10px;">mongoDB 数据库</a> <a href="/tags/mvp/" style="font-size: 10px;">mvp</a> <a href="/tags/nginx/" style="font-size: 12.5px;">nginx</a> <a href="/tags/node/" style="font-size: 12.5px;">node</a> <a href="/tags/node-debug/" style="font-size: 10px;">node debug</a> <a href="/tags/node-wechat/" style="font-size: 20px;">node wechat</a> <a href="/tags/nodejs/" style="font-size: 10px;">nodejs</a> <a href="/tags/promise、es6/" style="font-size: 10px;">promise、es6</a> <a href="/tags/rap/" style="font-size: 17.5px;">rap</a> <a href="/tags/react/" style="font-size: 10px;">react</a> <a href="/tags/react-ant-design/" style="font-size: 10px;">react ant-design</a> <a href="/tags/seo/" style="font-size: 20px;">seo</a> <a href="/tags/seo-新闻源/" style="font-size: 10px;">seo 新闻源</a> <a href="/tags/vue、mvvm/" style="font-size: 10px;">vue、mvvm</a> <a href="/tags/web/" style="font-size: 10px;">web</a> <a href="/tags/web-交互/" style="font-size: 10px;">web 交互</a> <a href="/tags/web、前端/" style="font-size: 10px;">web、前端</a> <a href="/tags/web、性能优化/" style="font-size: 10px;">web、性能优化</a> <a href="/tags/wechat/" style="font-size: 10px;">wechat</a> <a href="/tags/wechat-webstorm/" style="font-size: 10px;">wechat webstorm</a> <a href="/tags/win10、linux/" style="font-size: 10px;">win10、linux</a> <a href="/tags/window-history-html5/" style="font-size: 10px;">window.history html5</a> <a href="/tags/wxapp/" style="font-size: 15px;">wxapp</a> <a href="/tags/yarn-npm/" style="font-size: 10px;">yarn npm</a> <a href="/tags/人生/" style="font-size: 10px;">人生</a> <a href="/tags/前后端分享/" style="font-size: 10px;">前后端分享</a> <a href="/tags/前端工程-构建工具-前端开发/" style="font-size: 10px;">前端工程 构建工具 前端开发</a> <a href="/tags/前端脚手架/" style="font-size: 10px;">前端脚手架</a> <a href="/tags/建站-seo/" style="font-size: 10px;">建站 seo</a> <a href="/tags/性能优化/" style="font-size: 10px;">性能优化</a> <a href="/tags/生活/" style="font-size: 20px;">生活</a> <a href="/tags/移动端、fixed/" style="font-size: 10px;">移动端、fixed</a> <a href="/tags/解构赋值-es6/" style="font-size: 10px;">解构赋值 es6</a> <a href="/tags/跨域、postMessage、html5/" style="font-size: 10px;">跨域、postMessage、html5</a> <a href="/tags/路由-html5/" style="font-size: 10px;">路由 html5</a>
                    </div>
                </section>
                
                
                
                <section class="switch-part switch-part3">
                    <div id="js-friends">
                    
                      <a target="_blank" class="main-nav-link switch-friends-link" href="http://www.webywx.com">前端小站</a>
                    
                      <a target="_blank" class="main-nav-link switch-friends-link" href="http://ywxi.github.io/">web博客</a>
                    
                    </div>
                </section>
                

                
                
                <section class="switch-part switch-part4">
                
                    <div id="js-aboutme">运动健身、网络营销、web前端、喜欢接触新鲜事物、迎接新的挑战</div>
                </section>
                
            </div>
        </div>
    </header>                
</div>
    </div>
    <div class="mid-col">
      <nav id="mobile-nav">
      <div class="overlay">
          <div class="slider-trigger"></div>
          <h1 class="header-author js-mobile-header hide"><a href="/" title="Me">Wenxi Yan</a></h1>
      </div>
    <div class="intrude-less">
        <header id="header" class="inner">
            <a href="/" class="profilepic">
                
                    <img lazy-src="/img/head.jpg" class="js-avatar">
                
            </a>
            <hgroup>
              <h1 class="header-author"><a href="/" title="Me">Wenxi Yan</a></h1>
            </hgroup>
            
            <nav class="header-menu">
                <ul>
                
                    <li><a href="/Home">我的小窝</a></li>
                
                    <li><a href="/archives">文章列表</a></li>
                
                    <li><a href="/">博客首页</a></li>
                
                    <li><a href="/about">关于我</a></li>
                
                <div class="clearfix"></div>
                </ul>
            </nav>
            <nav class="header-nav">
                <div class="social">
                    
                        <a class="mail" target="_blank" href="http://mail.qq.com/cgi-bin/qm_share?t=qm_mailme&email=ywx_software@foxmail.com" title="mail">mail</a>
                    
                        <a class="github" target="_blank" href="https://github.com/yanwenxi" title="github">github</a>
                    
                        <a class="QQ" target="_blank" href="http://www.webywx.com" title="QQ">QQ</a>
                    
                        <a class="wechat" target="_blank" href="http://mail.qq.com/cgi-bin/qm_share?t=qm_mailme&email=ywx_software@foxmail.com" title="wechat">wechat</a>
                    
                </div>
            </nav>
        </header>                
    </div>
</nav>
      <div class="body-wrap">
  
    <article id="post-yahuyouhua" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2016/07/04/yahuyouhua/" class="article-date">
      <time datetime="2016-07-04T06:52:55.000Z" itemprop="datePublished">2016-07-04</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/07/04/yahuyouhua/">雅虎网站性能优化的 14 条规则</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
        <ol>
<li>尽可能减少 HTTP 请求数</li>
<li>使用 CDN（内容分发网络）</li>
<li>为文件头指定 Expires 或 Cache-Control，使内容具有缓存性</li>
<li>使用 Gzip 压缩内容</li>
<li>把 CSS 放到顶部</li>
<li>把 JavaScript 放在底部</li>
<li>避免在 CSS 中使用 Expressions</li>
<li>把 JavaScript 和 CSS 都放到外部文件中</li>
<li>减少 DNS 查找次数</li>
<li>压缩 JavaScript 和 CSS</li>
<li>避免重定向</li>
<li>剔除重复的 JavaScript 和 CSS</li>
<li>配置 Etags</li>
<li>使 AJAX 缓存</li>
</ol>
<h4 id="对上述规则的分析"><a href="#对上述规则的分析" class="headerlink" title="对上述规则的分析"></a>对上述规则的分析</h4><p>一、 代码编写方面的规则</p>
<ul>
<li>把 CSS 放到顶部</li>
<li>把 JavaScript 放在底部</li>
<li>把 JavaScript 和 CSS 都放到外部文件中</li>
<li>避免在 CSS 中使用 Expressions（css表达式）</li>
<li>使 AJAX 缓存</li>
</ul>
<p>二、 打包方面的规则：</p>
<ul>
<li>尽可能减少 HTTP 请求数</li>
<li>压缩 JavaScript 和 CSS</li>
<li>剔除重复的 JavaScript 和 CSS</li>
</ul>
<p>三、 部署方面的规则：</p>
<ul>
<li>使用 CDN（内容分发网络）</li>
<li>为文件头指定 Expires 或 Cache-Control，使内容具有缓存性</li>
<li>使用 Gzip 压缩内容</li>
<li>减少 DNS 查找次数</li>
<li>避免重定向</li>
<li>配置 Etags</li>
</ul>
<h4 id="对规则的实践"><a href="#对规则的实践" class="headerlink" title="对规则的实践"></a>对规则的实践</h4><ul>
<li>部署方面的规则，应用 Nginx 为静态文件添加 Expires 跟 Cache-Control 头， 配置 Etags，并启用 Gzip 压缩。并且避免在 Nginx 中做重定向，有条件的话可以 启用 CDN，并优化网络配置以减少 DNS 查找次数。</li>
<li>代码编写方面的规则，需要在编写代码种形成规范。默认使用类似 jQuery 这样的库 便可以对 AJAX 进行缓存。</li>
<li>打包方面 webpack 可以合并压缩 JavaScript 与 CSS 文件, 小图片的合并（css雪碧图）或者字体图标或者用base64 用以减少 HTTP 请求数。</li>
</ul>

      
    </div>
    
    <div class="article-info article-info-index">
      
      

      
    <div class="article-tag tagcloud">
        <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/性能优化/">性能优化</a></li></ul>
    </div>

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>









  
    <article id="post-angular-guide17-angular中的promise" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2016/06/29/angular-guide17-angular中的promise/" class="article-date">
      <time datetime="2016-06-28T16:50:58.000Z" itemprop="datePublished">2016-06-29</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/06/29/angular-guide17-angular中的promise/">Angular中如何使用promise</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
        <h4 id="Angular-中的-promise"><a href="#Angular-中的-promise" class="headerlink" title="Angular 中的 promise"></a>Angular 中的 promise</h4><p>Angular的事件循环给予了Angular特有的能力，能在$rootScope.$evalAsync阶段中执行promise, promise会坐等$digest运行循环结束。<br>我们来建一个例子，从GitHub上返回一组针对AngularJS的开放pull请求。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">&lt;h1&gt;Open Pull Requests for Angular JS&lt;/h1&gt;</div><div class="line">&lt;ul ng-controller=&quot;DashboardController&quot;&gt;</div><div class="line">&lt;li ng-repeat=&quot;pr in pullRequests&quot;&gt;</div><div class="line">&#123;&#123; pr.title &#125;&#125;</div><div class="line">&lt;/li&gt;</div><div class="line">&lt;/ul&gt;</div></pre></td></tr></table></figure></p>
<p>如果有个服务返回了一个promise，可以在.then()方法中与这个promise交互，它允许我们修改作用域上的任意变量，放置到视图上，并且期望Angular会为我们执行它：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">angular.module(&apos;myApp&apos;, [])</div><div class="line">.controller(&apos;DashboardController&apos;, [</div><div class="line">&apos;$scope&apos;, &apos;GithubService&apos;,</div><div class="line">function($scope, UserService) &#123;</div><div class="line">// GithubService的getPullRequests()方法</div><div class="line">// 返回了一个promise</div><div class="line">User.getPullRequests(123)</div><div class="line">.then(function(data) &#123;</div><div class="line">$scope.pullRequests = data.data;</div><div class="line">&#125;);</div><div class="line">&#125;]);</div></pre></td></tr></table></figure></p>
<p>当 对 getPullRequests 的 异 步 调 用 返回 时 ， 在 .then()方 法 中 就 可 以 用 $scope.pull Requests这个值了，然后它会更新$scope.pullRequests数组。<br>Angular 中的 promise<br>Angular的事件循环给予了Angular特有的能力，能在$rootScope.$evalAsync阶段中执行<br>promise（关于运行循环的更多细节，参见第24章）。 promise会坐等$digest运行循环结束。<br>这件事让我们能毫无压力地把promise的结果转换到视图上。它也能让我们不加思考地把<br>XHR调用的结果直接赋值到$scope对象的属性上。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">&lt;h1&gt;Open Pull Requests for Angular JS&lt;/h1&gt;</div><div class="line">&lt;ul ng-controller=&quot;DashboardController&quot;&gt;</div><div class="line">&lt;li ng-repeat=&quot;pr in pullRequests&quot;&gt;</div><div class="line">&#123;&#123; pr.title &#125;&#125;</div><div class="line">&lt;/li&gt;</div><div class="line">&lt;/ul&gt;</div></pre></td></tr></table></figure></p>
<p>如果有个服务返回了一个promise，可以在.then()方法中与这个promise交互，它允许我们修改作用域上的任意变量，放置到视图上，并且期望Angular会为我们执行它：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">angular.module(&apos;myApp&apos;, [])</div><div class="line">.controller(&apos;DashboardController&apos;, [</div><div class="line">&apos;$scope&apos;, &apos;GithubService&apos;,</div><div class="line">function($scope, UserService) &#123;</div><div class="line">// GithubService的getPullRequests()方法</div><div class="line">// 返回了一个promise</div><div class="line">User.getPullRequests(123)</div><div class="line">.then(function(data) &#123;</div><div class="line">$scope.pullRequests = data.data;</div><div class="line">&#125;);</div><div class="line">&#125;]);</div></pre></td></tr></table></figure></p>
<p>当 对 getPullRequests 的 异 步 调 用 返回 时 ， 在 .then()方 法 中 就 可 以 用 $scope.pull<br>Requests这个值了，然后它会更新$scope.pullRequests数组。</p>
<h4 id="如何创建一个-promise"><a href="#如何创建一个-promise" class="headerlink" title="如何创建一个 promise"></a>如何创建一个 promise</h4><p>想要在Angular中创建promise，可以使用内置的$q服务。 $q服务在它的deferred API中提供了一些方法。<br>首先，需要把$q服务注入到想要使用它的对象中。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">angular.module(&apos;myApp&apos;, [])</div><div class="line">.factory(&apos;GithubService&apos;, [&apos;$q&apos;, function($q) &#123;</div><div class="line">// 现在就可以访问到$q库了</div><div class="line">&#125;]);</div></pre></td></tr></table></figure></p>
<p>要创建一个deferred对象，可以调用defer()方法：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">var deferred = $q.defer();</div></pre></td></tr></table></figure></p>
<p>deferred对象暴露了三个方法，以及一个可以用于处理promise的promise属性。<br>可以用于处理promise的promise属性：这句话其实就是说deferred对象有一个promise属性。即deferred.promise。<br>deffered 对象属性promise ：最后返回的是一个新的deferred对象 promise 属性，而不是原来的deferred对象。这个新的Promise对象只能观察原来Promise对象的状态，而无法修改deferred对象的内在状态可以防止任务状态被外部修改。</p>
<ol>
<li><p>resolve（value）<br>resolve函数用这个值来执行deferred promise。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">deferred.resolve(&#123;name: &quot;Ari&quot;, username: &quot;@auser&quot;&#125;);</div></pre></td></tr></table></figure>
</li>
<li><p>reject（reason）<br>这个方法用一个原因来拒绝deferred promise。它等同于使用一个“拒绝”来执行一个promise。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">deferred.reject(&quot;Can&apos;t update user&quot;);</div><div class="line">// 等同于</div><div class="line">deferred.resolve($q.reject(&quot;Can&apos;t update user&quot;));</div></pre></td></tr></table></figure>
</li>
<li><p>notify（value）<br>这个方法用promise的执行状态来进行响应。notify 回调可能被调用 0到多次,提供一个进度指示在解决或拒绝（resolve和rejected）之前。</p>
<h4 id="方法介绍："><a href="#方法介绍：" class="headerlink" title="方法介绍："></a>方法介绍：</h4><p>$http(options)返回的是一个被封装的promise对象，可以直接使用.then等方法。</p>
</li>
<li>then(successFn, errFn, notifyFn)<br>无论promise成功还是失败了，当结果可用之后， then都会立刻异步调用successFn或者errFn。这个方法始终用一个参数来调用回调函数：结果，或者是拒绝的理由。在promise被执行或者拒绝之前， notifyFn回调可能会被调用0到多次，以提供过程状态的提示。<br>then()方法总是返回一个新的promise，可以通过successFn或者errFn这样的返回值执行或者被拒绝。它也能通过notifyFn提供通知。</li>
<li><p>catch(errFn)<br>这个方法就只是个帮助函数，能让我们用.catch(function(reason){})取代err回调：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">$http.get(&apos;/repos/angular/angular.js/pulls&apos;)</div><div class="line">.catch(function(reason) &#123;</div><div class="line">deferred.reject(reason);</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
</li>
<li><p>finally(callback)<br>finally方法允许我们观察promise的履行或者拒绝，而无需修改结果的值。当我们需要释放一个资源，或者是运行一些清理工作，不管promise是成功还是失败时，这个方法会很有用。<br>我们不能直接调用这个方法，因为finally是IE中JavaScript的一个保留字。纠结到最后，只好这样调用它了：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">promise[&apos;finally&apos;](function() &#123;&#125;);</div></pre></td></tr></table></figure>
</li>
</ol>
<p>Angular的$q deferred对象是可以串成链的，这样即使是then，返回的也是一个promise。这个promise一被执行， then返回的promise就已经是resolved或者rejected的了。</p>
<h4 id="q服务类似于原始的Kris-Kowal的Q库："><a href="#q服务类似于原始的Kris-Kowal的Q库：" class="headerlink" title="$q服务类似于原始的Kris Kowal的Q库："></a>$q服务类似于原始的Kris Kowal的Q库：</h4><ol>
<li>$q是跟Angular的$rootScope模型集成的，所以在Angular中，执行和拒绝都很快。</li>
<li>$q promise是跟Angular模板引擎集成的，这意味着在视图中找到的任何promise都会在视<br>图中被执行或者拒绝。</li>
<li>$q很小，所以没有包含Q库的完整功能。<h3 id="链式请求"><a href="#链式请求" class="headerlink" title="链式请求"></a>链式请求</h3>then方法在初始promise被执行之后，返回一个新的派生promise。这种返回形式给了我们一种特有的能力，把另一个then接在初始的then方法结果之后。<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">// 一个响应promise的服务</div><div class="line">GithubService.then(function(data) &#123;</div><div class="line">var events = [];</div><div class="line">for (var i = 0; i &lt; data.length; i++) &#123;</div><div class="line">events.push(data[i].events);</div><div class="line">&#125;</div><div class="line">return events;</div><div class="line">&#125;).then(function(events) &#123;</div><div class="line">$scope.events = events;</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
</li>
</ol>
<p>在本例中，我们可以创建一个执行链，它允许我们中断基于更多功能的应用流程，可以籍此导向不同的结果。这个中断能让我们在执行链的任意时刻暂停或者推迟promise的执行。</p>
<h4 id="q库自带了几个不同的有用方法。"><a href="#q库自带了几个不同的有用方法。" class="headerlink" title="$q库自带了几个不同的有用方法。"></a>$q库自带了几个不同的有用方法。</h4><ol>
<li>all(promises)<br>如果我们有多个promise，想要把它们合并成一个，可以使用$q.all(promises)方法来把它们合并成一个promise。这个方法带有一个参数。即promises（数组或者promise对象），一个promise数组或者promise的hash。<br>all()方法返回单个promise，会执行一个数组或者一个散列的值。每个值会响应promise散列中的相同序号或者键。如果任意一个promise被拒绝了，结果的promise也会被拒绝。</li>
<li>defer()<br>defer()方法创建了一个deferred对象，它没有参数，返回deferred对象的一个实例。</li>
<li>reject(reason)<br>这个方法创建了一个promise，被以某一原因拒绝执行了。它专门用于让我们能在一个promise链中转发拒绝的promise，类似JavaScript中的throw。在同样意义上，我们能在JavaScript中捕获一个异常，也能够转发这个拒绝，我们需要把这个错误重新抛出。可以通过$q.reject(reason)来做到这点。<br>这个方法带有单个参数：reason（常量、字符串、异常、对象），拒绝的原因。<br>reject()方法返回一个已经用某个原因拒绝的promise。</li>
<li>when(value)<br>when()函数把一个可能是值或者能接着then的promise包装成一个$q promise。这样我们就能处理一个可能是也可能不是promise的对象。when()函数有一个参数： value，该参数是个值，或者是promise<br>when()函数返回了一个promise，我们可以像使用其他promise一样使用它。</li>
</ol>

      
    </div>
    
    <div class="article-info article-info-index">
      
      

      
    <div class="article-tag tagcloud">
        <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/angular、promise、-q、deferred/">angular、promise、$q、deferred</a></li></ul>
    </div>

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>









  
    <article id="post-dajianjiaoshoujia" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2016/06/13/dajianjiaoshoujia/" class="article-date">
      <time datetime="2016-06-13T09:32:09.000Z" itemprop="datePublished">2016-06-13</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/06/13/dajianjiaoshoujia/">教你从零开始搭建一款前端脚手架工具</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
        <p><em>CLI</em>:command-line interface，命令行界面.<br><a href="https://segmentfault.com/a/1190000006190814?utm_source=tuicool&amp;utm_medium=referral#articleHeader0" target="_blank" rel="external">文章来源地址</a></p>
<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>　　在实际的开发过程中，从零开始建立项目的结构是一件让人头疼的事情，所以各种各样的脚手架工具应运而生。使用较多koa-generator、yoeman、express-generator和vue-cli便是当中之一。它们功能丰富，但最核心的功能都是能够快速搭建一个完整的项目的结构，开发者只需要在生成的项目结构的基础上进行开发即可，非常简单高效。<br>    自己搭建一款叫做SCION的脚手架。现在让我们就以SCION为例，从零开始搭建一款属于我们自己的脚手架工具吧！<br>核心原理<br>yoeman搭建项目需要提供yoeman-generator。yoeman-generator本质上就是一个具备完整文件结构的项目样板，用户需要手动地把这些generator下载到本地，然后yoeman就会根据这些generator自动生成各种不同的项目。</p>
<p>vue-cli提供了相当丰富的选项和设定功能，但是其本质也是从远程仓库把不同的模版拉取到本地，而并非是什么“本地生成”的黑科技。</p>
<p>这样看来，思路也就有了——首先建立不同的样板项目，然后脚手架根据用户的指令引用样板项目生成实际项目。样板项目可以内置在脚手架当中，也可以部署在远程仓库。为了更广的适用范围，SCION采用的是第二种方式。</p>
<p>技术选型<br>node.js：整个脚手架工具的根本组成部分，推荐使用最新的版本。<br>es6：新版本的node.js对于es6的支持度已经非常高，使用es6能够极大地提升开发效率和开发感受。<br>commander：TJ大神开发的工具，能够更好地组织和处理命令行的输入。<br>co：TJ大神开发的异步流程控制工具，用更舒服的方式写异步代码。<br>co-prompt：还是TJ大神的作品……传统的命令行只能单行一次性地输入所有参数和选项，使用这个工具可以自动提供提示信息，并且分步接收用户的输入，体验类似npm init时的一步一步输入参数的过程。<br>整体架构<br>国际惯例，着手开发之前得先弄明白整体架构，看图：</p>
<p>首先明白模版的概念。一个模版就是一个项目的样板，包含项目的完整结构和信息。<br>模版的信息都存放在一个叫做templates.json的文件当中。<br>用户可以通过命令行对templates.json进行添加、删除、罗列的操作。<br>通过选择不同的模版，SCION会自动从远程仓库把相应的模板拉取到本地，完成项目的搭建。</p>
<p>最终整个脚手架的文件结构如下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div><div class="line">127</div><div class="line">128</div><div class="line">129</div><div class="line">130</div><div class="line">131</div><div class="line">132</div><div class="line">133</div><div class="line">134</div><div class="line">135</div><div class="line">136</div><div class="line">137</div><div class="line">138</div><div class="line">139</div><div class="line">140</div><div class="line">141</div><div class="line">142</div><div class="line">143</div><div class="line">144</div><div class="line">145</div><div class="line">146</div><div class="line">147</div><div class="line">148</div><div class="line">149</div><div class="line">150</div><div class="line">151</div><div class="line">152</div><div class="line">153</div><div class="line">154</div><div class="line">155</div><div class="line">156</div><div class="line">157</div><div class="line">158</div><div class="line">159</div><div class="line">160</div><div class="line">161</div><div class="line">162</div><div class="line">163</div><div class="line">164</div><div class="line">165</div><div class="line">166</div><div class="line">167</div><div class="line">168</div><div class="line">169</div><div class="line">170</div><div class="line">171</div><div class="line">172</div><div class="line">173</div><div class="line">174</div><div class="line">175</div><div class="line">176</div><div class="line">177</div><div class="line">178</div><div class="line">179</div><div class="line">180</div><div class="line">181</div><div class="line">182</div><div class="line">183</div><div class="line">184</div><div class="line">185</div><div class="line">186</div><div class="line">187</div><div class="line">188</div><div class="line">189</div><div class="line">190</div><div class="line">191</div><div class="line">192</div><div class="line">193</div><div class="line">194</div><div class="line">195</div><div class="line">196</div><div class="line">197</div><div class="line">198</div><div class="line">199</div><div class="line">200</div><div class="line">201</div><div class="line">202</div><div class="line">203</div><div class="line">204</div><div class="line">205</div><div class="line">206</div><div class="line">207</div><div class="line">208</div><div class="line">209</div><div class="line">210</div><div class="line">211</div><div class="line">212</div><div class="line">213</div><div class="line">214</div><div class="line">215</div><div class="line">216</div><div class="line">217</div><div class="line">218</div><div class="line">219</div><div class="line">220</div><div class="line">221</div><div class="line">222</div><div class="line">223</div><div class="line">224</div></pre></td><td class="code"><pre><div class="line">  |__ bin</div><div class="line">    |__ scion</div><div class="line">  |__ command</div><div class="line">    |__ add.js</div><div class="line">    |__ delete.js</div><div class="line">    |__ init.js</div><div class="line">    |__ list.js</div><div class="line">  |__ node_modules</div><div class="line">  |__ package.json</div><div class="line">  |__ templates.json</div><div class="line">入口文件</div><div class="line">首先建立项目，在package.json里面写入依赖并执行npm install：</div><div class="line"></div><div class="line">&quot;dependencies&quot;: &#123;</div><div class="line">    &quot;chalk&quot;: &quot;^1.1.3&quot;,</div><div class="line">    &quot;co&quot;: &quot;^4.6.0&quot;,</div><div class="line">    &quot;co-prompt&quot;: &quot;^1.0.0&quot;,</div><div class="line">    &quot;commander&quot;: &quot;^2.9.0&quot;</div><div class="line">  &#125;</div><div class="line">在根目录下建立\bin文件夹，在里面建立一个无后缀名的scion文件。这个bin\scion文件是整个脚手架的入口文件，所以我们首先对它进行编写。</div><div class="line"></div><div class="line">首先是一些初始化的代码：</div><div class="line"></div><div class="line">#!/usr/bin/env node --harmony</div><div class="line">&apos;use strict&apos;</div><div class="line"> // 定义脚手架的文件路径</div><div class="line">process.env.NODE_PATH = __dirname + &apos;/../node_modules/&apos;</div><div class="line"></div><div class="line">const program = require(&apos;commander&apos;)</div><div class="line"></div><div class="line"> // 定义当前版本</div><div class="line">program</div><div class="line">    .version(require(&apos;../package&apos;).version )</div><div class="line"></div><div class="line">// 定义使用方法</div><div class="line">program</div><div class="line">    .usage(&apos;&lt;command&gt;&apos;)</div><div class="line">从前文的架构图中可以知道，脚手架支持用户输入4种不同的命令。现在我们来写处理这4种命令的方法：</div><div class="line"></div><div class="line">program</div><div class="line">    .command(&apos;add&apos;)</div><div class="line">    .description(&apos;Add a new template&apos;)</div><div class="line">  .alias(&apos;a&apos;)</div><div class="line">  .action(() =&gt; &#123;</div><div class="line">    require(&apos;../command/add&apos;)()</div><div class="line">  &#125;)</div><div class="line"></div><div class="line">program</div><div class="line">    .command(&apos;list&apos;)</div><div class="line">    .description(&apos;List all the templates&apos;)</div><div class="line">    .alias(&apos;l&apos;)</div><div class="line">    .action(() =&gt; &#123;</div><div class="line">        require(&apos;../command/list&apos;)()</div><div class="line">    &#125;)</div><div class="line"></div><div class="line">program</div><div class="line">    .command(&apos;init&apos;)</div><div class="line">    .description(&apos;Generate a new project&apos;)</div><div class="line">  .alias(&apos;i&apos;)</div><div class="line">  .action(() =&gt; &#123;</div><div class="line">    require(&apos;../command/init&apos;)()</div><div class="line">  &#125;)</div><div class="line"></div><div class="line">program</div><div class="line">    .command(&apos;delete&apos;)</div><div class="line">    .description(&apos;Delete a template&apos;)</div><div class="line">    .alias(&apos;d&apos;)</div><div class="line">    .action(() =&gt; &#123;</div><div class="line">        require(&apos;../command/delete&apos;)()</div><div class="line">    &#125;)</div><div class="line">commander的具体使用方法在这里就不展开了，可以直接到官网去看详细的文档。</div><div class="line">最后别忘了处理参数和提供帮助信息：</div><div class="line"></div><div class="line">program.parse(process.argv)</div><div class="line"></div><div class="line">if(!program.args.length)&#123;</div><div class="line">  program.help()</div><div class="line">&#125;</div><div class="line">完整的代码请看这里。</div><div class="line">使用node运行这个文件，看到输出如下，证明入口文件已经编写完成了。</div><div class="line"></div><div class="line">Usage: scion &lt;command&gt;</div><div class="line"></div><div class="line"></div><div class="line">  Commands:</div><div class="line"></div><div class="line">    add|a      Add a new template</div><div class="line">    list|l     List all the templates</div><div class="line">    init|i     Generate a new project</div><div class="line">    delete|d   Delete a template</div><div class="line"></div><div class="line">  Options:</div><div class="line"></div><div class="line">    -h, --help     output usage information</div><div class="line">    -V, --version  output the version number</div><div class="line">处理用户输入</div><div class="line">在项目根目录下建立\command文件夹，专门用来存放命令处理文件。</div><div class="line">在根目录下建立templates.json文件并写入如下内容，用来存放模版信息：</div><div class="line"></div><div class="line">&#123;&quot;tpl&quot;:&#123;&#125;&#125;</div><div class="line">添加模板</div><div class="line">进入\command并新建add.js文件：</div><div class="line"></div><div class="line">&apos;use strict&apos;</div><div class="line">const co = require(&apos;co&apos;)</div><div class="line">const prompt = require(&apos;co-prompt&apos;)</div><div class="line">const config = require(&apos;../templates&apos;)</div><div class="line">const chalk = require(&apos;chalk&apos;)</div><div class="line">const fs = require(&apos;fs&apos;)</div><div class="line"></div><div class="line">module.exports = () =&gt; &#123;</div><div class="line"> co(function *() &#123;</div><div class="line"></div><div class="line">   // 分步接收用户输入的参数</div><div class="line">   let tplName = yield prompt(&apos;Template name: &apos;)</div><div class="line">   let gitUrl = yield prompt(&apos;Git https link: &apos;)</div><div class="line">   let branch = yield prompt(&apos;Branch: &apos;)</div><div class="line">    </div><div class="line">   // 避免重复添加</div><div class="line">   if (!config.tpl[tplName]) &#123;</div><div class="line">     config.tpl[tplName] = &#123;&#125;</div><div class="line">     config.tpl[tplName][&apos;url&apos;] = gitUrl.replace(/[\u0000-\u0019]/g, &apos;&apos;) // 过滤unicode字符</div><div class="line">     config.tpl[tplName][&apos;branch&apos;] = branch</div><div class="line">   &#125; else &#123;</div><div class="line">     console.log(chalk.red(&apos;Template has already existed!&apos;))</div><div class="line">     process.exit()</div><div class="line">   &#125;</div><div class="line">   </div><div class="line">   // 把模板信息写入templates.json</div><div class="line">   fs.writeFile(__dirname + &apos;/../templates.json&apos;, JSON.stringify(config), &apos;utf-8&apos;, (err) =&gt; &#123;</div><div class="line">     if (err) console.log(err)</div><div class="line">     console.log(chalk.green(&apos;New template added!\n&apos;))</div><div class="line">     console.log(chalk.grey(&apos;The last template list is: \n&apos;))</div><div class="line">     console.log(config)</div><div class="line">     console.log(&apos;\n&apos;)</div><div class="line">     process.exit()</div><div class="line">    &#125;)</div><div class="line"> &#125;)</div><div class="line">&#125;</div><div class="line">删除模板</div><div class="line">同样的，在\command文件夹下建立delete.js文件：</div><div class="line"></div><div class="line">&apos;use strict&apos;</div><div class="line">const co = require(&apos;co&apos;)</div><div class="line">const prompt = require(&apos;co-prompt&apos;)</div><div class="line">const config = require(&apos;../templates&apos;)</div><div class="line">const chalk = require(&apos;chalk&apos;)</div><div class="line">const fs = require(&apos;fs&apos;)</div><div class="line"></div><div class="line">module.exports = () =&gt; &#123;</div><div class="line">    co(function *() &#123;</div><div class="line">        // 接收用户输入的参数</div><div class="line">        let tplName = yield prompt(&apos;Template name: &apos;)</div><div class="line"></div><div class="line">        // 删除对应的模板</div><div class="line">        if (config.tpl[tplName]) &#123;</div><div class="line">            config.tpl[tplName] = undefined</div><div class="line">        &#125; else &#123;</div><div class="line">            console.log(chalk.red(&apos;Template does not exist!&apos;))</div><div class="line">            process.exit()</div><div class="line">        &#125;</div><div class="line">        </div><div class="line">        // 写入template.json</div><div class="line">        fs.writeFile(__dirname + &apos;/../templates.json&apos;, JSON.stringify(config),     &apos;utf-8&apos;, (err) =&gt; &#123;</div><div class="line">            if (err) console.log(err)</div><div class="line">            console.log(chalk.green(&apos;Template deleted!&apos;))</div><div class="line">            console.log(chalk.grey(&apos;The last template list is: \n&apos;))</div><div class="line">            console.log(config)</div><div class="line">            console.log(&apos;\n&apos;)</div><div class="line">            process.exit()</div><div class="line">        &#125;)</div><div class="line">    &#125;)</div><div class="line">&#125;</div><div class="line">罗列模板</div><div class="line">建立list.js文件：</div><div class="line"></div><div class="line">&apos;use strict&apos;</div><div class="line">const config = require(&apos;../templates&apos;)</div><div class="line"></div><div class="line">module.exports = () =&gt; &#123;</div><div class="line">     console.log(config.tpl)</div><div class="line">     process.exit()</div><div class="line">&#125;</div><div class="line">构建项目</div><div class="line">现在来到我们最重要的部分——构建项目。同样的，在\command目录下新建一个叫做init.js的文件：</div><div class="line"></div><div class="line">&apos;use strict&apos;</div><div class="line">const exec = require(&apos;child_process&apos;).exec</div><div class="line">const co = require(&apos;co&apos;)</div><div class="line">const prompt = require(&apos;co-prompt&apos;)</div><div class="line">const config = require(&apos;../templates&apos;)</div><div class="line">const chalk = require(&apos;chalk&apos;)</div><div class="line"></div><div class="line">module.exports = () =&gt; &#123;</div><div class="line"> co(function *() &#123;</div><div class="line">    // 处理用户输入</div><div class="line">      let tplName = yield prompt(&apos;Template name: &apos;)</div><div class="line">      let projectName = yield prompt(&apos;Project name: &apos;)</div><div class="line">      let gitUrl</div><div class="line">      let branch</div><div class="line"></div><div class="line">    if (!config.tpl[tplName]) &#123;</div><div class="line">        console.log(chalk.red(&apos;\n × Template does not exit!&apos;))</div><div class="line">        process.exit()</div><div class="line">    &#125;</div><div class="line">    gitUrl = config.tpl[tplName].url</div><div class="line">    branch = config.tpl[tplName].branch</div><div class="line"></div><div class="line">    // git命令，远程拉取项目并自定义项目名</div><div class="line">    let cmdStr = `git clone $&#123;gitUrl&#125; $&#123;projectName&#125; &amp;&amp; cd $&#123;projectName&#125; &amp;&amp; git checkout $&#123;branch&#125;`</div><div class="line"></div><div class="line">    console.log(chalk.white(&apos;\n Start generating...&apos;))</div><div class="line"></div><div class="line">    exec(cmdStr, (error, stdout, stderr) =&gt; &#123;</div><div class="line">      if (error) &#123;</div><div class="line">        console.log(error)</div><div class="line">        process.exit()</div><div class="line">      &#125;</div><div class="line">      console.log(chalk.green(&apos;\n √ Generation completed!&apos;))</div><div class="line">      console.log(`\n cd $&#123;projectName&#125; &amp;&amp; npm install \n`)</div><div class="line">      process.exit()</div><div class="line">    &#125;)</div><div class="line">  &#125;)</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>可以看到，这一部分代码也非常简单，关键的一句话是<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">let cmdStr = `git clone $&#123;gitUrl&#125; $&#123;projectName&#125; &amp;&amp; cd $&#123;projectName&#125; &amp;&amp; git checkout $&#123;branch&#125;`</div></pre></td></tr></table></figure></p>
<p>它的作用正是从远程仓库克隆到自定义目录，并切换到对应的分支。熟悉git命令的同学应该明白，不熟悉的同学是时候补补课啦！</p>
<p>全局使用<br>为了可以全局使用，我们需要在package.json里面设置一下：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">&quot;bin&quot;: &#123;</div><div class="line">    &quot;scion&quot;: &quot;bin/scion&quot;</div><div class="line">  &#125;</div></pre></td></tr></table></figure></p>
<p>本地调试的时候，在根目录下执行</p>
<p>npm link<br>即可把scion命令绑定到全局，以后就可以直接以scion作为命令开头而无需敲入长长的node scion之类的命令了。</p>
<p>现在我们的脚手架工具已经搭建好了，一起来尝试一下吧！</p>
<p>使用测试<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">add | a 添加模版命令</div><div class="line"></div><div class="line">init | i 生成项目命令</div><div class="line"></div><div class="line">delete | d 删除模版命令 和 list | l 罗列模版命令</div></pre></td></tr></table></figure></p>
<p>   大功告成啦！现在我们的整个脚手架工具已经搭建完成了，以后只需要知道模板的git https地址和branch就可以不断地往SCION上面添加，团队协作的话只需要分享SCION的templates.json文件就可以了。</p>
<h3 id="后记"><a href="#后记" class="headerlink" title="后记"></a>后记</h3><p>   看起来并不复杂的东西，实际从零开始搭建也是颇费了一番心思。最大的难题是在开始的时候并不懂得如何像npm init那样可以一步一步地处理用户输入，只懂得一条命令行把所有的参数都带上，这样的用户体验真的很不好。研究了vue-cli和yoeman也没有找到相应的代码，只好不断地google，最后总算找到了一篇文章，可以用co和co-prompt这两个工具实现，再一次膜拜无所不能的TJ大神，也希望能够有小伙伴告诉我vue-cli它们是怎么实现的。</p>

      
    </div>
    
    <div class="article-info article-info-index">
      
      

      
    <div class="article-tag tagcloud">
        <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/前端脚手架/">前端脚手架</a></li></ul>
    </div>

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>









  
    <article id="post-filternull" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2016/06/05/filternull/" class="article-date">
      <time datetime="2016-06-05T02:22:15.000Z" itemprop="datePublished">2016-06-05</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/06/05/filternull/">AngularJS使用ng-repeat和ng-if实现数据的筛选显示，多适用于表单数据的显示</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
        <p>这篇文章主要介绍了AngularJS使用ng-repeat和ng-if实现数据的删选显示效果,非常适用于表单数据的显示使用,涉及ng-repeat和ng-if命令的相关使用技巧,在项目中用到过，特此记录下，遇到问题要多尝试！总会找到最好的方法。</p>
<h4 id="ng-repeat可以实现内容的重复显示"><a href="#ng-repeat可以实现内容的重复显示" class="headerlink" title="ng-repeat可以实现内容的重复显示"></a>ng-repeat可以实现内容的重复显示</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div></pre></td><td class="code"><pre><div class="line">&lt;!DOCTYPE html&gt;</div><div class="line">&lt;html lang=&quot;en&quot;&gt;</div><div class="line">&lt;head&gt;</div><div class="line">    &lt;meta charset=&quot;UTF-8&quot;&gt;</div><div class="line">    &lt;title&gt;Title&lt;/title&gt;</div><div class="line">  &lt;script src=&quot;https://cdn.static.runoob.com/libs/angular.js/1.4.6/angular.min.js&quot;&gt;&lt;/script&gt;</div><div class="line">&lt;/head&gt;</div><div class="line">&lt;body&gt;</div><div class="line">&lt;div ng-app=&quot;myApp&quot; ng-controller=&quot;myCtrl&quot;&gt;</div><div class="line">  &lt;ul&gt;</div><div class="line">    &lt;li ng-repeat=&quot;x in names&quot;&gt;</div><div class="line">      &#123;&#123; x.name &#125;&#125;我的年龄：&#123;&#123;x.age&#125;&#125;</div><div class="line">    &lt;/li&gt;</div><div class="line">  &lt;/ul&gt;</div><div class="line">&lt;/div&gt;</div><div class="line"></div><div class="line">&lt;script&gt;</div><div class="line">  angular.module(&apos;myApp&apos;, []).controller(&apos;myCtrl&apos;, function($scope) &#123;</div><div class="line">    $scope.names = [</div><div class="line">      &#123;name:&apos;&apos;,age:&apos;20&apos;&#125;,</div><div class="line">      &#123;name:&apos;Hege&apos;,age:&apos;21&apos;&#125;,</div><div class="line">      &#123;name:&apos;Kai&apos;,age:&apos;22&apos;&#125;</div><div class="line">    ];</div><div class="line">  &#125;);</div><div class="line">&lt;/script&gt;</div><div class="line">&lt;/body&gt;</div><div class="line">&lt;/html&gt;</div></pre></td></tr></table></figure>
<p>上述例子名字显示为空，怎么让名字为空的不显示呢？</p>
<h4 id="可以使用ng-repeat-ng-if的方法，这样可以实现简单的前端筛选"><a href="#可以使用ng-repeat-ng-if的方法，这样可以实现简单的前端筛选" class="headerlink" title="可以使用ng-repeat+ng-if的方法，这样可以实现简单的前端筛选"></a>可以使用ng-repeat+ng-if的方法，这样可以实现简单的前端筛选</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">&lt;li ng-repeat=&quot;x in names&quot; ng-if=&quot;x.name&apos;&quot;&gt;</div><div class="line">     &#123;&#123; x.name &#125;&#125;&#123;&#123;x.age&#125;&#125;</div><div class="line">   &lt;/li&gt;</div></pre></td></tr></table></figure>
<p>这样就可以只显示名字不为空的了。如果只想显示名字为Kai的，代码如下：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">&lt;li ng-repeat=&quot;x in names&quot; ng-if=&quot;x.name==&apos;Kai&apos;&quot;&gt;</div><div class="line">     &#123;&#123; x.name &#125;&#125;&#123;&#123;x.age&#125;&#125;</div><div class="line">   &lt;/li&gt;</div></pre></td></tr></table></figure></p>
<h4 id="实现过滤的另一种思路：在controller里直接过滤空值数据，页面直接ng-repeat过滤后的数据即可。"><a href="#实现过滤的另一种思路：在controller里直接过滤空值数据，页面直接ng-repeat过滤后的数据即可。" class="headerlink" title="实现过滤的另一种思路：在controller里直接过滤空值数据，页面直接ng-repeat过滤后的数据即可。"></a>实现过滤的另一种思路：在controller里直接过滤空值数据，页面直接ng-repeat过滤后的数据即可。</h4><p>代码如下：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line">&lt;li ng-repeat=&quot;x in names&quot;&gt;</div><div class="line">      &#123;&#123; x.name &#125;&#125;我的年龄：&#123;&#123;x.age&#125;&#125;</div><div class="line">    &lt;/li&gt;</div><div class="line">angular.module(&apos;myApp&apos;, []).controller(&apos;myCtrl&apos;, function($scope) &#123;</div><div class="line">    $scope.names = [</div><div class="line">      &#123;name:&apos;&apos;,age:&apos;20&apos;&#125;,</div><div class="line">      &#123;name:&apos;Hege&apos;,age:&apos;21&apos;&#125;,</div><div class="line">      &#123;name:&apos;Kai&apos;,age:&apos;22&apos;&#125;</div><div class="line">    ];</div><div class="line">    $scope.names=$scope.names.filter(function(item)&#123;</div><div class="line">    	return item.name != &apos;&apos;;</div><div class="line">    &#125;)</div><div class="line">  &#125;);</div></pre></td></tr></table></figure></p>
<p>这种方式也能只显示有值的名字。</p>

      
    </div>
    
    <div class="article-info article-info-index">
      
      

      
    <div class="article-tag tagcloud">
        <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/angularjs/">angularjs</a></li></ul>
    </div>

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>









  
    <article id="post-angular-fiveservice" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2016/06/01/angular-fiveservice/" class="article-date">
      <time datetime="2016-06-01T06:53:19.000Z" itemprop="datePublished">2016-06-01</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/06/01/angular-fiveservice/">angular中的5种服务</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
        <h4 id="5种创建自定义服务的方式"><a href="#5种创建自定义服务的方式" class="headerlink" title="5种创建自定义服务的方式"></a>5种创建自定义服务的方式</h4><p>1.Provider 2.Factory 3.Service 4.value 5.constant,其中只有provider可以配置，factory是项目中最常用的。<br>服务的作用：提取公共内容，封装公有方法，并且服务是单例的。服务对应的是构造函数。服务名字的后面函数其实是一个服务的构造函数，单例相当于只能new一次创建一个实例，不能创建多个实例来使用。<br>service层主查写逻辑代码的，但在angularJS里也可以持久化数据（充当数据容器），以供不同的controller调用。<br>controller层：即控制层，在angularJS里就是写控制器的。控制器里尽量不要写那些不必要的逻辑，尽量写在service层里。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">//定义构造函数</div><div class="line">var myServiceProvider = function()&#123;</div><div class="line">this.$get = function()&#123;</div><div class="line">return ....</div><div class="line">&#125;;</div><div class="line">&#125;;</div><div class="line">//在模块中登记</div><div class="line">angular.module(&quot;myModule&quot;,[])</div><div class="line">.provider(&quot;myService&quot;,myServiceProvider);</div></pre></td></tr></table></figure></p>
<h4 id="1-provider"><a href="#1-provider" class="headerlink" title="1.provider"></a>1.provider</h4><p>provider 可配置  当注入后会默认调用$get方法   仅仅只有provider可配置.<br>只有provder是能传.config() 函数的服务。如果想在 service 对象启用之前，先进行模块范围的配置，那就应该选择 provider。需要注意的是：在config函数里注入provider时，名字应该是：providerName+Provider.<br>使用Provider的优点就是，你可以在Provider对象传递到应用程序的其他部分之前在app.config函数中对其进行修改。 当你使用Provider创建一个service时，唯一的可以在你的控制器中访问的属性和方法是通过$get()函数返回内容。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">app.provider(&apos;my&apos;,function () &#123;</div><div class="line">    //当我们使用这个服务的时候，会直接调用$get方法</div><div class="line">    this.$get = function () &#123;</div><div class="line">             return &#123;  &#125;</div><div class="line">    &#125;</div><div class="line">&#125;);</div></pre></td></tr></table></figure></p>
<h5 id="可配置的服务"><a href="#可配置的服务" class="headerlink" title="可配置的服务"></a>可配置的服务</h5><p> 有时我们希望服务在不同的场景下可以有不同的行为，这意味着服务可以进行配置。比如，我们希望小计算器可以根据不同的本地化区域，给计算结果追加货币符号前缀， 那么需要在这个服务创建之前，首先配置本地化区域的值，然后在具体的计算中， 根据这个值选择合适的货币符号。<br>      AngularJS使用模块的config()方法对服务进行配置，需要将实例化的服务提供者（而不是服务实例）注入到配置函数中：<br> <figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">angular.module(&quot;myModule&quot;,[])</div><div class="line">.config([&quot;myServiceProvider&quot;,function(myServiceProvider)&#123;</div><div class="line">//do some configuration.</div><div class="line">&#125;]);</div></pre></td></tr></table></figure></p>
<h4 id="2-factory"><a href="#2-factory" class="headerlink" title="2.factory"></a>2.factory</h4><p>factory方式创建的服务，作用就是返回一个有属性有方法的对象。相当于：var f = myFactory();<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">app.factory(&apos;my&apos;,function () &#123;</div><div class="line">return  &#123;&#125;  //返回$get执行后的函数</div><div class="line">&#125;);</div></pre></td></tr></table></figure></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div></pre></td><td class="code"><pre><div class="line">注：使用provider服务时的执行顺序 先config &gt; run &gt; controller</div><div class="line">//需要注意的是：在配置provider时，名字应该是：providerName+Provider   </div><div class="line">    app.config(function(myProviderProvider)&#123;</div><div class="line">        myProviderProvider.setName(&quot;ywx&quot;);       </div><div class="line">    &#125;);</div><div class="line">    app.provider(&apos;myProvider&apos;, function() &#123;</div><div class="line">        var name=&quot;&quot;;</div><div class="line">        var test=&#123;&quot;a&quot;:1,&quot;b&quot;:2&#125;;</div><div class="line">        //注意的是，setter方法必须是(set+变量首字母大写)格式</div><div class="line">        this.setName = function(newName)&#123;</div><div class="line">            name = newName  </div><div class="line">        &#125;</div><div class="line"></div><div class="line">        this.$get =function($http,$q)&#123;</div><div class="line">            return &#123;</div><div class="line">                getData : function()&#123;</div><div class="line">                    var d = $q.defer();</div><div class="line">                    $http.get(&quot;url&quot;)//读取数据的函数。</div><div class="line">                        .success(function(response) &#123;</div><div class="line">                            d.resolve(response);</div><div class="line">                        &#125;)</div><div class="line">                        .error(function()&#123;</div><div class="line">                            d.reject(&quot;error&quot;);</div><div class="line">                        &#125;);</div><div class="line">                    return d.promise;</div><div class="line">                &#125;,</div><div class="line">                &quot;lastName&quot;:name,</div><div class="line">                &quot;test&quot;:test</div><div class="line">            &#125;   </div><div class="line">        &#125;</div><div class="line"></div><div class="line">    &#125;);</div><div class="line">    app.controller(&apos;myCtrl&apos;, function($scope,myProvider) &#123;</div><div class="line">        alert(myProvider.lastName);</div><div class="line">        alert(myProvider.test.a)</div><div class="line">        myProvider.getData().then(function(data)&#123;</div><div class="line">            //alert(data)</div><div class="line">        &#125;,function(data)&#123;</div><div class="line">            //alert(data)</div><div class="line">        &#125;);</div><div class="line">    &#125;);</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line">//通过工厂模式创建自定义服务</div><div class="line">    app.factory(&apos;myFactory&apos;, function() &#123;</div><div class="line">        var service = &#123;&#125;;//定义一个Object对象&apos;</div><div class="line">        service.name = &quot;张三&quot;;</div><div class="line">        var age;//定义一个私有化的变量</div><div class="line">        //对私有属性写getter和setter方法</div><div class="line">        service.setAge = function(newAge)&#123;</div><div class="line">            age = newAge;</div><div class="line">        &#125;</div><div class="line">        service.getAge = function()&#123;</div><div class="line">            return age; </div><div class="line">        &#125;</div><div class="line">        return service;//返回这个Object对象</div><div class="line">    &#125;);</div><div class="line">//创建控制器</div><div class="line">    app.controller(&apos;myCtrl&apos;, function($scope, myFactory) &#123;</div><div class="line">        myFactory.setAge(20);</div><div class="line">        $scope.r =myFactory.getAge();</div><div class="line">        alert(myFactory.name);</div><div class="line">    &#125;);</div></pre></td></tr></table></figure>
<p>注：在自定义服务里可以注入内置服务（例$http等），但不能注入$scope作用域对象。</p>
<h4 id="3-service"><a href="#3-service" class="headerlink" title="3.service"></a>3.service</h4><p>通过service方式创建自定义服务，相当于new的一个对象：var s = new myService();，只要把属性和方法添加到this上才可以在controller里调用。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">app.service(&apos;myService&apos;,function () &#123;</div><div class="line">     此处为return出来的那个对象，对象的属性需要加上this，this[key]=val这种形式。</div><div class="line">     &#125;)</div></pre></td></tr></table></figure></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div></pre></td><td class="code"><pre><div class="line">app.service(&apos;myService&apos;, function($http,$q) &#123;</div><div class="line">        this.name = &quot;service&quot;;</div><div class="line">        this.myFunc = function (x) &#123;</div><div class="line">            return x.toString(16);//转16进制</div><div class="line">        &#125;</div><div class="line">        this.getData = function()&#123;</div><div class="line">            var d = $q.defer();</div><div class="line">            $http.get(&quot;ursl&quot;)//读取数据的函数。</div><div class="line">                .success(function(response) &#123;</div><div class="line">                d.resolve(response);</div><div class="line">            &#125;)</div><div class="line">                .error(function()&#123;</div><div class="line">                alert(0)</div><div class="line">                d.reject(&quot;error&quot;);</div><div class="line">            &#125;);</div><div class="line">            return d.promise;</div><div class="line">        &#125;</div><div class="line">    &#125;);</div><div class="line">    app.controller(&apos;myCtrl&apos;, function($scope, myService) &#123;</div><div class="line">        $scope.r = myService.myFunc(255);</div><div class="line">        myService.getData().then(function(data)&#123;</div><div class="line">            console.log(data);//正确时走这儿</div><div class="line">        &#125;,function(data)&#123;</div><div class="line">            alert(data)//错误时走这儿</div><div class="line">        &#125;);</div><div class="line">    &#125;);</div></pre></td></tr></table></figure>
<h4 id="4-value"><a href="#4-value" class="headerlink" title="4.value"></a>4.value</h4><p>以 key与value的形式来写value服务。这个值就是服务实例。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">app.value(&apos;my&apos;,&#123;</div><div class="line">          此处为return出来的对象</div><div class="line">     &#125;);</div></pre></td></tr></table></figure></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">有时我们需要在不同的组件之间共享一个变量，可以将这种情况视为一种服务： provider返回的总是变量的值。</div><div class="line">value方法提供了对这种情况的简化封装：</div><div class="line">angular.module(&quot;myModule&quot;,[])</div><div class="line">.value(&quot;myValueService&quot;,&quot;cx129800123&quot;);</div><div class="line"></div><div class="line">INSIDE：AngularJS会将value方法封装为provider，上面的示例 等同于：</div><div class="line">angular.module(&quot;myModule&quot;,[])</div><div class="line">.provider(&quot;myService&quot;,function()&#123;</div><div class="line">this.$get = function()&#123;</div><div class="line">return &quot;cx129800123&quot;;</div><div class="line">&#125;;</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<h4 id="5-constant"><a href="#5-constant" class="headerlink" title="5.constant"></a>5.constant</h4><p>用法同value，也是以 key ,value的形式，但是可以配置（不是真正意义上的配置），即可以增加属性。配置时不需要再名字后面加Provider。这个常量就是服务实例。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">//配置constant</div><div class="line">   app.config(function (my) &#123;</div><div class="line">       my.currency = &apos;￡&apos;;//在当前属性上增加一个属性</div><div class="line">   &#125;);</div><div class="line">   app.controller(&apos;computed&apos;,function ($scope,my) &#123;</div><div class="line">       //my就是return这个对象,这样就可以使用return出来对象的属性了</div><div class="line">   &#125;)</div></pre></td></tr></table></figure></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">有时我们需要在不同的组件之间共享一个常量，可以将这种情况视为一种服务： provider返回的总是常量的值。constant方法提供了对这种情况的简化封装：</div><div class="line">angular.module(&quot;myModule&quot;,[])</div><div class="line">.constant(&quot;myConstantService&quot;,&quot;Great Wall&quot;);</div><div class="line">和value方法不同，AngularJS并没有将constant方法封装成一个provider，而仅仅是在内部登记这个值。这使得常量在AngularJS的启动配置阶段就可以使用（创建任何 服务之前）：你可以将常量注入到模块的config()方法中。</div></pre></td></tr></table></figure>
<h4 id="在过滤器中注入自定义服务"><a href="#在过滤器中注入自定义服务" class="headerlink" title="在过滤器中注入自定义服务"></a>在过滤器中注入自定义服务</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div></pre></td><td class="code"><pre><div class="line">&lt;body&gt;</div><div class="line">&lt;div ng-app=&quot;myApp&quot;&gt;</div><div class="line">    在过滤器中使用服务:</div><div class="line">    &lt;h1&gt;&#123;&#123;255 | myFormat&#125;&#125;&lt;/h1&gt;</div><div class="line">    //若使用过滤器时需要传入参数，用：隔开，多个参数用多个：隔开。</div><div class="line">&lt;/div&gt;</div><div class="line"></div><div class="line">&lt;script&gt;</div><div class="line">    var app = angular.module(&apos;myApp&apos;, []);</div><div class="line">    app.service(&apos;hexafy&apos;, function() &#123;</div><div class="line">        this.myFunc = function (x) &#123;</div><div class="line">            return x.toString(16);</div><div class="line">        &#125;</div><div class="line">    &#125;);</div><div class="line">    app.filter(&apos;myFormat&apos;,[&apos;hexafy&apos;, function(hexafy) &#123;</div><div class="line">        return function(x) &#123;</div><div class="line">            return hexafy.myFunc(x);</div><div class="line">        &#125;;</div><div class="line">    &#125;]);</div><div class="line">&lt;/script&gt;</div><div class="line">&lt;/body&gt;</div></pre></td></tr></table></figure>
      
    </div>
    
    <div class="article-info article-info-index">
      
      

      
    <div class="article-tag tagcloud">
        <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/angular-服务/">angular 服务</a></li></ul>
    </div>

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>









  
    <article id="post-raps" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2016/05/30/raps/" class="article-date">
      <time datetime="2016-05-30T12:50:07.000Z" itemprop="datePublished">2016-05-30</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/05/30/raps/">rap集合</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
        <h2 id="我是自动播放的，不想听点我，别找不着我"><a href="#我是自动播放的，不想听点我，别找不着我" class="headerlink" title="我是自动播放的，不想听点我，别找不着我"></a>我是自动播放的，不想听点我，别找不着我</h2><iframe style="margin:0 auto; display:block;" frameborder="no" border="0" marginwidth="0" marginheight="0" width="530" height="86" src="//music.163.com/outchain/player?type=2&id=25713016&auto=1&height=66"></iframe><br><strong>1.电台情歌-fatkan</strong><br><iframe frameborder="no" border="0" marginwidth="0" marginheight="0" width="530" height="86" src="//music.163.com/outchain/player?type=2&id=34078039&auto=0&height=66"></iframe><br><strong>2.正皇旗-兄弟情义</strong><br><iframe frameborder="no" border="0" marginwidth="0" marginheight="0" width="530" height="86" src="//music.163.com/outchain/player?type=2&id=29816209&auto=0&height=66"></iframe><br><strong>3.正皇旗-泛黄的日记</strong><br><iframe frameborder="no" border="0" marginwidth="0" marginheight="0" width="530" height="86" src="//music.163.com/outchain/player?type=2&id=29816206&auto=0&height=66"></iframe><br><strong>黑暗中的莲花-爽子</strong><br><iframe frameborder="no" border="0" marginwidth="0" marginheight="0" width="530" height="86" src="//music.163.com/outchain/player?type=2&id=419077145&auto=0&height=66"></iframe><br><strong>别趴下 - 爽子</strong><br><iframe frameborder="no" border="0" marginwidth="0" marginheight="0" width="530" height="86" src="//music.163.com/outchain/player?type=2&id=442518697&auto=0&height=66"></iframe><br><strong>自由的飞 - 爽子与瓷乐队</strong><br><iframe frameborder="no" border="0" marginwidth="0" marginheight="0" width="530" height="86" src="//music.163.com/outchain/player?type=2&id=381200&auto=0&height=66"></iframe><br><strong>我知道 - 苏德牧仁</strong><br><iframe frameborder="no" border="0" marginwidth="0" marginheight="0" width="530" height="86" src="//music.163.com/outchain/player?type=2&id=27908045&auto=0&height=66"></iframe><br><strong>爱你不是为了和你去如家 - 新街口</strong><br><iframe frameborder="no" border="0" marginwidth="0" marginheight="0" width="530" height="86" src="//music.163.com/outchain/player?type=2&id=27533115&auto=0&height=66"></iframe><br><strong>谁没年轻过 - 新街口</strong><br><iframe frameborder="no" border="0" marginwidth="0" marginheight="0" width="530" height="86" src="//music.163.com/outchain/player?type=2&id=31140262&auto=0&height=66"></iframe>
      
    </div>
    
    <div class="article-info article-info-index">
      
      

      
    <div class="article-tag tagcloud">
        <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/rap/">rap</a></li></ul>
    </div>

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>









  
    <article id="post-webpackstudy1" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2016/05/26/webpackstudy1/" class="article-date">
      <time datetime="2016-05-26T05:28:34.000Z" itemprop="datePublished">2016-05-26</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/05/26/webpackstudy1/">Webpack学习(一)</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
        <h4 id="什么是Webpack？"><a href="#什么是Webpack？" class="headerlink" title="什么是Webpack？"></a>什么是Webpack？</h4><p>按照官方文档的解释，Webpack就是个模块打包工具，将模块及其依赖打包生成静态资源。在Webpack的机制里，所有的资源都是模块(js,css,图片等)，而且可以通过代码分隔(Code Splitting)的方法异步加载，实现性能上的优化。Webpack是当今最火的前端构建工具之一，配合Gulp使用可以搭建出非常强大的构建工具。(注：gulp里可以引入webpack配置，但是webpack里不能引入gulp)</p>
<h4 id="Chunk的概念"><a href="#Chunk的概念" class="headerlink" title="Chunk的概念"></a>Chunk的概念</h4><p>chunk是使用Webpack过程中最重要的几个概念之一。在Webpack打包机制中，编译的文件包括entry（入口，可以是一个或者多个资源合并而成，由html通过script标签引入）和chunk（被entry所依赖的额外的代码块，同样可以包含一个或者多个文件）。从页面加速的角度来讲，我们应该尽可能将所有的js打包到一个bundle.js之中，但是总会有一些功能是使用过程中才会用到的。出于性能优化的需要，对于这部分资源我们可以做成按需加载，通过require.ensure方法实现:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">require.ensure([], function(require) &#123;</div><div class="line">        var dialog = require(&apos;./components/dialog&apos;);</div><div class="line">        // todo ...</div><div class="line">    &#125;);</div></pre></td></tr></table></figure></p>
<p>而固定的公用代码则独立打包到trunk之中。在Webpack的配置中，我们可以通过CommonsChunkPlugin插件对指定的chunks进行公共模块的提取。我们指定好生成文件的名字，以及想抽取哪些入口js文件的公共代码，webpack就会自动帮我们合并好。:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">var chunks = Object.keys(entries);</div><div class="line">plugins: [</div><div class="line">    new  webpack.optimize.CommonsChunkPlugin(&#123;</div><div class="line">        name: &apos;vendors&apos;, // 将公共模块提取，生成名为`vendors`的chunk</div><div class="line">        chunks: chunks,</div><div class="line">        minChunks: chunks.length // 提取所有entry共同依赖的模块</div><div class="line">    &#125;)</div><div class="line">]</div></pre></td></tr></table></figure></p>
<h4 id="Loader"><a href="#Loader" class="headerlink" title="Loader"></a>Loader</h4><p>Loader就是资源转换器。由于在webpack里，所有的资源都是模块，不同资源都最终转化成js去处理。针对不同形式的资源采用不同的Loader去编译，这就是Loader的意义。Loader在使用之前必须先通过npm安装，然后在config里面通过module配置才能使用。举个例子:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">module: &#123;</div><div class="line">    loaders: [&#123;</div><div class="line">        test: /\.(png|jpg|jpeg|gif)$/,</div><div class="line">        loader: &apos;url?limit=10000&amp;name=images/[name].[ext]&apos;</div><div class="line">    &#125;]</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>上述配置中，test的作用是正则匹配，匹配到png或jpg或gif结尾的文件就采用url-loader来做对应的编译。由于loader都是默认以-loader后缀结尾的，所以可以省略后缀”-loader”，直接写成url。问号后面是参数，表示10000B以下的图片直接压缩成base64编码，超过10000B的图片输出到”images/文件名.拓展名”。上面的配置也可以这样写：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">loaders: [&#123;</div><div class="line">    test: /\.(png|jpg|jpeg|gif)$/,</div><div class="line">    loader: &apos;url-loader&apos;,</div><div class="line">    query:&#123;</div><div class="line">        limit:&apos;10000&apos;,</div><div class="line">        name:&apos;images/[name].[ext]&apos;</div><div class="line">    &#125;</div><div class="line">&#125;]</div></pre></td></tr></table></figure></p>
<p>配置中常用的loader：</p>
<ul>
<li>处理样式，转成css，如：less-loader, sass-loader</li>
<li>图片处理，如: url-loader, file-loader。两个都必须用上。否则超过大小限制的图片无法生成到目标文件夹中</li>
<li>处理js，将es6或更高级的代码转成es5的代码。如： babel-loader，babel-preset-es2015，babel-preset-react</li>
<li>将js模块暴露到全局，使用expose-loader<h4 id="Plugin"><a href="#Plugin" class="headerlink" title="Plugin"></a>Plugin</h4>插件的引入和loader差不多，只是插件是以对象的形式引入。像静态资源路径的替换这种功能就能通过插件来处理。比如公用模块打包到chunk的插件：<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">var chunks = Object.keys(entries);</div><div class="line">plugins: [</div><div class="line">    new  webpack.optimize.CommonsChunkPlugin(&#123;</div><div class="line">        name: &apos;vendors&apos;, // 将公共模块提取，生成名为`vendors`的chunk</div><div class="line">        chunks: chunks,</div><div class="line">        minChunks: chunks.length // 提取所有entry共同依赖的模块</div><div class="line">    &#125;)</div><div class="line">]</div></pre></td></tr></table></figure>
</li>
</ul>
<p>配置中常用的plugin：</p>
<ul>
<li>代码热替换, HotModuleReplacementPlugin</li>
<li>生成html文件，HtmlWebpackPlugin</li>
<li>将css成生文件，而非内联，ExtractTextPlugin</li>
<li>报错但不退出webpack进程，NoErrorsPlugin</li>
<li>代码丑化，UglifyJsPlugin，开发过程中不建议打开</li>
<li>多个 html共用一个js文件(chunk)，可用CommonsChunkPlugin</li>
<li>清理文件夹，Clean</li>
<li>调用模块的别名ProvidePlugin，例如想在js中用””，如果通过webpack加载，需要将”，如果通过webpack加载，需要将与jQuery对应起来<h4 id="搭建自己的构建集成环境"><a href="#搭建自己的构建集成环境" class="headerlink" title="搭建自己的构建集成环境"></a>搭建自己的构建集成环境</h4>知道了上面几个概念，基本就可以进入动手搭建脚手架的阶段了。<br>一、项目目录<br>假设我们要搭建的demo项目的目录结构是这样的：<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">- webapp/               # webapp根目录</div><div class="line">  + node_modules        # node_modules</div><div class="line">  - src/                # 开发目录</div><div class="line">    - index             # index模块</div><div class="line">      + images/         # webapp图片资源目录</div><div class="line">        index.html      # 模板   </div><div class="line">        index.js        # 模块entry</div><div class="line">        style.less      # 样式表</div><div class="line">  webpack.config.js     # webpack配置文件</div><div class="line">  package.json          # 项目依赖文件</div><div class="line">  config.js             # 项目配置文件</div><div class="line">  README.md             # 项目说明</div></pre></td></tr></table></figure>
</li>
</ul>
<p>二、 配置过程<br>项目目录确定之后，下面开始来着手配置webpack。<br>三、 安装webpack<br>首先，全局安装webpack，先安装nodejs，安装完毕自带了包管理工具NPM，npm install webpack -g;<br>四、 安装依赖<br>这一步也非常简单，根据项目需要用到的依赖 npm i xxx–save-dev，也可以在配置webpack.config.js的过程中根据需要安装。<br>五、 配置webpack<br>这一步基本是webpack配置的全部内容。由于webpack默认读取根目录下的webpack.config.js文件，所以我们需要在根目录手动创建。<br>看看我们的webpack.config.js配置文件：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">1、首先，引入我们需要用到的npm模块</div><div class="line">var path = require(&apos;path&apos;); //node 原生path模块</div><div class="line">var webpack = require(&apos;webpack&apos;); // webpack</div><div class="line">var glob = require(&apos;glob&apos;); // glob模块，用于读取webpack入口目录文件</div><div class="line">var ExtractTextPlugin = require(&apos;extract-text-webpack-plugin&apos;); //webpack插件</div><div class="line">var HtmlWebpackPlugin = require(&apos;html-webpack-plugin&apos;); //webpack插件</div><div class="line">var OpenBrowserPlugin = require(&apos;open-browser-webpack-plugin&apos;);//webpack插件</div><div class="line">var CleanPlugin = require(&apos;clean-webpack-plugin&apos;)//webpack插件，用于清除目录文件</div><div class="line">var CommonsChunkPlugin = webpack.optimize.CommonsChunkPlugin;//处理trunk</div></pre></td></tr></table></figure></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div></pre></td><td class="code"><pre><div class="line">2、读取入口文件</div><div class="line">按照之前约定的项目目录，我们的webpack入口文件所在目录为src/index/index.js。所以，先要用glob读取模块入口。在这里，我们把读取目录定义为一个函数：</div><div class="line">var getEntry = function() &#123;</div><div class="line">    var entry = &#123;&#125;;</div><div class="line">    //读取开发目录,并进行路径裁剪</div><div class="line">    glob.sync(&apos;./src/**/*.js&apos;)</div><div class="line">        .forEach(function(name) &#123;</div><div class="line">            var start = name.indexOf(&apos;src/&apos;) + 4,</div><div class="line">                end = name.length - 3;</div><div class="line">            var n = name.slice(start, end);</div><div class="line">            n = n.slice(0, n.lastIndexOf(&apos;/&apos;));</div><div class="line">            //保存各个组件的入口</div><div class="line">            entry[n] = name;</div><div class="line">        &#125;);</div><div class="line">    return entry;</div><div class="line">&#125;;</div><div class="line">然后将配置封装在module.exports，定义入口entry字段，entry可以为字符串、对象或者数组，对应单页面和多页面应用：</div><div class="line">module.exports = &#123;</div><div class="line">    entry: getEntry(),</div><div class="line">    ...</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">3、定义资源输出</div><div class="line">资源打包输出的配置在output内，主要包括path、filename、chunkFilename以及publicPath。path是资源输出路径，filename是资源命名规则，chunkFilename是公共js打包后输出的命名，publicPath是静态资源的公共路径，比如线上CDN地址等，开发环境可以不设置，这样CSS中的相对路径就不会包括publicPath。在output输出的时候可以根据开发环境或者生产环境选择不同的文件命名方法，因为一般来说，线上的资源都是要经过压缩的。比如我们定义一个”prod”变量判断当前编译环境:</div><div class="line">output: &#123;</div><div class="line">    path: path.resolve(__dirname, prod ? &quot;./dist&quot; : &quot;./build&quot;),</div><div class="line">    filename: prod ? &quot;js/[name].min.js&quot; : &quot;js/[name].js&quot;,</div><div class="line">    chunkFilename: &apos;js/[name].chunk.js&apos;,</div><div class="line">    publicPath: prod ? &quot;http:cdn.mydomain.com&quot; : &quot;&quot;</div><div class="line">&#125;,</div><div class="line">[name]的值是根据入口entry显示的文件名。比如index.js这个入口文件，对应的output的[name]值就应该是“index”，当然，我们还可以根据需要使用[hash]、[id]这样的值。</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line">4、定义resolve</div><div class="line">为了方便开发，我们可以定义自己的别名，以便很快捷地引用不同的模块，别名(alias)的定义是在resolve对象之中。比如，</div><div class="line">resolve: &#123;</div><div class="line">    alias:&#123;</div><div class="line">        xyz: &quot;/absolute/path/to/file.js&quot; </div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line">那么，当我们在代码中require(‘xyz’)的时候，实际上我们是引入’/absolute/path/to/file.js’这个文件。还可以配置extensions对象，使得开发过程中文件资源的处理可以忽略后缀。在我们的demo中，是这样配置的:</div><div class="line">resolve: &#123;</div><div class="line">    //配置项,设置忽略js后缀</div><div class="line">    extensions: [&apos;&apos;, &apos;.js&apos;, &apos;.less&apos;, &apos;.css&apos;, &apos;.png&apos;, &apos;.jpg&apos;],</div><div class="line">    root: &apos;./src&apos;,</div><div class="line">    // 模块别名</div><div class="line">    alias: &#123;&#125;</div><div class="line">&#125;,</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line">5、配置loaders</div><div class="line">loader的配置是在module中定义。根据文章开头部分的介绍，loaders就是定义一个个资源处理器，demo项目主要用到下面几个loader：</div><div class="line">module: &#123;</div><div class="line">    loaders: [&#123;</div><div class="line">        test: /\.(png|jpg|jpeg|gif)$/,</div><div class="line">        loader: &apos;url?limit=10000&amp;name=images/[name].[ext]&apos;</div><div class="line">    &#125;, &#123;</div><div class="line">        test: /\.less$/,</div><div class="line">        loader: ExtractTextPlugin.extract(&apos;style&apos;, &apos;css!less&apos;)</div><div class="line">    &#125;, &#123;</div><div class="line">        test: /\.js[x]?$/,</div><div class="line">        exclude: /node_modules/,</div><div class="line">        loader: &apos;babel?presets[]=es2015&amp;presets[]=react&apos;</div><div class="line">    &#125;, &#123;</div><div class="line">        test: /\.html$/,</div><div class="line">        loader: &apos;html?attrs=img:src img:srcset&apos;</div><div class="line">    &#125;]</div><div class="line">&#125;,</div><div class="line"></div><div class="line">ExtractTextPlugin.extract是用来提取出单独的CSS文件的插件，如果不使用这个插件处理样式文件，CSS会内联在页面中，不利于做样式表维护;而babel则是用来做es6转换。</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div></pre></td><td class="code"><pre><div class="line">6、定义Plugins</div><div class="line"></div><div class="line">plugins: [</div><div class="line">    new HtmlWebpackPlugin(&#123;</div><div class="line">        filename: &apos;index.html&apos;,</div><div class="line">        template: &apos;./src/index/index.html&apos;</div><div class="line">    &#125;),</div><div class="line">    new CleanPlugin([&apos;dist&apos;, &apos;build&apos;]),</div><div class="line">    // 启动热替换</div><div class="line">    new webpack.HotModuleReplacementPlugin(),</div><div class="line">    new ExtractTextPlugin(&apos;[name].css&apos;, &#123;</div><div class="line">        allChunks: true</div><div class="line">    &#125;),</div><div class="line">    new webpack.NoErrorsPlugin(),</div><div class="line">    new OpenBrowserPlugin(&#123;</div><div class="line">        url: &apos;http://localhost:8080&apos;</div><div class="line">    &#125;),</div><div class="line">    /* 公共库 */</div><div class="line">    new CommonsChunkPlugin(&#123;</div><div class="line">        name: &apos;vendors&apos;,</div><div class="line">        minChunks: Infinity</div><div class="line">    &#125;),</div><div class="line">]</div><div class="line">HtmlWebpackPlugin插件用来自动在页面中注入chunk；HotModuleReplacementPlugin插件是用来做热替换的，每次开发环境下的资源发生变更之后都会自动重新打包输出，不需要重新构建；配置OpenBrowserPlugin插件可以在构建完成之后自动打开浏览器的”localhost:8080”这个路径；CommonsChunkPlugin插件定义chunk名字。</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line">7、定义webpack-dev-server</div><div class="line">webpack-dev-server是webpack提供的静态资源服务器，它的存在使得开发可以脱离代理服务器工作。开发调试静态资源不再需要搭建本地服务器，这魔法简直是解救万民于水火呀！webpack-dev-server有多种配置形式，这里采用的是写死在config的方式，这种方式的特点是方便开发，缺点是不灵活。</div><div class="line">devServer = &#123;</div><div class="line">    port: 8080,</div><div class="line">    contentBase: &apos;./build&apos;, //定义静态服务器的基路径</div><div class="line">    hot: true,</div><div class="line">    historyApiFallback: true,</div><div class="line">    publicPath: &quot;&quot;,</div><div class="line">    stats: &#123;</div><div class="line">        colors: true</div><div class="line">    &#125;,</div><div class="line">    plugins: [</div><div class="line">    new webpack.HotModuleReplacementPlugin()</div><div class="line">    ]</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div></pre></td><td class="code"><pre><div class="line">8、编译环境判断</div><div class="line">在“步骤3”我们需要根据当前的编译环境来选择不同的资源输出方式。编译环境的判断可以通过定义node的script来设置环境变量。在我们项目根目录的package.json文件中，定义：</div><div class="line">&quot;scripts&quot;: &#123;</div><div class="line">    &quot;dev&quot;: &quot;webpack-dev-server&quot;,</div><div class="line">    &quot;build&quot;: &quot;webpack&quot;,</div><div class="line">    &quot;deploy&quot;: &quot;set NODE_ENV=production&amp;&amp;webpack -p --progress --colors&quot;</div><div class="line">  &#125;,</div><div class="line">这样的话，终端执行”npm run dev” 就相当于执行 “webpack-dev-server”。如果执行”npm run deploy”，那就是编译生产环境，node就会设置环境变量”NODE_ENV”为”production”。然后在webpack的配置文件中，通过”process.en.NODE_ENV”就可以读取到”production”这个值。所以在配置的开头，我们这样定义一个局部变量:</div><div class="line">var prod = process.env.NODE_ENV === &apos;production&apos; ? true : false;</div><div class="line">之后在配置文件的最后，根据当前的编译环境，如果是生产环境就配置引用压缩丑化插件”UglifyJsPlugin”，如果是开发环境就配置webpack-dev-server：</div><div class="line">// 判断开发环境还是生产环境,添加uglify等插件</div><div class="line">if (process.env.NODE_ENV === &apos;production&apos;) &#123;</div><div class="line">    module.exports.plugins = (module.exports.plugins || [])</div><div class="line">        .concat([</div><div class="line">            new webpack.DefinePlugin(&#123;</div><div class="line">                __DEV__: JSON.stringify(JSON.parse(process.env.DEBUG || &apos;false&apos;))</div><div class="line">            &#125;),</div><div class="line">            new webpack.optimize.UglifyJsPlugin(&#123;</div><div class="line">                compress: &#123;</div><div class="line">                    warnings: false</div><div class="line">                &#125;</div><div class="line">            &#125;),</div><div class="line">            new webpack.optimize.OccurenceOrderPlugin(),</div><div class="line">        ]);</div><div class="line">&#125; else &#123;</div><div class="line">    module.exports.devtool = &apos;source-map&apos;;</div><div class="line">    module.exports.devServer = &#123;</div><div class="line">        port: 8080,</div><div class="line">        contentBase: &apos;./build&apos;,</div><div class="line">        hot: true,</div><div class="line">        historyApiFallback: true,</div><div class="line">        publicPath: &quot;&quot;,</div><div class="line">        stats: &#123;</div><div class="line">            colors: true</div><div class="line">        &#125;,</div><div class="line">        plugins: [</div><div class="line">        new webpack.HotModuleReplacementPlugin()</div><div class="line">        ]</div><div class="line">    &#125;;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h4 id="模块代码"><a href="#模块代码" class="headerlink" title="模块代码"></a>模块代码</h4><p>至此，已经完成了一个基本的webpack配置，接下来就是使用webpack构建代码了。我们定义的index模块的代码入口是index.js，在Index.js内通过require()方式引入不同的资源用于打包：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">require(&apos;./style.less&apos;); //引入.less预处理文件</div><div class="line">require(&apos;./index.html&apos;); //引入同级目录的index.html文件</div></pre></td></tr></table></figure></p>
<p>然后，执行”npm run dev”即可查看本地环境的静态资源效果。</p>

      
    </div>
    
    <div class="article-info article-info-index">
      
      

      
    <div class="article-tag tagcloud">
        <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/前端工程-构建工具-前端开发/">前端工程 构建工具 前端开发</a></li></ul>
    </div>

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>









  
    <article id="post-defined-filter" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2016/05/26/defined-filter/" class="article-date">
      <time datetime="2016-05-26T02:06:02.000Z" itemprop="datePublished">2016-05-26</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/05/26/defined-filter/">简述angular自定义过滤器在页面和控制器中的使用</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
        <p>AngularJS另一个特点就是提供了过滤器，可以通过操作UNIX下管道的方式，操作数据结果。<br>通过使用管道，可以便于双向的数据绑定中视图的展现。<br>过滤器在处理过程中，将数据变成新的格式，而且可以使用管道这种链式风格，还能接受附加的参数。</p>
<h5 id="首先设置自定义过滤器"><a href="#首先设置自定义过滤器" class="headerlink" title="首先设置自定义过滤器"></a>首先设置自定义过滤器</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">app..module(&apos;myApp&apos;)</div><div class="line">    　　　　　　　.filter(&apos;filterName&apos;,function()&#123;</div><div class="line">    　　　　　　　　　return function(要过滤的对象,参数1,参数2,...)&#123;</div><div class="line">                            // ...做一些事情</div><div class="line">    　　　　　　　　　　　return Obj; //这里返回的是过滤后的对象</div><div class="line">    　　　　　　　　　&#125;</div><div class="line">    　　　　　　　&#125;);</div></pre></td></tr></table></figure>
<h5 id="在页面中使用："><a href="#在页面中使用：" class="headerlink" title="在页面中使用："></a>在页面中使用：</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">&#123;&#123;obj | filterName&#125;&#125; ====&gt; obj是要过滤的对象</div></pre></td></tr></table></figure>
<p>\｜这里的竖线是一种管道功能，如果对linux比较熟悉的话，这块的｜根linux的管道功能，基本是一样的</p>
<h5 id="在控制器中使用："><a href="#在控制器中使用：" class="headerlink" title="在控制器中使用："></a>在控制器中使用：</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">//首先要注入$filter,使用的时候</div><div class="line">$filter(&quot;filterName&quot;)(要过滤的对象,参数1,参数2,...);</div></pre></td></tr></table></figure>
<p>filter过滤器主要用来过滤一个数组数据并返回一个包含子数组数据的新数组。<br>比如，在客户端搜索时，我们可以快速的从数组中过滤出我们想要的结果。<br>这个filter方法接收一个string，object，或者function参数用来选择/移除数组元素。<br>我们也可以在JavaScript中使用$filter服务来调用过滤器，还拿字符串大写来举例:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">app.controller(&apos;DemoController&apos;, [&apos;$scope&apos;, &apos;$filter&apos;, </div><div class="line"> function($scope, $filter) &#123;</div><div class="line">  </div><div class="line">  $scope.name = $filter(&apos;lowercase&apos;)(&apos;Ari&apos;);</div><div class="line">&#125;]);</div></pre></td></tr></table></figure></p>
<p>如何传递参数到filter呢？只需要把参数放在filter之后，中间加个冒号（如果有多个参数要传递，在每个参数后加上冒号）比如，数字过滤器可以帮助我们限制数字的位数，如果想显示两位小数，加上number:2就可以了<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">&#123;&#123; 123.456789 | number:2 &#125;&#125;</div></pre></td></tr></table></figure></p>
<p>注： 意：| lowercase |uppercase管道命令可以有多个<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">&#123;&#123; name |uppercase | lowercase  &#125;&#125;</div></pre></td></tr></table></figure></p>

      
    </div>
    
    <div class="article-info article-info-index">
      
      

      
    <div class="article-tag tagcloud">
        <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/angular-filter/">angular filter</a></li></ul>
    </div>

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>









  
    <article id="post-angular-guide8-9章" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2016/05/13/angular-guide8-9章/" class="article-date">
      <time datetime="2016-05-13T13:09:01.000Z" itemprop="datePublished">2016-05-13</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/05/13/angular-guide8-9章/">Angular权威指南学习（第8到9章）指令</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
        <h4 id="指令"><a href="#指令" class="headerlink" title="指令"></a>指令</h4><p>指令本质上就是AngularJS扩展具有自定义功能的HTML元素的途径。例如，我们可以创建一个自定义元素，它实现了<code>&lt;video&gt;</code>标签的功能并且能在所有浏览器中工作：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">&lt;my-better-video my-href=&quot;/goofy-video.mp4&quot;&gt;</div><div class="line">Caneventaketext&lt;/my-better-video&gt;</div></pre></td></tr></table></figure>
<p>内置指令是打包在AngularJS内部的指令。所有内置指令的命名空间都使用ng作为前缀。为了防止命名空间冲突，不要在自定义指令前加ng前缀。</p>
<ul>
<li><p>第一个自定义指令<br>通过AngularJS模块API中的.directive()方法，我们可以通过传入一个字符串和一个函数来注册一个新指令。其中字符串是这个指令的名字，指令名应该是驼峰命名风格的，函数应该返回一个对象</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">&lt;my-directive&gt;&lt;/my-directive&gt;</div><div class="line">angular.module(&apos;myApp&apos;,[])</div><div class="line">.directive(&apos;myDirective&apos;, function() &#123;</div><div class="line">return &#123;</div><div class="line">restrict: &apos;E&apos;,</div><div class="line">replace: true,//生成的代码中不含&lt;my-directive&gt;&lt;/my-directive&gt;</div><div class="line">template: &apos;&lt;a href=&quot;http://webywx.com&quot;&gt;</div><div class="line">Click me to go to webywx&lt;/a&gt;&apos;</div><div class="line">&#125;;</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<p>注：在我们的例子中，在HTML里使用my-directive声明指令，因此指令定义必须以myDirective为名字（驼峰命名法）。</p>
</li>
</ul>
<p>####声明指令本质上是在HTML中通过元素、属性、类或注释来添加功能。<br>   为了让AngularJS能够调用我们的指令，需要修改指令定义中的restrict设置。这个设置告诉AngularJS在编译HTML时用哪种声明格式来匹配指令定义。我们可以指定一个或多个格式。创建的指令中可以指定以元素（E）、属性（A）、类（C）或注释（M）的格式来调用指令，例：restrict: ‘EAC’。<br>   无论有多少种方式可以声明指令，我们坚持使用属性方式，因为它有比较好的跨浏览器兼容性：<br>   <figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">&lt;div my-directive&gt;&lt;/div&gt;</div></pre></td></tr></table></figure></p>
<p>   声明指令时既可以使用表达式，也可以不使用表达式。下面是几种合法的表达式声明：<br>   <figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">&lt;my-directive=&quot;someExpression&quot;&gt;</div><div class="line">&lt;/my-directive&gt;</div><div class="line">&lt;div my-directive=&quot;someExpression&quot;&gt;</div><div class="line">&lt;/div&gt;</div><div class="line">&lt;div class=&quot;my-directive:someExpression&quot;&gt;</div><div class="line">&lt;/div&gt;</div><div class="line">&lt;!-- directive: my-directive someExpression --&gt;</div></pre></td></tr></table></figure></p>
<p>   为了更加明确我们的意图，将restrict设置为字母A（代表attribute）：<br>   restrict: ‘A<br>   遵循这个约定的同时，也要注意每个浏览器的内置样式，以便决定指令模板在HTML中是嵌套在声明元素内，还是替换声明元素。<br>   值得注意的一个例外是，扩展内置HTML标签，例如用AngularJS重载<code>&lt;a&gt;</code>、<code>&lt;form&gt;</code>和<code>&lt;input&gt;</code>。这些场景不会导致浏览器的兼容性问题，因为它们本身就是浏览器所支持的标签。好的经验法则就是始终用属性来声明指令，这样会给以后带来方便。<br>   注意，所有以ng前缀开头作为命名空间的指令都是AngularJS提供的内置指令，因此不要把你自己开发的指令以这个前缀命名。</p>
<ol>
<li><p>ng-disabled<br>使用ng-disabled可以把disabled属性绑定到以下表单输入字段上：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"> &lt;input&gt; （text、 checkbox、 radio、 number、 url, email、 submit）；</div><div class="line"> &lt;textarea&gt;；</div><div class="line"> &lt;select&gt;；</div><div class="line"> &lt;button&gt;。</div></pre></td></tr></table></figure>
<p>当写普通的HTML输入字段时，如果在元素标签上出现了disabled属性就会禁用这个输入字段。通过ng-disabled可以对是否出现属性进行绑定。例如，在下面的例子中按钮会一直禁用， 直到用户在文本字段中输入内容：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">&lt;input type=&quot;text&quot; ng-model=&quot;someProperty&quot; placeholder=&quot;TypetoEnable&quot;&gt;</div><div class="line">&lt;button ng-model=&quot;button&quot; ng-disabled=&quot;!someProperty&quot;&gt;AButton&lt;/button&gt;</div></pre></td></tr></table></figure>
</li>
<li><p>ng-readonly<br>同其他布尔属性一样， HTML定义只会检查readonly属性是否出现，而不是它的实际值。<br>通过ng-readonly可以将某个返回真或假的表达式同是否出现readonly属性进行绑定：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">Type here to make sibling readonly:</div><div class="line">&lt;input type=&quot;text&quot; ng-model=&quot;someProperty&quot;&gt;&lt;br/&gt;</div><div class="line">&lt;input type=&quot;text&quot;</div><div class="line">ng-readonly=&quot;someProperty&quot;</div><div class="line">value=&quot;Some text here&quot;/&gt;</div></pre></td></tr></table></figure>
</li>
<li><p>ng-checked</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">默认情况下会把复选框勾选：</div><div class="line">&lt;label&gt;someProperty = &#123;&#123;someProperty&#125;&#125;&lt;/label&gt;</div><div class="line">&lt;input type=&quot;checkbox&quot;</div><div class="line">ng-checked=&quot;someProperty&quot;</div><div class="line">ng-init=&quot;someProperty = true&quot;</div><div class="line">ng-model=&quot;someProperty&quot;&gt;</div></pre></td></tr></table></figure>
</li>
<li><p>ng-selected<br>ng-selected可以对是否出现option标签的selected属性进行绑定：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">&lt;label&gt;Select Two Fish:&lt;/label&gt;</div><div class="line">&lt;input type=&quot;checkbox&quot;</div><div class="line">ng-model=&quot;isTwoFish&quot;&gt;&lt;br/&gt;</div><div class="line">&lt;select&gt;</div><div class="line">&lt;option&gt;One Fish&lt;/option&gt;</div><div class="line">&lt;option ng-selected=&quot;isTwoFish&quot;&gt;Two Fish&lt;/option&gt;</div><div class="line">&lt;/select&gt;</div></pre></td></tr></table></figure>
</li>
<li><p>ng-href<br>当使用当前作用域中的属性动态创建URL时，应该用ng-href代替href（用href会404）</p>
</li>
<li>ng-src<br>AngularJS会告诉浏览器在ng-src对应的表达式生效之前不要加载图像(用src会找不到图片)</li>
<li><p>ng-app<br>任何具有ng-app属性的DOM元素将被标记为$rootScope的起始点。<br>$rootScope是作用域链的起始点，任何嵌套在ng-app内的指令都会继承它。<br>在JavaScript代码中通过run方法来访问$rootScope。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line">&lt;html ng-app=&quot;myApp&quot;&gt;</div><div class="line">&lt;body&gt;</div><div class="line">&#123;&#123; someProperty &#125;&#125;</div><div class="line">&lt;button ng-click=&quot;someAction()&quot;&gt;&lt;/button&gt;</div><div class="line">&lt;/body&gt;</div><div class="line">&lt;/html&gt;</div><div class="line">angular.module(&apos;myApp&apos;, [])</div><div class="line">.run(function($rootScope) &#123;</div><div class="line">$rootScope.someProperty = &apos;hello computer&apos;;</div><div class="line">$rootScope.someAction = function() &#123;</div><div class="line">$rootScope.someProperty = &apos;hello human&apos;;</div><div class="line">&#125;;</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<p>这里为了演示方便，像使用全局作用域一样使用$rootScope，实际生产中不建议这样做。</p>
</li>
<li>ng-controller<br>内置指令ng-controller的作用是为嵌套在其中的指令创建一个子作用域，避免将所有操作和模型都定义在$rootScope上。用这个指令可以在一个DOM元素上放置控制器。</li>
<li>ng-include<br>使用ng-include可以加载、编译并包含外部HTML片段到当前的应用中。模板的URL被限制<br>在与应用文档相同的域和协议下，可以通过白名单或包装成被信任的值来突破限制。更进一步，<br>需要考虑跨域资源共享（Cross-Origin Resource Sharing， CORS）和同源规则（Same Origin Policy）<br>来确保模板可以在任何浏览器中正常加载。例如，所有浏览器都不能进行跨域的请求，部分浏览<br>器也不能访问file://协议的资源。</li>
<li><p>ng-switch<br>这个指令和ng-switch-when及on=”propertyName”一起使用，可以在propertyName发生变<br>化时渲染不同指令到视图中。在下面的例子中，当person.name是Ari时，文本域下面的div会显<br>示出来，并且这个人会获得胜利：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">&lt;input type=&quot;text&quot; ng-model=&quot;person.name&quot;/&gt;</div><div class="line">&lt;div ng-switch on=&quot;person.name&quot;&gt;</div><div class="line">&lt;p ng-switch-default&gt;And the winner is&lt;/p&gt;</div><div class="line">&lt;h1 ng-switch-when=&quot;Ari&quot;&gt;&#123;&#123; person.name &#125;&#125;&lt;/h1&gt;</div><div class="line">&lt;/div&gt;</div></pre></td></tr></table></figure>
<p>注意，在switch被调用之前我们用ng-switch-default来输出默认值。</p>
</li>
<li>ng-view<br>ng-view指令用来设置将被路由管理和放置在HTML中的视图的位置。</li>
<li>ng-if<br>使用ng-if指令可以完全根据表达式的值在DOM中生成或移除一个元素。如果赋值给ng-if的表达式的值是false，那对应的元素将会从DOM中移除，否则对应元素的一个克隆将被重新插入DOM中。<br>ng-if同no-show和ng-hide指令最本质的区别是，它不是通过CSS显示或隐藏DOM节点，而是真正生成或移除节点.</li>
<li><p>ng-repeat<br>ng-repeat用来遍历一个集合或为集合中的每个元素生成一个模板实例。集合中的每个元素都会被赋予自己的模板和作用域。同时每个模板实例的作用域中都会暴露一些特殊的属性。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"> $index：遍历的进度（0...length-1）。</div><div class="line"> $first：当元素是遍历的第一个时值为true。</div><div class="line"> $middle：当元素处于第一个和最后元素之间时值为true。</div><div class="line"> $last：当元素是遍历的最后一个时值为true。</div><div class="line"> $even：当$index值是偶数时值为true。</div><div class="line"> $odd：当$index值是奇数时值为true。</div></pre></td></tr></table></figure>
<ol>
<li>ng-bind<br>尽管可以在视图中使用{ { } }模板语法（AngularJS内置的方式），我们也可以通过ng-bind指令实现同样的行为。<br>HTML加载含有{ { } }语法的元素后并不会立刻渲染它们，导致未渲染内容闪烁（Flash of Unrendered Content， FOUC）。我可以用ng-bind将内容同元素绑定在一起避免FOUC。内容会被当作子文本节点渲染到含有ng-bind指令的元素内。</li>
<li>ng-cloak<br>除使用ng-bind来避免未渲染元素闪烁，还可以在含有{ { } }的元素上使用ng-cloak指令：<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">&lt;body ng-init=&quot;greeting=&apos;HelloWorld&apos;&quot;&gt;</div><div class="line">&lt;p ng-cloak&gt;&#123;&#123; greeting &#125;&#125;&lt;/p&gt;</div><div class="line">&lt;/body&gt;</div></pre></td></tr></table></figure>
</li>
</ol>
<p>ng-cloak指令会将内部元素隐藏，直到路由调用对应的页面时才显示出来。</p>
<ol>
<li><p>ng-bind-template<br>同ng-bind指令类似， ng-bind-template用来在视图中绑定多个表达式。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">&lt;div</div><div class="line">ng-bind-template=&quot;&#123;&#123;message&#125;&#125;&#123;&#123;name&#125;&#125;&quot;&gt;</div><div class="line">&lt;/div&gt;</div></pre></td></tr></table></figure>
</li>
<li><p>ng-model<br>ng-model指令用来将input、 select、 text area或自定义表单控件同包含它们的作用域中的属性进行绑定。它可以提供并处理表单验证功能，在元素上设置相关的CSS类（ng-valid、ng-invalid等），并负责在父表单中注册控件。<br>它将当前作用域中运算表达式的值同给定的元素进行绑定。如果属性并不存在，它会隐式创建并将其添加到当前作用域中。我们应该始终用ngModel来绑定$scope上一个数据模型内的属性，而不是$scope上的属性，这可以避免在作用域或后代作用域中发生属性覆盖。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">例如：</div><div class="line">&lt;input type=&quot;text&quot;</div><div class="line">ng-model=&quot;modelName.someProperty&quot; /&gt;</div></pre></td></tr></table></figure>
</li>
<li><p>ng-show/ng-hide<br>ng-show和ng-hide根据所给表达式的值来显示或隐藏HTML元素。</p>
</li>
<li>ng-change<br>这个指令会在表单输入发生变化时计算给定表达式的值。因为要处理表单输入，这个指令要和ngModel联合起来使用。<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line">&lt;div ng-controller=&quot;EquationController&quot;&gt;</div><div class="line">&lt;input type=&quot;text&quot;</div><div class="line">ng-model=&quot;equation.x&quot;</div><div class="line">ng-change=&quot;change()&quot; /&gt;</div><div class="line">&lt;code&gt;&#123;&#123; equation.output &#125;&#125;&lt;/code&gt;</div><div class="line">&lt;/div&gt;</div><div class="line">angular.module(&apos;myApp&apos;,[])</div><div class="line">.controller(&apos;EquationController&apos;,function($scope) &#123;</div><div class="line">$scope.equation = &#123;&#125;;</div><div class="line">$scope.change = function() &#123;</div><div class="line">$scope.equation.output</div><div class="line">= parseInt($scope.equation.x) + 2;</div><div class="line">&#125;;</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
</li>
</ol>
<p>上面的例子中，只要文本输入字段中的内容发生了变化就会改变equation.x的值，进而运行change()函数。</p>
<ol>
<li>ng-form<br>ng-form用来在一个表单内部嵌套另一个表单。普通的HTML <form>标签不允许嵌套，但ng-form可以。<br>这意味着内部所有的子表单都合法时，外部的表单才会合法。这对于用ng-repeat动态创建表单是非常有用的。<br>由于不能通过字符插值来给输入元素动态地生成name属性，所以需要将ng-form指令内每组重复的输入字段都包含在一个外部表单元素内。<br>下面的CSS类会根据表单的验证状态自动设置：</form></li>
</ol>
</li>
<li> 表单合法时设置ng-valid；</li>
<li> 表单不合法时设置ng-invlid；</li>
<li> 表单未进行修改时设置ng-pristion；</li>
<li> 表单进行过修改时设置ng-dirty。<br>Angular不会将表单提交到服务器，除非它指定了action属性。要指定提交表单时调用哪个JavaScript方法，使用下面两个指令中的一个。</li>
<li> ng-submit：在表单元素上使用。</li>
<li><p> ng-click：在第一个按钮或submit类型（input[type=submit]）的输入字段上使用。<br>为了避免处理程序被多次调用，只使用下面两个指令中的一个。<br>下面的例子展示了如何通过服务器返回的JSON数据动态生成一个表单。我们用ng-loop来遍历从服务器取回的所有数据。由于不能动态生成name属性，而我们又需要这个属性做验证，所以在循环的过程中会为每一个字段都生成一个新表单。由于AngularJS中用来取代<form>的ng-form指令可以嵌套，并且外部表单在所有子表单都合法之前一直处于不合法状态，因此我们可以在动态生成子表单的同时使用表单验证功能。是的，鱼和熊掌可以兼得。<br>下面先看一下我们硬编码的JSON数据，把它假设成是从服务器返回的：</form></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div></pre></td><td class="code"><pre><div class="line">angular.module(&apos;myApp&apos;,[])</div><div class="line">.controller(&apos;FormController&apos;,function($scope) &#123;</div><div class="line">$scope.fields = [</div><div class="line">&#123;placeholder: &apos;Username&apos;, isRequired: true&#125;,</div><div class="line">&#123;placeholder: &apos;Password&apos;, isRequired: true&#125;,</div><div class="line">&#123;placeholder: &apos;Email (optional)&apos;, isRequired: false&#125;</div><div class="line">];</div><div class="line">$scope.submitForm = function() &#123;</div><div class="line">alert(&quot;it works!&quot;);</div><div class="line">&#125;;</div><div class="line">&#125;);</div><div class="line">下面用这些数据生成一个有验证功能的动态表单：</div><div class="line">&lt;form name=&quot;signup_form&quot;</div><div class="line">ng-controller=&quot;FormController&quot;</div><div class="line">ng-submit=&quot;submitForm()&quot; novalidate&gt;</div><div class="line">&lt;div ng-repeat=&quot;field in fields&quot;</div><div class="line">ng-form=&quot;signup_form_input&quot;&gt;</div><div class="line">&lt;input type=&quot;text&quot;</div><div class="line">name=&quot;dynamic_input&quot;</div><div class="line">ng-required=&quot;field.isRequired&quot;</div><div class="line">ng-model=&quot;field.name&quot;</div><div class="line">placeholder=&quot;&#123;&#123;field.placeholder&#125;&#125;&quot; /&gt;</div><div class="line">&lt;div</div><div class="line">ng-show=&quot;signup_form_input.dynamic_input.$dirty &amp;&amp;</div><div class="line">signup_form_input.dynamic_input.$invalid&quot;&gt;</div><div class="line">&lt;span class=&quot;error&quot;</div><div class="line">ng-show=&quot;signup_form_input.dynamic_input.$error.required&quot;&gt;</div><div class="line">The field is required.</div><div class="line">&lt;/span&gt;</div><div class="line">&lt;/div&gt;</div><div class="line">&lt;/div&gt;</div><div class="line">&lt;button type=&quot;submit&quot;</div><div class="line">ng-disabled=&quot;signup_form.$invalid&quot;&gt;</div><div class="line">Submit All</div><div class="line">&lt;/button&gt;</div><div class="line">&lt;/form&gt;</div><div class="line">input.ng-invalid &#123;</div><div class="line">border: 1px solid red;</div><div class="line">&#125;</div><div class="line">input.ng-valid &#123;</div><div class="line">border: 1px solid green;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<ol>
<li>ng-click<br>ng-click用来指定一个元素被点击时调用的方法或表达式。</li>
<li>ng-select<br>ng-select用来将数据同HTML的<code>&lt;select&gt;</code>元素进行绑定。这个指令可以和ng-model以及ng-options指令一同使用，构建精细且表现优良的动态表单。<br>ng-options的值可以是一个内涵表达式（comprehension expression），其实这只是一种有趣的说法，简单来说就是它可以接受一个数组或对象，并对它们进行循环，将内部的内容提供给select标签内部的选项。它可以是下面两种形式。</li>
</ol>
</li>
<li> 数组作为数据源：</li>
</ol>
<ul>
<li> 用数组中的值做标签；</li>
<li> 用数组中的值作为选中的标签；</li>
<li> 用数组中的值做标签组；</li>
<li> 用数组中的值作为选中的标签组。</li>
</ul>
<ol>
<li> 对象作为数据源：</li>
</ol>
<ul>
<li> 用对象的键-值（key-value）做标签；</li>
<li> 用对象的键-值作为选中的标签；</li>
<li> 用对象的键-值作为标签组；</li>
<li><p> 用对象的键-值作为选中的标签组。<br>下面看一个ng-select指令的实例：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line">&lt;div ng-controller=&quot;CityController&quot;&gt;</div><div class="line">&lt;select ng-model=&quot;city&quot;</div><div class="line">ng-options=&quot;city.name for city in cities&quot;&gt;</div><div class="line">&lt;option value=&quot;&quot;&gt;Choose City&lt;/option&gt;</div><div class="line">&lt;/select&gt;</div><div class="line">Best City: &#123;&#123; city.name &#125;&#125;</div><div class="line">&lt;/div&gt;</div><div class="line">angular.module(&apos;myApp&apos;,[])</div><div class="line">.controller(&apos;CityController&apos;,function($scope) &#123;</div><div class="line">$scope.cities = [</div><div class="line">&#123;name: &apos;Seattle&apos;&#125;,</div><div class="line">&#123;name: &apos;San Francisco&apos;&#125;,</div><div class="line">&#123;name: &apos;Chicago&apos;&#125;,</div><div class="line">&#123;name: &apos;New York&apos;&#125;,</div><div class="line">&#123;name: &apos;Boston&apos;&#125;</div><div class="line">];</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<ol>
<li><p>ng-submit<br>ng-submit用来将表达式同onsubmit事件进行绑定。这个指令同时会阻止默认行为（发送请求并重新加载页面）， 除非表单不含有action属性。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div></pre></td><td class="code"><pre><div class="line">&lt;form ng-submit=&quot;submit()&quot;</div><div class="line">ng-controller=&quot;FormController&quot;&gt;</div><div class="line">Enter text and hit enter:</div><div class="line">&lt;input type=&quot;text&quot;</div><div class="line">ng-model=&quot;person.name&quot;</div><div class="line">name=&quot;person.name&quot; /&gt;</div><div class="line">&lt;input type=&quot;submit&quot;</div><div class="line">name=&quot;person.name&quot;</div><div class="line">value=&quot;Submit&quot; /&gt;</div><div class="line">&lt;code&gt;people=&#123;&#123;people&#125;&#125;&lt;/code&gt;</div><div class="line">&lt;ul ng-repeat=&quot;(index, object) in people&quot;&gt;</div><div class="line">&lt;li&gt;&#123;&#123; object.name &#125;&#125;&lt;/li&gt;</div><div class="line">&lt;/ul&gt;</div><div class="line">&lt;/form&gt;</div><div class="line">angular.module(&apos;myApp&apos;,[])</div><div class="line">.controller(&apos;FormController&apos;,function($scope) &#123;</div><div class="line">$scope.person = &#123;</div><div class="line">name: null</div><div class="line">&#125;;</div><div class="line">$scope.people = [];</div><div class="line">$scope.submit = function() &#123;</div><div class="line">if ($scope.person.name) &#123;</div><div class="line">$scope.people.push(&#123;name: $scope.person.name&#125;);</div><div class="line">$scope.person.name = &apos;&apos;;</div><div class="line">&#125;</div><div class="line">&#125;;</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
</li>
<li><p>ng-class<br>使用ng-class 动态设置元素的类，方法是绑定一个代表所有需要添加的类的表达式。重复的类不会添加。当表达式发生变化，先前添加的类会被移除，新类会被添加。<br>下面的例子会用ng-class在一个随机数大于5时将.red类添加到一个div上：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div></pre></td><td class="code"><pre><div class="line">&lt;div ng-controller=&quot;LotteryController&quot;&gt;</div><div class="line">&lt;div ng-class=&quot;&#123;red: x &gt; 5&#125;&quot;//ng-class=&quot;&#123;red: x &gt; 5,green:x&lt;5&#125; 加多个类时用逗号隔开即可。</div><div class="line">ng-if=&quot;x &gt; 5&quot;&gt;</div><div class="line">You won!</div><div class="line">&lt;/div&gt;</div><div class="line">&lt;button ng-click=&quot;generateNumber()&quot;</div><div class="line">ng-init=&quot;x = 0&quot;&gt;</div><div class="line">Draw Number</div><div class="line">&lt;/button&gt;</div><div class="line">&lt;p&gt;Number is: &#123;&#123; x &#125;&#125;&lt;/p&gt;</div><div class="line">&lt;/div&gt;</div><div class="line"></div><div class="line">.red &#123;</div><div class="line">background-color: red;</div><div class="line">&#125;</div><div class="line">angular.module(&apos;myApp&apos;,[])</div><div class="line">.controller(&apos;LotteryController&apos;, function($scope) &#123;</div><div class="line">$scope.generateNumber = function() &#123;</div><div class="line">return Math.floor((Math.random()*10)+1);</div><div class="line">&#125;;</div><div class="line">&#125;)</div></pre></td></tr></table></figure>
</li>
<li><p>ng-attr-(suffix)<br>当AngularJS编译DOM时会查找花括号{ { some expression } }内的表达式。这些表达式会被自动注册到$watch服务中并更新到$digest循环中，成为它的一部分：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line">&lt;-- updated when`someExpression` on the$scope</div><div class="line">is updated --&gt;</div><div class="line">&lt;h1&gt;Hello&#123;&#123;someExpression&#125;&#125;&lt;/h1&gt;</div><div class="line">有时浏览器会对属性会进行很苛刻的限制。 SVG就是一个例子：</div><div class="line">&lt;svg&gt;</div><div class="line">&lt;circle cx=&quot;&#123;&#123; cx &#125;&#125;&quot;&gt;&lt;/circle&gt;</div><div class="line">&lt;/svg&gt;</div><div class="line">运行上面的代码会抛出一个错误，指出我们有一个非法属性。可以用ng-attr-cx来解决这</div><div class="line">个问题。注意， cx位于这个名称的尾部。在这个属性中，通过用&#123;&#123; &#125;&#125;来写表达式，达到前面提</div><div class="line">到的目的。</div><div class="line">&lt;svg&gt;</div><div class="line">&lt;circle ng-attr-cx=&quot;&#123;&#123; cx &#125;&#125;&quot;&gt;&lt;circle&gt;</div><div class="line">&lt;/svg&gt;</div><div class="line">&#123;&#123;person.name || &quot;无&quot;&#125;&#125; //绑定时做简单判断可以这么写。</div></pre></td></tr></table></figure>
</li>
</ol>
</li>
</ul>

      
    </div>
    
    <div class="article-info article-info-index">
      
      

      
    <div class="article-tag tagcloud">
        <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/angular、directive/">angular、directive</a></li></ul>
    </div>

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>









  
    <article id="post-angular-guide6-7" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2016/05/10/angular-guide6-7/" class="article-date">
      <time datetime="2016-05-10T07:09:49.000Z" itemprop="datePublished">2016-05-10</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/05/10/angular-guide6-7/">Angular权威指南学习(第6-7章)表达式和过滤器</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
        <h4 id="表达式"><a href="#表达式" class="headerlink" title="表达式"></a>表达式</h4><p>用{ { } }符号将一个变量绑定到$scope上的写法本质上就是一个表达式：<code></code>。当用$watch进行监听时， AngularJS会对表达式或函数进行运算。<br>表达式和eval(javascript)非常相似，但是由于表达式由AngularJS来处理，它们有以下显著不同的特性：</p>
<ol>
<li>所有的表达式都在其所属的作用域内部执行，并有访问本地$scope的权限；</li>
<li>如果表达式发生了TypeError和ReferenceError并不会抛出异常；</li>
<li>不允许使用任何流程控制功能（条件控制，例如if/eles）；</li>
<li>可以接受过滤器和过滤器链。<h4 id="解析-AngularJS-表达式"><a href="#解析-AngularJS-表达式" class="headerlink" title="解析 AngularJS 表达式"></a>解析 AngularJS 表达式</h4>AngularJS会在运行$digest循环的过程中自动解析表达式，AngularJS通过$parse这个内部服务来进行表达式的运算，这个服务能够访问当前所处的作用域。这个过程允许我们访问定义在$scope上的原始JavaScript数据和函数。将$parse服务注入到控制器中，然后调用它就可以实现手动解析表达式。<br>如果页面上有一个输入框绑定到了expr变量上，如下所示:<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line">&lt;div ng-controller=&quot;MyController&quot;&gt;</div><div class="line">&lt;input ng-model=&quot;expr&quot;</div><div class="line">type=&quot;text&quot;</div><div class="line">placeholder=&quot;Enter an expression&quot; /&gt;</div><div class="line">&lt;h2&gt;&#123;&#123; parseValue &#125;&#125;&lt;/h2&gt;</div><div class="line">&lt;/div&gt;</div><div class="line">我们可以在MyController中给expr这个表达式设置一个$watch并解析它：</div><div class="line">angular.module(&quot;myApp&quot;, [])</div><div class="line">.controller(&apos;MyController&apos;,</div><div class="line">function($scope,$parse) &#123;</div><div class="line">$scope.$watch(&apos;expr&apos;, function(newVal, oldVal, scope) &#123;</div><div class="line">if (newVal !== oldVal) &#123;</div><div class="line">// 用该表达式设置parseFun</div><div class="line">var parseFun = $parse(newVal);</div><div class="line">// 获取经过解析后表达式的值</div><div class="line">$scope.parsedValue = parseFun(scope);</div><div class="line">&#125;</div><div class="line">&#125;);</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
</li>
</ol>
<p>注：$watch函数会监视$scope上的某个属性。只要属性发生变化就会调用对应的函数。可以使用$watch函数在$scope上某个属性发生变化时直接运行一个自定义函数。</p>
<h4 id="插值字符串（不常用）"><a href="#插值字符串（不常用）" class="headerlink" title="插值字符串（不常用）"></a>插值字符串（不常用）</h4><p>在开发中，我们的确有手动运行模板编译的能力。要在字符串模板中做插值操作，需要在你的对象中注入$interpolate服务。<br>$interpolate服务返回一个函数，用来在特定的上下文中运算表达式。</p>
<h4 id="过滤器"><a href="#过滤器" class="headerlink" title="过滤器"></a>过滤器</h4><p>过滤器用来格式化需要展示给用户的数据。 AngularJS有很多实用的内置过滤器，同时也提供了方便的途径可以自己创建过滤器。在HTML中的模板绑定符号{ { } }内通过|符号来调用过滤器。例如，假设我们希望将字符串转换成大写，可以对字符串中的每个字符都单独进行转换操作，也可以使用过滤器：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">&#123;&#123; name | uppercase &#125;&#125;</div></pre></td></tr></table></figure></p>
<p>在JavaScript代码中可以通过$filter来调用过滤器。例如，在JavaScript代码中使用lowercase过滤器：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">app.controller(&apos;DemoController&apos;, [&apos;$scope&apos;, &apos;$filter&apos;,</div><div class="line">function($scope, $filter) &#123;</div><div class="line">$scope.name = $filter(&apos;lowercase&apos;)(&apos;WEBYWX&apos;);</div><div class="line">&#125;]);</div></pre></td></tr></table></figure></p>
<p>以HTML的形式使用过滤器时，如果需要传递参数给过滤器，只要在过滤器名字后面加冒号即可。如果有多个参数，可以在每个参数后面都加入冒号。例如，数值过滤器可以限制小数点后的位数，在过滤器后写上:2可以将2作为参数传给过滤器：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">&lt;!-- 显示： 123.46 --&gt;</div><div class="line">&#123;&#123; 123.456789 | number:2 &#125;&#125;</div></pre></td></tr></table></figure></p>
<p>可以用|符号作为分割符来同时使用多个过滤器.</p>
<h4 id="angular-内置过滤器"><a href="#angular-内置过滤器" class="headerlink" title="angular 内置过滤器"></a>angular 内置过滤器</h4><ol>
<li>currency<br>currecy过滤器可以将一个数值格式化为货币格式。用{ { 123 | currency } }`来将123转化成货币格式。</li>
<li><p>date<br>date过滤器可以将日期格式化成需要的格式。 AngularJS中内置了几种日期格式，如果没有指定使用任何格式，默认会采用mediumDate格式，下面的例子中展示了这个格式。下面是内置的支持本地化的日期格式：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div></pre></td><td class="code"><pre><div class="line">&#123;&#123; today | date:&apos;medium&apos; &#125;&#125; &lt;!-- Aug 09, 2013 12:09:02 PM --&gt;</div><div class="line">&#123;&#123; today | date:&apos;short&apos; &#125;&#125; &lt;!-- 8/9/1312:09PM --&gt;</div><div class="line">&#123;&#123; today | date:&apos;fullDate&apos; &#125;&#125; &lt;!-- Thursday, August 09, 2013 --&gt;</div><div class="line">&#123;&#123; today | date:&apos;longDate&apos; &#125;&#125; &lt;!-- August 09, 2013 --&gt;</div><div class="line">&#123;&#123; today | date:&apos;mediumDate&apos; &#125;&#125;&lt;!-- Aug 09, 2013 --&gt;</div><div class="line">&#123;&#123; today | date:&apos;shortDate&apos; &#125;&#125; &lt;!-- 8/9/13 --&gt;</div><div class="line">&#123;&#123; today | date:&apos;mediumTime&apos; &#125;&#125;&lt;!-- 12:09:02 PM --&gt;</div><div class="line">&#123;&#123; today | date:&apos;shortTime&apos; &#125;&#125; &lt;!-- 12:09 PM --&gt;</div><div class="line"> 年份格式化</div><div class="line">四位年份： &#123;&#123; today | date:&apos;yyyy&apos; &#125;&#125; &lt;!-- 2013 --&gt;</div><div class="line">两位年份： &#123;&#123; today | date:&apos;yy&apos; &#125;&#125; &lt;!-- 13 --&gt;</div><div class="line">一位年份： &#123;&#123; today | date:&apos;y&apos; &#125;&#125; &lt;!-- 2013 --&gt;</div><div class="line"> 月份格式化</div><div class="line">英文月份： &#123;&#123; today | date:&apos;MMMM&apos; &#125;&#125; &lt;!-- August --&gt;</div><div class="line">英文月份简写： &#123;&#123; today | date:&apos;MMM&apos; &#125;&#125; &lt;!-- Aug --&gt;</div><div class="line">数字月份： &#123;&#123; today |date:&apos;MM&apos; &#125;&#125; &lt;!-- 08 --&gt;</div><div class="line">一年中的第几个月份： &#123;&#123; today |date:&apos;M&apos; &#125;&#125; &lt;!-- 8 --&gt;</div><div class="line"> 日期格式化</div><div class="line">数字日期： &#123;&#123; today|date:&apos;dd&apos; &#125;&#125; &lt;!-- 09 --&gt;</div><div class="line">一个月中的第几天： &#123;&#123; today | date:&apos;d&apos; &#125;&#125; &lt;!-- 9 --&gt;</div><div class="line">英文星期： &#123;&#123; today | date:&apos;EEEE&apos; &#125;&#125; &lt;!-- Thursday --&gt;</div><div class="line">英文星期简写： &#123;&#123; today | date:&apos;EEE&apos; &#125;&#125; &lt;!-- Thu --&gt;</div><div class="line"> 小时格式化</div><div class="line">24小时制数字小时： &#123;&#123;today|date:&apos;HH&apos;&#125;&#125; &lt;!--00--&gt;</div><div class="line">一天中的第几个小时： &#123;&#123;today|date:&apos;H&apos;&#125;&#125; &lt;!--0--&gt;</div><div class="line">12小时制数字小时： &#123;&#123;today|date:&apos;hh&apos;&#125;&#125; &lt;!--12--&gt;</div><div class="line">上午或下午的第几个小时： &#123;&#123;today|date:&apos;h&apos;&#125;&#125; &lt;!--12--&gt;</div><div class="line"> 分钟格式化</div><div class="line">数字分钟数： &#123;&#123; today | date:&apos;mm&apos; &#125;&#125; &lt;!-- 09 --&gt;</div><div class="line">一个小时中的第几分钟： &#123;&#123; today | date:&apos;m&apos; &#125;&#125; &lt;!-- 9 --&gt;</div><div class="line"> 秒数格式化</div><div class="line">数字秒数： &#123;&#123; today | date:&apos;ss&apos; &#125;&#125; &lt;!-- 02 --&gt;</div><div class="line">一分钟内的第几秒： &#123;&#123; today | date:&apos;s&apos; &#125;&#125; &lt;!-- 2 --&gt;</div><div class="line">毫秒数： &#123;&#123; today | date:&apos;.sss&apos; &#125;&#125; &lt;!-- .995 --&gt;</div><div class="line"> 字符格式化</div><div class="line">上下午标识： &#123;&#123; today | date:&apos;a&apos; &#125;&#125; &lt;!-- AM --&gt;</div><div class="line">四位时区标识： &#123;&#123; today | date:&apos;Z&apos; &#125;&#125; &lt;!--- 0700 --&gt;</div><div class="line">下面是一些自定义日期格式的示例：</div><div class="line">&#123;&#123; today | date:&apos;MMMd, y&apos; &#125;&#125; &lt;!-- Aug9, 2013 --&gt;</div><div class="line">&#123;&#123; today | date:&apos;EEEE, d, M&apos; &#125;&#125; &lt;!-- Thursday, 9, 8--&gt;</div><div class="line">&#123;&#123; today | date:&apos;hh:mm:ss.sss&apos; &#125;&#125; &lt;!-- 12:09:02.995 --&gt;</div></pre></td></tr></table></figure>
</li>
<li><p>filter<br>filter过滤器可以从给定数组中选择一个子集，并将其生成一个新数组返回。这个过滤器通常用来过滤需要进行展示的元素。例如，在做客户端搜索时，可以从一个数组中立刻过滤出所需的结果。这个过滤器的第一个参数可以是字符串、对象或是一个用来从数组中选择元素的函数。<br> 下面分情况介绍传入不同类型的参数。</p>
<ol>
<li> 字符串<br>返回所有包含这个字符串的元素。如果我们想返回不包含该字符串的元素，在参数前加!符号。</li>
<li> 对象<br>AngularJS会将待过滤对象的属性同这个对象中的同名属性进行比较，如果属性值是字符串就会判断是否包含该字符串。如果我们希望对全部属性都进行对比，可以将$当作键名。</li>
<li><p> 函数<br>对每个元素都执行这个函数，返回非假值的元素会出现在新的数组中并返回。<br>例如，用下面的过滤器可以选择所有包含字母e的单词：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">&#123;&#123; [&apos;Ari&apos;,&apos;Lerner&apos;,&apos;Likes&apos;,&apos;To&apos;,&apos;Eat&apos;,&apos;Pizza&apos;] | filter:&apos;e&apos; &#125;&#125;</div><div class="line">&lt;!-- [&quot;Lerner&quot;,&quot;Likes&quot;,&quot;Eat&quot;] --&gt;</div></pre></td></tr></table></figure>
<p>如果要过滤对象，可以使用上面提到的对象过滤器。例如，如果有一个由people对象组成的<br>数组，每个对象都含有他们最喜欢吃的食物的列表，那么可以用下面的形式进行过滤：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">&#123;&#123; [&#123;</div><div class="line">&apos;name&apos;: &apos;Ari&apos;,</div><div class="line">&apos;City&apos;: &apos;San Francisco&apos;,</div><div class="line">&apos;favorite food&apos;: &apos;Pizza&apos;</div><div class="line">&#125;,&#123;</div><div class="line">&apos;name&apos;: &apos;Nate&apos;,</div><div class="line">&apos;City&apos;: &apos;San Francisco&apos;,</div><div class="line">&apos;favorite food&apos;: &apos;indian food&apos;</div><div class="line">&#125;] | filter:&#123;&apos;favorite food&apos;: &apos;Pizza&apos;&#125; &#125;&#125;</div><div class="line">&lt;!-- [&#123;&quot;name&quot;:&quot;Ari&quot;,&quot;City&quot;:&quot;SanFrancisco&quot;,&quot;favoritefood&quot;:&quot;Pizza&quot;&#125;] --&gt;</div></pre></td></tr></table></figure>
<p>也可以用自定义函数进行过滤（在这个例子中函数定义在$scope上）：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">&#123;&#123; [&apos;Ari&apos;,&apos;likes&apos;,&apos;to&apos;,&apos;travel&apos;] | filter:isCapitalized &#125;&#125;</div><div class="line">&lt;!-- [&quot;Ari&quot;] --&gt;</div><div class="line">isCapitalized函数的功能是根据首字母是否为大写返回true或false，具体如下所示：</div><div class="line">$scope.isCapitalized = function(str) &#123;</div><div class="line">return str[0] == str[0].toUpperCase();</div><div class="line">&#125;;</div></pre></td></tr></table></figure>
<p>我们也可以给filter过滤器传入第二个参数，用来指定预期值同实际值进行比较的方式。<br>第二个参数可以是以下三种情况之一。<br> true<br>用angular.equals(expected, actual)对两个值进行严格比较。<br> false<br>进行区分大小写的子字符串比较。<br> 函数<br>运行这个函数，如果返回真值就接受这个元素。</p>
<h4 id="json"><a href="#json" class="headerlink" title="json"></a>json</h4><p>json过滤器可以将一个JSON或JavaScript对象转换成字符串。这种转换对调试非常有帮助：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">&#123;&#123; &#123;&apos;name&apos;: &apos;Ari&apos;, &apos;City&apos;: &apos;SanFrancisco&apos;&#125; | json &#125;&#125;</div><div class="line">&lt;!--</div><div class="line">&#123;</div><div class="line">&quot;name&quot;: &quot;Ari&quot;,</div><div class="line">&quot;City&quot;: &quot;San Francisco&quot;</div><div class="line">&#125;</div><div class="line">--&gt;</div></pre></td></tr></table></figure>
</li>
</ol>
</li>
<li><p>limitTo<br>limitTo过滤器会根据传入的参数生成一个新的数组或字符串，新的数组或字符串的长度取决于传入的参数，通过传入参数的正负值来控制从前面还是从后面开始截取。如果传入的长度值大于被操作数组或字符串的长度，那么整个数组或字符串都会被返回。<br>例如，我们可以截取字符串的前三个字符：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">&#123;&#123; San Francisco is very cloudy | limitTo:3 &#125;&#125;</div><div class="line">&lt;!-- San --&gt;</div><div class="line">或最后的六个字符：</div><div class="line">&#123;&#123; San Francisco is very cloudy | limitTo:-6 &#125;&#125;</div><div class="line">&lt;!-- cloudy --&gt;</div><div class="line">对数组也可以进行同样的操作。返回数组的第一个元素：</div><div class="line">&#123;&#123; [&apos;a&apos;,&apos;b&apos;,&apos;c&apos;,&apos;d&apos;,&apos;e&apos;,&apos;f&apos;] | limitTo:1 &#125;&#125;</div><div class="line">&lt;!-- [&quot;a&quot;] --&gt;</div></pre></td></tr></table></figure>
</li>
<li><p>lowercase<br>lowercase过滤器将字符串转为小写。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">&#123;&#123; &quot;San Francisco is very cloudy&quot; | lowercase &#125;&#125;</div><div class="line">&lt;!-- san francisco is very cloudy --&gt;</div></pre></td></tr></table></figure>
</li>
<li><p>number<br>number过滤器将数字格式化成文本。它的第二个参数是可选的，用来控制小数点后截取的位数。如果传入了一个非数字字符，会返会空字符串。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">&#123;&#123; 123456789 | number &#125;&#125;</div><div class="line">&lt;!-- 1,234,567,890 --&gt;</div><div class="line">&#123;&#123; 1.234567 | number:2 &#125;&#125;</div><div class="line">&lt;!-- 1.23 --&gt;</div></pre></td></tr></table></figure>
</li>
<li><p>orderBy<br>orderBy过滤器可以用表达式对指定的数组进行排序。orderBy可以接受两个参数，第一个是必需的，第二个是可选的。<br>第一个参数是用来确定数组排序方向的谓词。<br> 下面分情况讨论第一个参数的类型。<br>  函数<br> 当第一个参数是函数时，该函数会被当作待排序对象的getter方法。<br>  字符串<br> 对这个字符串进行解析的结果将决定数组元素的排序方向。我们可以传入+或-来强制进行升序或降序排列。<br>  数组<br> 在排序表达式中使用数组元素作为谓词。对于与表达式结果并不严格相等的每个元素，则使用第一个谓词。<br> 第二个参数用来控制排序的方向（是否逆向）。<br> 例如，我们将下面的对象数组用name字段进行排序：</p>
 <figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div></pre></td><td class="code"><pre><div class="line">&#123;&#123; [&#123;</div><div class="line">&apos;name&apos;: &apos;Ari&apos;,</div><div class="line">&apos;status&apos;: &apos;awake&apos;</div><div class="line">&#125;,&#123;</div><div class="line">&apos;name&apos;: &apos;Q&apos;,</div><div class="line">&apos;status&apos;: &apos;sleeping&apos;</div><div class="line">&#125;,&#123;</div><div class="line">&apos;name&apos;: &apos;Nate&apos;,</div><div class="line">&apos;status&apos;: &apos;awake&apos;</div><div class="line">&#125;] | orderBy:&apos;name&apos; &#125;&#125;</div><div class="line">&lt;!--</div><div class="line">[</div><div class="line">&#123;&quot;name&quot;:&quot;Ari&quot;,&quot;status&quot;:&quot;awake&quot;&#125;,</div><div class="line">&#123;&quot;name&quot;:&quot;Nate&quot;,&quot;status&quot;:&quot;awake&quot;&#125;,</div><div class="line">&#123;&quot;name&quot;:&quot;Q&quot;,&quot;status&quot;:&quot;sleeping&quot;&#125;</div><div class="line">]</div><div class="line">--&gt;</div><div class="line">也可以对排序结果进行反转。例如，通过将第二个参数设置为true可以将排序结果进行反转：</div><div class="line">&#123;&#123; [&#123;</div><div class="line">&apos;name&apos;: &apos;Ari&apos;,</div><div class="line">&apos;status&apos;: &apos;awake&apos;</div><div class="line">&#125;,&#123;</div><div class="line">&apos;name&apos;: &apos;Q&apos;,</div><div class="line">&apos;status&apos;: &apos;sleeping&apos;</div><div class="line">&#125;,&#123;</div><div class="line">&apos;name&apos;: &apos;Nate&apos;,</div><div class="line">&apos;status&apos;: &apos;awake&apos;</div><div class="line">&#125;] | orderBy:&apos;name&apos;:true &#125;&#125;</div><div class="line">&lt;!--</div><div class="line">[</div><div class="line">&#123;&quot;name&quot;:&quot;Q&quot;,&quot;status&quot;:&quot;sleeping&quot;&#125;,</div><div class="line">&#123;&quot;name&quot;:&quot;Nate&quot;,&quot;status&quot;:&quot;awake&quot;&#125;,</div><div class="line">&#123;&quot;name&quot;:&quot;Ari&quot;,&quot;status&quot;:&quot;awake&quot;&#125;</div><div class="line">]</div><div class="line">--&gt;</div></pre></td></tr></table></figure>
</li>
<li><p>uppercase<br>uppercase过滤器可以将字符串转换为大写形式：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">&#123;&#123; &quot;San Francisco is very cloudy&quot; | uppercase &#125;&#125;</div><div class="line">&lt;!-- SAN FRANCISCO IS VERY CLOUDY --&gt;</div></pre></td></tr></table></figure>
</li>
</ol>
<h4 id="自定义过滤器"><a href="#自定义过滤器" class="headerlink" title="自定义过滤器"></a>自定义过滤器</h4><p>创建自定义过滤器非常容易。创建自定义过滤器需要将它放到自己的模块中。<br>例：实现一个过滤器，将字符串第一个字母转换为大写<br>首先，创建一个模块用以在应用中进行引用（这是一个非常好的实践）：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">angular.module(&apos;myApp.filters&apos;, [])</div><div class="line">.filter(&apos;capitalize&apos;, function() &#123;</div><div class="line">return function(input) &#123;&#125;;</div><div class="line">&#125;);</div></pre></td></tr></table></figure></p>
<p>过滤器本质上是一个会把我们输入的内容当作参数传入进去的函数。上面这个例子中，我们在调用过滤器时简单地把input当作字符串来处理。可以在这个函数中做一些错误检查：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">angular.module(&apos;myApp.filters&apos;, [])</div><div class="line">.filter(&apos;capitalize&apos;, function() &#123;</div><div class="line">return function(input) &#123;</div><div class="line">// input是我们传入的字符串</div><div class="line">if (input) &#123;</div><div class="line">return input[0].toUpperCase() + input.slice(1);</div><div class="line">&#125;</div><div class="line">&#125;);</div></pre></td></tr></table></figure></p>
<p>现在，如果想将一个句子的首字母转换成大写形式，可以用过滤器先将整个句子都转换成小写，再把首字母转换成大写：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">&lt;!-- Ginger loves dog treats --&gt;</div><div class="line">&#123;&#123; &apos;ginger loves dog treats&apos; | lowercase | capitalize &#125;&#125;</div></pre></td></tr></table></figure></p>
<h4 id="表单验证"><a href="#表单验证" class="headerlink" title="表单验证"></a>表单验证</h4><p>AngularJS能够将HTML5表单验证功能同它自己的验证指令结合起来使用，并且非常方便。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">&lt;form name=&quot;form&quot; novalidate&gt;</div><div class="line">&lt;label name=&quot;email&quot;&gt;Your email&lt;/label&gt;</div><div class="line">&lt;input type=&quot;email&quot;</div><div class="line">name=&quot;email&quot;</div><div class="line">ng-model=&quot;email&quot; placeholder=&quot;Email Address&quot; /&gt;</div><div class="line">&lt;/form&gt;</div></pre></td></tr></table></figure></p>
<p>注：要使用表单验证，首先要确保表单像上面的例子一样有一个name属性。<br>所有输入字段都可以进行基本的验证，比如最大、最小长度等。这些功能是由新的HTML5表单属性提供的。如果想要屏蔽浏览器对表单的默认验证行为，可以在表单元素上添加novalidate标记。</p>
<ul>
<li>input元素所有验证选项如下：</li>
</ul>
<ol>
<li><p>必填项<br>验证某个表单输入是否已填写，只要在输入字段元素上添加HTML5标记required即可：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">&lt;input type=&quot;text&quot; required /&gt;</div></pre></td></tr></table></figure>
</li>
<li><p>最小长度<br>验证表单输入的文本长度是否大于某个最小值，在输入字段上使用AngularJS指令ng-minleng=”{number}”：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">&lt;input type=&quot;text&quot; ng-minlength=&quot;5&quot; /&gt;</div></pre></td></tr></table></figure>
</li>
<li><p>最大长度<br>验证表单输入的文本长度是否小于或等于某个最大值，在输入字段上使用AngularJS指令ng-maxlength=”{number}”：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">&lt;input type=&quot;text&quot; ng-maxlength=&quot;20&quot; /&gt;</div></pre></td></tr></table></figure>
</li>
<li><p>模式匹配<br>使用ng-pattern=”/PATTERN/“来确保输入能够匹配指定的正则表达式：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">&lt;input type=&quot;text&quot; ng-pattern=&quot;[a-zA-Z]&quot; /&gt;</div></pre></td></tr></table></figure>
</li>
<li><p>电子邮件<br>验证输入内容是否是电子邮件，只要像下面这样将input的类型设置为email即可：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">&lt;input type=&quot;email&quot; name=&quot;email&quot; ng-model=&quot;user.email&quot; /&gt;</div></pre></td></tr></table></figure>
</li>
<li><p>数字<br>验证输入内容是否是数字，将input的类型设置为number：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">&lt;input type=&quot;number&quot; name=&quot;age&quot; ng-model=&quot;user.age&quot; /&gt;</div></pre></td></tr></table></figure>
</li>
<li><p>URL<br>验证输入内容是否是URL，将input的类型设置为 url：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">&lt;input type=&quot;url&quot; name=&quot;homepage&quot; ng-model=&quot;user.facebook_url&quot; /&gt;</div></pre></td></tr></table></figure>
</li>
<li><p>在表单中控制变量<br>表单的属性可以在其所属的$scope对象中访问到，而我们又可以访问$scope对象，因此JavaScript可以间接地访问DOM中的表单属性。借助这些属性，我们可以对表单做出实时（和AngularJS中其他东西一样）响应。<br>注：可以使用下面的格式访问这些属性。<br>formName.inputFieldName.property<br> 未修改的表单<br>这是一个布尔属性，用来判断用户是否修改了表单。如果未修改，值为true，如果修改过值<br>为false：<br>formName.inputFieldName.$pristine<br> 修改过的表单<br>只要用户修改过表单，无论输入是否通过验证，该值都返回true：<br>formName.inputFieldName.$dirty<br> 合法的表单<br>这个布尔型的属性用来判断表单的内容是否合法。如果当前表单内容是合法的，下面属性的<br>值就是true：<br>formName.inputFieldName.$valid<br> 不合法的表单<br>这个布尔属性用来判断表单的内容是否不合法。如果当前表单内容是不合法的，下面属性的<br>值为true：<br>formName.inputFieldName.$invalid<br> 错误<br>这是AngularJS提供的另外一个非常有用的属性： $error对象。它包含当前表单的所有验证<br>内容，以及它们是否合法的信息。用下面的语法访问这个属性：<br>formName.inputfieldName.$error<br>如果验证失败，这个属性的值为true；如果值为false，说明输入字段的值通过了验证。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">例：判断错误提示框是否显示：</div><div class="line">ng-show=&quot;signup_form.name.$dirty &amp;&amp; signup_form.name.$invalid&quot;</div><div class="line">signup_form为表单的name属性值，name为input输入框的name属性值。</div></pre></td></tr></table></figure>
</li>
<li><p>一些有用的CSS样式<br>AngularJS处理表单时，会根据表单当前的状态添加一些CSS类（例如当前是合法的、未发生变化的，等等），这些CSS类的命名和前面介绍的属性很相似。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">.ng-pristine &#123;&#125;</div><div class="line">.ng-dirty &#123;&#125;</div><div class="line">.ng-valid &#123;&#125;</div><div class="line">.ng-invalid &#123;&#125;</div></pre></td></tr></table></figure>
<p>它们对应着表单输入字段的特定状态。<br>当某个字段中的输入非法时， .ng-invlid类会被添加到这个字段上。当前例子中的站点将对应的CSS样式设置为：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">input.ng-invalid &#123;</div><div class="line">border: 1px solid red;</div><div class="line">&#125;</div><div class="line">input.ng-valid &#123;</div><div class="line">border: 1px solid green;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
</li>
</ol>
<ul>
<li>$parsers<br>使用$parsers数组是实现自定义验证的途径之一。<ul>
<li>$formatters<br>注：表单本身会提供$invalid和$valid属性。例：formName.$invalid;当用户试图提交表单时，你可以在作用域中捕获到一个submitted值，然后对表单内容进行验证并显示错误信息。一般当formName.submitted设置为true时，容纳错误信息的div才会展示出来。<h4 id="从1-3开始，-Angular中新增了一个ngMessages指令。"><a href="#从1-3开始，-Angular中新增了一个ngMessages指令。" class="headerlink" title="从1.3开始， Angular中新增了一个ngMessages指令。"></a>从1.3开始， Angular中新增了一个ngMessages指令。</h4></li>
</ul>
</li>
</ul>
<ol>
<li><p>安装ngMessages很简单，因为它被打包成了一个Angular模块。首先下载这个模块：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ bower install --save angular-messages</div></pre></td></tr></table></figure>
</li>
<li><p>还需要将angular-messages.js这个JavaScript引入我们的主HTML中：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">&lt;script type=&quot;text/javascript&quot; src=&quot;bower_components/angular-messages/angular-messages.js&quot;&gt;</div><div class="line">&lt;/script&gt;</div></pre></td></tr></table></figure>
</li>
<li><p>最后，我们还要告诉Angular将ngMessages作为应用程序的依赖模块引入，就像这样：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">angular.module(&apos;myApp&apos;, [&apos;ngMessages&apos;]);</div></pre></td></tr></table></figure>
<p>例：在没有使用ngMessages之前，我们可能这样写验证：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">&lt;form name=&quot;userForm&quot;&gt;</div><div class="line">&lt;input </div><div class="line">type=&quot;text&quot;</div><div class="line">name=&quot;username&quot;</div><div class="line">ng-model=&quot;user.username&quot;</div><div class="line">ng-minlength=&quot;3&quot;</div><div class="line">ng-maxlength=&quot;8&quot;</div><div class="line">required&gt;</div><div class="line">&lt;p ng-show=&quot;userForm.username.$error.minlength&quot;&gt;Username is too short.&lt;/p&gt;</div><div class="line">&lt;p ng-show=&quot;userForm.username.$error.maxlength&quot;&gt;Username is too long.&lt;/p&gt;</div><div class="line">&lt;p ng-show=&quot;userForm.username.$error.required&quot;&gt;Your username is required.&lt;/p&gt;</div><div class="line">&lt;/form&gt;</div></pre></td></tr></table></figure>
<p>有了”ngMessages”这个module,大致这么写：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">&lt;div class=&quot;help-block&quot; ng-messages=&quot;userForm.name.$error&quot; ng-if=&quot;userForm.name.$touched&quot;&gt;</div><div class="line">&lt;p ng-message=&quot;minlength&quot;&gt;用户名最小长度5&lt;/p&gt;</div><div class="line">&lt;p ng-message=&quot;maxlength&quot;&gt;用户名最大长度10&lt;/p&gt;</div><div class="line">&lt;p ng-message=&quot;required&quot;&gt;用户名必填&lt;/p&gt;</div><div class="line">&lt;/div&gt;</div></pre></td></tr></table></figure>
<p>ngMessages为我们自动判断显示哪种错误。</p>
</li>
</ol>
<h4 id="使用ngMessages的几个关键点："><a href="#使用ngMessages的几个关键点：" class="headerlink" title="使用ngMessages的几个关键点："></a>使用ngMessages的几个关键点：</h4><ol>
<li>● npm install angular-messages</li>
<li>● 引用：angular-messages.js</li>
<li>● 依赖：angular.module(‘app’,[‘ngMessages’])</li>
</ol>

      
    </div>
    
    <div class="article-info article-info-index">
      
      

      
    <div class="article-tag tagcloud">
        <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/angular、表达式、filter/">angular、表达式、filter</a></li></ul>
    </div>

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>









  
  
    <nav id="page-nav">
      <a class="extend prev" rel="prev" href="/page/7/">&laquo; Prev</a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/6/">6</a><a class="page-number" href="/page/7/">7</a><span class="page-number current">8</span><a class="page-number" href="/page/9/">9</a><a class="page-number" href="/page/10/">10</a><span class="space">&hellip;</span><a class="page-number" href="/page/12/">12</a><a class="extend next" rel="next" href="/page/9/">Next &raquo;</a>
    </nav>
  
</div>
      <footer id="footer">
    <div class="outer">
        <div id="footer-info">
            <div class="footer-left">
                &copy; 2018 Wenxi Yan
            </div>
            <div class="footer-right">
                <a href="http://webywx.com/" target="_blank">webywx</a>  Theme <a href="https://yanwenxi.site" target="_blank">前端在路上</a> by Scorpio
            </div>
        </div>
        
            <div class="visit">
                
                    <span id="busuanzi_container_site_pv" style='display:none'>
                        <span id="site-visit" >用户到访数: 
                            <span id="busuanzi_value_site_uv"></span>
                        </span>
                    </span>
                
                
                    <span>, </span>
                
                
                    <span id="busuanzi_container_page_pv" style='display:none'>
                        <span id="page-visit">本页阅读量: 
                            <span id="busuanzi_value_page_pv"></span>
                        </span>
                    </span>
                
            </div>
        
    </div>
</footer>

    </div>
    <script src="https://7.url.cn/edu/jslib/comb/require-2.1.6,jquery-1.9.1.min.js"></script>
<script src="/js/main.js"></script>

    <script>
        $(document).ready(function() {
            var backgroundnum = 24;
            var backgroundimg = "url(/background/bg-x.jpg)".replace(/x/gi, Math.ceil(Math.random() * backgroundnum));
            $("#mobile-nav").css({"background-image": backgroundimg,"background-size": "cover","background-position": "center"});
            $(".left-col").css({"background-image": backgroundimg,"background-size": "cover","background-position": "center"});
        })
    </script>





<div class="scroll" id="scroll">
    <a href="#"><i class="fa fa-arrow-up"></i></a>
    <a href="#comments"><i class="fa fa-comments-o"></i></a>
    <a href="#footer"><i class="fa fa-arrow-down"></i></a>
</div>
<script>
    $(document).ready(function() {
        if ($("#comments").length < 1) {
            $("#scroll > a:nth-child(2)").hide();
        };
    })
</script>

<script async src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js">
</script>

  <script language="javascript">
    $(function() {
        $("a[title]").each(function() {
            var a = $(this);
            var title = a.attr('title');
            if (title == undefined || title == "") return;
            a.data('title', title).removeAttr('title').hover(

            function() {
                var offset = a.offset();
                $("<div id=\"anchortitlecontainer\"></div>").appendTo($("body")).html(title).css({
                    top: offset.top - a.outerHeight() - 15,
                    left: offset.left + a.outerWidth()/2 + 1
                }).fadeIn(function() {
                    var pop = $(this);
                    setTimeout(function() {
                        pop.remove();
                    }, pop.text().length * 800);
                });
            }, function() {
                $("#anchortitlecontainer").remove();
            });
        });
    });
</script>


  </div>
</body>
</html>