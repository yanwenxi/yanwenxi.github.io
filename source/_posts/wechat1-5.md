---
title: 配置、接入微信公众号
date: 2017-01-10 17:01:10
tags: node wechat
---
#### 配置接入微信公众号
1.按官方要求填写提交资料申请就可以了。
2.可以申请测试公众帐号
#### 申请测试公众号步骤
1.打开wechat开发者官方文档，点击左侧菜单栏下的开始开发。
2.再点击接口测试号申请
3.点击登录，用手机扫描二维码
4.填写配置信息即可了。

#### 接入流程一共分为两步：
1.配置我们的公众号后台
2.验证公众号

#### 配置公众号后台要填写url,token和encodingseskey.
url:就是开发者用来接收微信消息和事件的接口url，微信服务器会把这些事件或者说是这些数据给push到这个url里面。

token:由开发者任意填写的，并会生成一个签名，这个token会和接口url中的token要进行一个比对，能保证安全性。

encodingseskey：自己填写或者随机生成，并做消息体的加密或者解密密钥。消息体加密解密的方式：本项目采用明文模式。

#### 验证公众号流程
<div align=center>
    ![](http://oi28tswuq.bkt.clouddn.com/images/testwechat.png-public)
</div>
第一步：将token,timestamp,nonce三个参数进行字典排序
第二步：将三个参数字符串拼接成一个字符串进行sha1加密
第三步：将加密后的字符串与signature对比，如果相同，表示这个请求来源于微信，我们直接原样返回echostr参数内容，接入验证就成功了。

有了测试公众号，本地也跑通了ngrok代理环境（建议用localtunnel服务），填写完url和token,接下来就能模拟本地开发了。